{"type":"user","timestamp":"2026-01-25T09:48:00.766Z","content":"[analyze-mode]\nANALYSIS MODE. Gather context before diving deep:\n\nCONTEXT GATHERING (parallel):\n- 1-2 explore agents (codebase patterns, implementations)\n- 1-2 librarian agents (if external library involved)\n- Direct tools: Grep, AST-grep, LSP for targeted searches\n\nIF COMPLEX (architecture, multi-system, debugging after 2+ failures):\n- Consult oracle for strategic guidance\n\nSYNTHESIZE findings before proceeding.\n\n---\n\n我是一个多资产投资部的负责人，我需要经常统计和查看我们部门的资产持仓情况。我们公司系统可以导出所有产品的持仓表，/Users/fanshengxia/Desktop/部门持仓分析系统/持仓盈亏明细列表_20260122.xlsx。\n\n\n\n我自己有个单独的分类逻辑包括对资产的重新分类的逻辑/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py，和具体的对部门资产的标签和分类/Users/fanshengxia/Desktop/部门持仓分析系统/多资产资产分类.xlsx。\n持仓表里的所有产品我也有一个产品运作及概览信息表/Users/fanshengxia/Desktop/部门持仓分析系统/产品运作概览信息表增加指标变化_20260122.xlsx\n我希望你帮我设计一个网站，这个系统里有个界面是包含了我的特别增加资产的分类标签逻辑也就是我的资产分类表的数据，但我可以在这个界面我可以进行新增删除和修改设置，\n\n主界面在我上传我的持仓盈亏表和产品运作概览表后\n后会自动的按照我的投委会团队持仓统计分析.py的格式生产一个我的整体的不同类型的可以进行交互的持仓表。\n/Users/fanshengxia/Desktop/截屏2026-01-25\\ 17.31.08.png 日期修改为准确的持仓表的日期。\n包含不同类别资产的持仓金额和占比。\n但是在顶上有个筛选器，当我输入任意运作概览表的字段后，这个表格会自动的进行调整。比如我选择投资经理这个字段\n行是资产类别，但是变成了不同的投资经理，数值变成了金额，并且我可以选择切换成占比，这个占比还可以选择是占行还是占列。也就是统计这类资产在\n这个投资经理占比的持仓中占比情况还是在部门的这类资产中的占比情况。\n并且我还可以叠加一个产品代码维度，这样就可以进一步统计每个投资经理下的每个产品在不同类别资产中的持仓情况。\n\n另外这个系统里还有个输入款，当我输入特定的资产后，可以统计这个资产在不同产品的持仓及占比和部门的汇总结果 请使用前端设计的skills来设计我的网站和交互页面"}
{"type":"tool_use","timestamp":"2026-01-25T09:50:28.144Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py"}}
{"type":"tool_result","timestamp":"2026-01-25T09:50:28.162Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py"},"tool_output":{"preview":"import logging\nfrom dataclasses import dataclass\nfrom pathlib import Path\nfrom typing import Dict, Iterable, List, Optional, Set, Tuple\nimport numpy as np\nimport pandas as pd\nfrom openpyxl import load_workbook\nfrom openpyxl.styles import Alignment, Border, Font, PatternFill, Side\nfrom openpyxl.utils import get_column_letter\n\n# --------------------------- 配置区 --------------------------- #\nCURRENT_PERIOD = {\n    \"label\": \"25年Q4\",\n    \"asset_data_path\": \"/Users/fanshengxia/Desktop/团队持仓分析/26年1季度/资产交易余额台账20251231 (1).xlsx\",\n    \"asset_sheet_name\": None,\n}\n\nPREVIOUS_PERIOD = {\n    \"label\": \"25年Q3\",  \n    \"asset_data_path\": \"/Users/fanshengxia/Desktop/团队持仓分析/25年4季度/资产交易余额台账20250930.xlsx\",","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:50:29.846Z","tool_name":"look_at","tool_input":{"file_path":"/Users/fanshengxia/Desktop/部门持仓分析系统/持仓盈亏明细列表_20260122.xlsx","goal":"分析Excel文件的完整结构，包括所有列名、数据类型、样本数据，了解持仓明细表的字段定义"}}
{"type":"tool_use","timestamp":"2026-01-25T09:50:30.953Z","tool_name":"look_at","tool_input":{"file_path":"/Users/fanshengxia/Desktop/部门持仓分析系统/多资产资产分类.xlsx","goal":"分析Excel文件的完整结构，包括所有列名、分类标签逻辑、资产分类规则"}}
{"type":"tool_use","timestamp":"2026-01-25T09:50:32.032Z","tool_name":"look_at","tool_input":{"goal":"分析Excel文件的完整结构，包括所有字段名、产品信息、投资经理等维度字段","file_path":"/Users/fanshengxia/Desktop/部门持仓分析系统/产品运作概览信息表增加指标变化_20260122.xlsx"}}
{"type":"tool_use","timestamp":"2026-01-25T09:50:33.211Z","tool_name":"look_at","tool_input":{"file_path":"/Users/fanshengxia/Desktop/截屏2026-01-25 17.31.08.png","goal":"分析截图中的表格设计、交互元素、布局风格，理解用户期望的UI设计"}}
{"type":"tool_result","timestamp":"2026-01-25T09:50:48.297Z","tool_name":"look_at","tool_input":{"goal":"分析Excel文件的完整结构，包括所有字段名、产品信息、投资经理等维度字段","file_path":"/Users/fanshengxia/Desktop/部门持仓分析系统/产品运作概览信息表增加指标变化_20260122.xlsx"},"tool_output":{"truncated":false}}
{"type":"tool_result","timestamp":"2026-01-25T09:50:51.346Z","tool_name":"look_at","tool_input":{"file_path":"/Users/fanshengxia/Desktop/部门持仓分析系统/持仓盈亏明细列表_20260122.xlsx","goal":"分析Excel文件的完整结构，包括所有列名、数据类型、样本数据，了解持仓明细表的字段定义"},"tool_output":{"truncated":false}}
{"type":"tool_result","timestamp":"2026-01-25T09:50:55.082Z","tool_name":"look_at","tool_input":{"file_path":"/Users/fanshengxia/Desktop/截屏2026-01-25 17.31.08.png","goal":"分析截图中的表格设计、交互元素、布局风格，理解用户期望的UI设计"},"tool_output":{"truncated":false}}
{"type":"tool_result","timestamp":"2026-01-25T09:51:06.089Z","tool_name":"look_at","tool_input":{"file_path":"/Users/fanshengxia/Desktop/部门持仓分析系统/多资产资产分类.xlsx","goal":"分析Excel文件的完整结构，包括所有列名、分类标签逻辑、资产分类规则"},"tool_output":{"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:51:27.455Z","tool_name":"skill","tool_input":{"name":"xlsx"}}
{"type":"tool_result","timestamp":"2026-01-25T09:51:27.511Z","tool_name":"skill","tool_input":{"name":"xlsx"},"tool_output":{"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:51:28.047Z","tool_name":"skill","tool_input":{"name":"frontend-design"}}
{"type":"tool_result","timestamp":"2026-01-25T09:51:28.086Z","tool_name":"skill","tool_input":{"name":"frontend-design"},"tool_output":{"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:51:41.519Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统 && python3 << 'EOF'\nimport pandas as pd\nimport json\n\n# 读取持仓盈亏明细\nholdings_file = \"持仓盈亏明细列表_20260122.xlsx\"\ndf = pd.read_excel(holdings_file, nrows=3)\nprint(\"=== 持仓盈亏明细列表 ===\")\nprint(\"列名:\", list(df.columns))\nprint(\"\\n样本数据:\")\nprint(df.head(2).to_string())\n\n# 读取产品运作概览\noverview_file = \"产品运作概览信息表增加指标变化_20260122.xlsx\"\ndf2 = pd.read_excel(overview_file, nrows=3)\nprint(\"\\n\\n=== 产品运作概览信息表 ===\")\nprint(\"列名:\", list(df2.columns))\nprint(\"\\n样本数据:\")\nprint(df2.head(2).to_string())\n\n# 读取资产分类表\nclass_file = \"多资产资产分类.xlsx\"\nprint(\"\\n\\n=== 多资产资产分类.xlsx sheets ===\")\nxl = pd.ExcelFile(class_file)\nprint(\"Sheets:\", xl.sheet_names)\n\nfor sheet in xl.sheet_names[:4]:\n    df3 = pd.read_excel(class_file, sheet_name=sheet, nrows=5)\n    print(f\"\\n--- Sheet: {sheet} ---\")\n    print(\"列名:\", list(df3.columns))\nEOF\n","description":"Read Excel file structures for holdings data"}}
{"type":"tool_result","timestamp":"2026-01-25T09:51:56.908Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统 && python3 << 'EOF'\nimport pandas as pd\nimport json\n\n# 读取持仓盈亏明细\nholdings_file = \"持仓盈亏明细列表_20260122.xlsx\"\ndf = pd.read_excel(holdings_file, nrows=3)\nprint(\"=== 持仓盈亏明细列表 ===\")\nprint(\"列名:\", list(df.columns))\nprint(\"\\n样本数据:\")\nprint(df.head(2).to_string())\n\n# 读取产品运作概览\noverview_file = \"产品运作概览信息表增加指标变化_20260122.xlsx\"\ndf2 = pd.read_excel(overview_file, nrows=3)\nprint(\"\\n\\n=== 产品运作概览信息表 ===\")\nprint(\"列名:\", list(df2.columns))\nprint(\"\\n样本数据:\")\nprint(df2.head(2).to_string())\n\n# 读取资产分类表\nclass_file = \"多资产资产分类.xlsx\"\nprint(\"\\n\\n=== 多资产资产分类.xlsx sheets ===\")\nxl = pd.ExcelFile(class_file)\nprint(\"Sheets:\", xl.sheet_names)\n\nfor sheet in xl.sheet_names[:4]:\n    df3 = pd.read_excel(class_file, sheet_name=sheet, nrows=5)\n    print(f\"\\n--- Sheet: {sheet} ---\")\n    print(\"列名:\", list(df3.columns))\nEOF\n","description":"Read Excel file structures for holdings data"},"tool_output":{"output":"/Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/openpyxl/styles/stylesheet.py:226: UserWarning: Workbook contains no default style, apply openpyxl's default\n  warn(\"Workbook contains no default style, apply openpyxl's default\")\n=== 持仓盈亏明细列表 ===\n列名: ['产品简称', '产品代码', '资产代码', '外部代码', '资产简称', '持仓面额', '资产变现时效(参考)', '最近买入日期', '是否质押', '质押比例', '质押到期日', '会计分类', '投资目的', '市场类型', '上市地点', '发行方式', '剩余期限(年)', '修正久期', '主体评级', '债项评级', '主体内评', '债项内评', '票面利率', '收益率-买入成本', '净价-买入成本', '全价-买入成本', '持仓成本(元)', '中债行权收益率(2026-01-21)', '中债行权收益率(2026-01-22)', '中债行权收益率变化(BP)', '市价行权收益率', '净价(元)-市价估值', '日终全价(元)-市价估值', '日终市值(元)-市价估值', '净价盈亏-市价估值', '持有期收益', '持有期年化收益率', '净价(元)-产品法估值', '日终全价（元）-产品法估值', '日终市值(元)-产品法估值', '偏离（元）-产品法估值', '偏离度-产品法估值', '折溢摊净价', '折溢摊收益率', '发行人名称', '区域', '企业性质', '所属行业', '凸性', '起息日', '下一付息日', '下一行权日', '新版资产大类', '新版资产小类', '到期日', '所属池子', '信评推荐', '静态', '久期']\n\n样本数据:\n         产品简称      产品代码                资产代码  外部代码                 资产简称          持仓面额 资产变现时效(参考)      最近买入日期  是否质押  质押比例  质押到期日 会计分类 投资目的  市场类型  上市地点  发行方式  剩余期限(年)  修正久期  主体评级  债项评级  主体内评  债项内评    票面利率  收益率-买入成本  净价-买入成本  全价-买入成本    持仓成本(元)  中债行权收益率(2026-01-21)  中债行权收益率(2026-01-22)  中债行权收益率变化(BP)  市价行权收益率  净价(元)-市价估值  日终全价(元)-市价估值  日终市值(元)-市价估值  净价盈亏-市价估值       持有期收益  持有期年化收益率  净价(元)-产品法估值  日终全价（元）-产品法估值  日终市值(元)-产品法估值  偏离（元）-产品法估值  偏离度-产品法估值  折溢摊净价  折溢摊收益率  发行人名称  区域  企业性质  所属行业  凸性         起息日  下一付息日  下一行权日   新版资产大类       新版资产小类         到期日  所属池子  信评推荐        静态        久期\n0  和瑞2025年31期  7A118310          11PF251991   NaN  国海证券扬帆2620号集合资产管理计划  5.900049e+08         T1  2025-08-12   NaN   NaN    NaN  交易性  交易性   NaN   NaN   NaN   9.4849  5.74   NaN   NaN   NaN   NaN  0.0286         0      NaN      NaN  590000000                  NaN                  NaN            NaN   0.0272         NaN           NaN           NaN        NaN  6435914.10  0.023432          1.0         1.0109   5.964359e+08            0        NaN    NaN     NaN    NaN NaN   NaN   NaN NaN  2025-07-16    NaN    NaN     委外投资  委外非现固定收益类资产  2035-07-16   NaN   NaN  0.026325  3.452211\n1  和瑞2025年31期  7A118310  051010100102232449   NaN                 托管账户  4.659108e+06        NaN         NaN   NaN   NaN    NaN  NaN  NaN   NaN   NaN   NaN   0.0027  0.00   NaN   NaN   NaN   NaN  0.0140         0      NaN      NaN          0                  NaN                  NaN            NaN      NaN         NaN           NaN           NaN        NaN  4767350.17       NaN          NaN         1.0013   4.665092e+06            0        NaN    NaN     NaN    NaN NaN   NaN   NaN NaN  1970-01-01    NaN    NaN  现金及银行存款      现金及活期存款  9999-01-01   NaN   NaN  0.014000  0.000000\n\n\n=== 产品运作概览信息表 ===\n列名: ['产品代码', '产品简称', '净资产(亿)', '5%流动性实际指标', '单位净值', '本期年化', '累计年化', '业绩基准', '杠杆', '组合久期', '组合静态', '权益仓位', '衍生品仓位', '运作天', '剩余天', '产品经理', '起息日', '到期日', '销售费', '管理费', '托管费', '母产品代码', '币种', '多资产品类', '产品部品类', '形态', '周期天数', '产品模板中文名称', '是否招商', '渠道明细', '母子标志', '主要展示', '母分类', '久期变化-较上周', '杠杆变化-较上周', '权益仓位-较上周', '久期变化-较上月', '杠杆变化-较上月', '权益仓位-较上月', '业绩基准今年以来收益率(区间)', '业绩基准-今年以来年化', '业绩基准成立以来收益率(区间)', '业绩基准-成立以来年化']\n\n样本数据:\n       产品代码        产品简称    净资产(亿)  5%流动性实际指标     单位净值      本期年化      累计年化         业绩基准  杠杆      组合久期      组合静态  权益仓位  衍生品仓位  运作天  剩余天 产品经理         起息日         到期日     销售费     管理费     托管费     母产品代码   币种   多资产品类  产品部品类  形态  周期天数  产品模板中文名称 是否招商 渠道明细   母子标志 主要展示    母分类  久期变化-较上周  杠杆变化-较上周  权益仓位-较上周  久期变化-较上月  杠杆变化-较上月  权益仓位-较上月  业绩基准今年以来收益率(区间)  业绩基准-今年以来年化  业绩基准成立以来收益率(区间)  业绩基准-成立以来年化\n0  7A118310  和瑞2025年31期  6.053340        NaN  1.00990  0.018919  0.018919  3.00%-3.40%   1  3.401466  0.026046     0    NaN  191  904  朱轶伦  2025-07-16  2028-07-14  0.0029  0.0001  0.0003  7A118310  人民币  BOF R2    NaN  封闭  1094  封闭式净值型产品  非招商   兴业  非母子产品    是  和瑞BOF -0.469465         0         0 -0.782889         0         0          0.00189         0.03         0.015781         0.03\n1  7A118320  和瑞2025年32期  5.531337        NaN  1.00965  0.019247  0.019247  3.00%-3.40%   1  3.375462  0.025952     0    NaN  183  914  朱轶伦  2025-07-24  2028-07-24  0.0029  0.0001  0.0003  7A118320  人民币  BOF R2    NaN  封闭  1096  封闭式净值型产品  非招商   兴业  非母子产品    是  和瑞BOF -0.465855         0         0 -0.776756         0         0          0.00189         0.03         0.015123         0.03\n\n\n=== 多资产资产分类.xlsx sheets ===\nSheets: ['资产分类', '委外投资标签', '公募基金标签', 'Sheet1', '资产代码']\n\n--- Sheet: 资产分类 ---\n列名: ['本外币', '大类资产', '细分资产类别', '计算方式（依赖新版资产分类及手工标签）']\n\n--- Sheet: 委外投资标签 ---\n列名: ['新版资产子类', '新版资产大类', '资产代码', '金额亿20251231', '多资产专户细分策略', '标签', '细分资产类别']\n\n--- Sheet: 公募基金标签 ---\n列名: ['基金代码', '资产简称', '细分资产类别']\n\n--- Sheet: Sheet1 ---\n列名: []\n","exit":0,"description":"Read Excel file structures for holdings data","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:52:22.378Z","tool_name":"todowrite","tool_input":{"todos":[{"status":"completed","priority":"high","id":"1","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"priority":"high","id":"2","content":"创建项目结构 - React + Vite + TailwindCSS 前端","status":"pending"},{"status":"pending","priority":"high","id":"3","content":"设计并实现后端API - Python FastAPI处理Excel数据"},{"content":"实现资产分类管理页面 - CRUD操作资产标签分类","status":"pending","priority":"high","id":"4"},{"priority":"high","id":"5","content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","status":"pending"},{"status":"pending","priority":"medium","id":"6","content":"实现资产搜索功能 - 按资产查询各产品持仓详情"},{"content":"样式优化与交互完善 - 专业金融风格UI","status":"pending","priority":"medium","id":"7"}]}}
{"type":"tool_result","timestamp":"2026-01-25T09:52:22.420Z","tool_name":"todowrite","tool_input":{"todos":[{"status":"completed","priority":"high","id":"1","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"priority":"high","id":"2","content":"创建项目结构 - React + Vite + TailwindCSS 前端","status":"pending"},{"status":"pending","priority":"high","id":"3","content":"设计并实现后端API - Python FastAPI处理Excel数据"},{"content":"实现资产分类管理页面 - CRUD操作资产标签分类","status":"pending","priority":"high","id":"4"},{"priority":"high","id":"5","content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","status":"pending"},{"status":"pending","priority":"medium","id":"6","content":"实现资产搜索功能 - 按资产查询各产品持仓详情"},{"content":"样式优化与交互完善 - 专业金融风格UI","status":"pending","priority":"medium","id":"7"}]},"tool_output":{"todos":[{"status":"completed","priority":"high","id":"1","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"priority":"high","id":"2","content":"创建项目结构 - React + Vite + TailwindCSS 前端","status":"pending"},{"status":"pending","priority":"high","id":"3","content":"设计并实现后端API - Python FastAPI处理Excel数据"},{"content":"实现资产分类管理页面 - CRUD操作资产标签分类","status":"pending","priority":"high","id":"4"},{"priority":"high","id":"5","content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","status":"pending"},{"status":"pending","priority":"medium","id":"6","content":"实现资产搜索功能 - 按资产查询各产品持仓详情"},{"content":"样式优化与交互完善 - 专业金融风格UI","status":"pending","priority":"medium","id":"7"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:53:16.615Z","tool_name":"delegate_task","tool_input":{"description":"Design asset holding analysis system","prompt":"## TASK\nBuild a complete **multi-asset holding analysis system** (部门持仓分析系统) - a professional financial dashboard for analyzing department asset holdings with dynamic filtering and multi-dimensional pivot capabilities.\n\n## EXPECTED OUTCOME\nA **fully functional full-stack application** with:\n1. **Backend**: Python FastAPI server to process Excel uploads and apply classification rules\n2. **Frontend**: React + Vite + TailwindCSS professional financial dashboard\n3. All files saved to `/Users/fanshengxia/Desktop/部门持仓分析系统/`\n\n## REQUIRED TOOLS\n- Write, Edit for file creation\n- Bash for npm/pip setup commands\n- Read for reference files when needed\n\n## MUST DO\n\n### Backend (FastAPI + Python)\n1. Create `backend/` directory with `main.py`, `requirements.txt`, `classification.py`, `data_processor.py`\n2. **Endpoints**:\n   - `POST /api/upload` - Accept 持仓盈亏表 + 产品运作概览表 Excel files\n   - `GET /api/classifications` - Get asset classification rules from 多资产资产分类.xlsx\n   - `POST /api/classifications` - Save updated classification rules  \n   - `GET /api/holdings` - Get processed holdings data with filters\n   - `GET /api/asset-search?keyword=` - Search specific asset across products\n\n3. **Core processing logic** (reference `/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py`):\n   - Load classification rules from `多资产资产分类.xlsx` (sheets: 资产分类, 委外投资标签, 公募基金标签)\n   - Apply `classify_row()` logic to holdings data\n   - Support filtering by any field from 产品运作概览表 (投资经理, 产品代码, etc.)\n   - Return hierarchical data structure matching the Excel table format\n\n### Frontend (React + Vite + TailwindCSS)\nCreate in `frontend/` directory.\n\n**Pages**:\n\n#### 1. Holdings Analysis Page (主持仓分析页)\n- **File Upload Area**: Drop zone for 持仓盈亏明细列表 and 产品运作概览信息表\n- **Dynamic Filter Bar** at top:\n  - Dropdown to select grouping dimension from 产品运作概览表 fields (投资经理, 币种, 多资产品类, etc.)\n  - When selected, table columns become: 资产类别 rows × 投资经理/产品 columns\n  - Toggle switch: 金额(亿) ↔ 占比(%)\n  - When showing 占比, allow choosing: 按行占比(row%) vs 按列占比(column%)\n  - Optional: Add second dimension (e.g., 投资经理 → then 产品代码)\n\n- **Holdings Table** (核心表格):\n  - Multi-level merged cells: 本外币 → 大类资产 → 细分资产类别 (like the screenshot)\n  - Left column (本外币): Deep blue background, white bold text, merged rows\n  - 大类资产: Light gray subtotal rows with bold text\n  - Subtotal rows for each category group (XX资产合计)\n  - Total rows at bottom: 总资产, 净资产\n  - Sticky header and first columns\n  - Display date from uploaded file in header\n  - Data columns: [日期(亿), 日期占比] or dynamic based on filter\n\n- **Visual Style** (Professional Financial - Bloomberg/Wind Terminal Style):\n  - Primary: Deep navy blue (#1F497D, #305496)\n  - Background: Clean white/light gray\n  - Table borders: Light gray (#D4D4D4) thin lines\n  - Font: Clean sans-serif, numbers right-aligned\n  - Subtotal rows: Light gray background (#E7E6E6)\n  - Total rows: Light blue background (#BDD7EE)\n  \n#### 2. Asset Classification Management Page (资产分类管理页)\n- **Tab Navigation**: 资产分类 | 委外投资标签 | 公募基金标签 | 资产代码\n- **Editable Data Table** for each sheet with:\n  - Add row button\n  - Inline editing (click to edit cells)\n  - Delete row (with confirmation)\n  - Save changes button (calls API to persist)\n- Load initial data from `多资产资产分类.xlsx`\n\n#### 3. Asset Search Page (资产穿透查询页)\n- **Search Input**: Enter asset code or name\n- **Results Table**:\n  - Columns: 产品简称, 产品代码, 投资经理, 持仓金额, 占产品净资产比例, 占部门该资产总持仓比例\n  - Summary row at bottom: 部门合计持仓\n\n### Data Structures\n\n**Holdings API Response**:\n```json\n{\n  \"date\": \"2026-01-22\",\n  \"groupBy\": null | \"投资经理\" | \"产品代码\",\n  \"groups\": [\"朱轶伦\", \"张三\", ...],  // when groupBy is set\n  \"data\": [\n    {\n      \"currency\": \"人民币资产\",\n      \"assetGroup\": \"债权类资产\", \n      \"category\": \"利率债\",\n      \"isSubtotal\": false,\n      \"values\": { \"total\": 123.45, \"朱轶伦\": 50.0, \"张三\": 73.45 },\n      \"shares\": { \"total\": 0.15, \"朱轶伦\": 0.10, \"张三\": 0.20 }\n    },\n    ...\n  ],\n  \"summary\": {\n    \"totalAssets\": 800.0,\n    \"netAssets\": 750.0\n  }\n}\n```\n\n**Sample columns from Excel files**:\n- 持仓盈亏表: 产品简称, 产品代码, 资产代码, 资产简称, 持仓成本(元), 日终市值(元)-市价估值, 新版资产大类, 新版资产小类\n- 产品概览表: 产品代码, 产品简称, 净资产(亿), 产品经理, 组合久期, 权益仓位, 多资产品类, 币种\n\n### UI Component Structure\n```\nApp\n├── Sidebar (Navigation)\n│   ├── 持仓分析\n│   ├── 资产分类管理\n│   └── 资产穿透查询\n├── HoldingsPage\n│   ├── FileUploadZone\n│   ├── FilterBar\n│   │   ├── DimensionSelector\n│   │   ├── ValueTypeToggle (金额/占比)\n│   │   └── ShareDirectionToggle (行/列)\n│   └── HoldingsTable (hierarchical merged cells)\n├── ClassificationPage\n│   ├── TabNav\n│   └── EditableDataTable\n└── AssetSearchPage\n    ├── SearchInput\n    └── ResultsTable\n```\n\n## MUST NOT DO\n- Do NOT create placeholder/mock data - use real classification file\n- Do NOT use generic Inter/Arial fonts - use distinctive professional fonts (IBM Plex Sans, Source Sans Pro, or similar)\n- Do NOT create incomplete implementations - all features must work\n- Do NOT skip merged cell logic in the table - this is CRITICAL for the hierarchical display\n- Do NOT forget the subtotal rows (XX合计) with proper styling\n\n## CONTEXT\n- **Classification file**: `/Users/fanshengxia/Desktop/部门持仓分析系统/多资产资产分类.xlsx`\n- **Reference Python logic**: `/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py` (especially `classify_row()`, `load_classification_rules()`, `compute_category_stats()`)\n- **Sample holdings file**: `/Users/fanshengxia/Desktop/部门持仓分析系统/持仓盈亏明细列表_20260122.xlsx`\n- **Sample overview file**: `/Users/fanshengxia/Desktop/部门持仓分析系统/产品运作概览信息表增加指标变化_20260122.xlsx`\n\nThe table should look like a professional financial report similar to Bloomberg Terminal or Wind Financial Terminal - clean, information-dense, with clear visual hierarchy through color-coded row groups.\n\n**Return**: List of all created files and brief instructions to run the application.","category":"visual-engineering","load_skills":["frontend-design","xlsx"],"run_in_background":false}}
{"type":"tool_result","timestamp":"2026-01-25T09:53:28.353Z","tool_name":"delegate_task","tool_input":{"description":"Design asset holding analysis system","prompt":"## TASK\nBuild a complete **multi-asset holding analysis system** (部门持仓分析系统) - a professional financial dashboard for analyzing department asset holdings with dynamic filtering and multi-dimensional pivot capabilities.\n\n## EXPECTED OUTCOME\nA **fully functional full-stack application** with:\n1. **Backend**: Python FastAPI server to process Excel uploads and apply classification rules\n2. **Frontend**: React + Vite + TailwindCSS professional financial dashboard\n3. All files saved to `/Users/fanshengxia/Desktop/部门持仓分析系统/`\n\n## REQUIRED TOOLS\n- Write, Edit for file creation\n- Bash for npm/pip setup commands\n- Read for reference files when needed\n\n## MUST DO\n\n### Backend (FastAPI + Python)\n1. Create `backend/` directory with `main.py`, `requirements.txt`, `classification.py`, `data_processor.py`\n2. **Endpoints**:\n   - `POST /api/upload` - Accept 持仓盈亏表 + 产品运作概览表 Excel files\n   - `GET /api/classifications` - Get asset classification rules from 多资产资产分类.xlsx\n   - `POST /api/classifications` - Save updated classification rules  \n   - `GET /api/holdings` - Get processed holdings data with filters\n   - `GET /api/asset-search?keyword=` - Search specific asset across products\n\n3. **Core processing logic** (reference `/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py`):\n   - Load classification rules from `多资产资产分类.xlsx` (sheets: 资产分类, 委外投资标签, 公募基金标签)\n   - Apply `classify_row()` logic to holdings data\n   - Support filtering by any field from 产品运作概览表 (投资经理, 产品代码, etc.)\n   - Return hierarchical data structure matching the Excel table format\n\n### Frontend (React + Vite + TailwindCSS)\nCreate in `frontend/` directory.\n\n**Pages**:\n\n#### 1. Holdings Analysis Page (主持仓分析页)\n- **File Upload Area**: Drop zone for 持仓盈亏明细列表 and 产品运作概览信息表\n- **Dynamic Filter Bar** at top:\n  - Dropdown to select grouping dimension from 产品运作概览表 fields (投资经理, 币种, 多资产品类, etc.)\n  - When selected, table columns become: 资产类别 rows × 投资经理/产品 columns\n  - Toggle switch: 金额(亿) ↔ 占比(%)\n  - When showing 占比, allow choosing: 按行占比(row%) vs 按列占比(column%)\n  - Optional: Add second dimension (e.g., 投资经理 → then 产品代码)\n\n- **Holdings Table** (核心表格):\n  - Multi-level merged cells: 本外币 → 大类资产 → 细分资产类别 (like the screenshot)\n  - Left column (本外币): Deep blue background, white bold text, merged rows\n  - 大类资产: Light gray subtotal rows with bold text\n  - Subtotal rows for each category group (XX资产合计)\n  - Total rows at bottom: 总资产, 净资产\n  - Sticky header and first columns\n  - Display date from uploaded file in header\n  - Data columns: [日期(亿), 日期占比] or dynamic based on filter\n\n- **Visual Style** (Professional Financial - Bloomberg/Wind Terminal Style):\n  - Primary: Deep navy blue (#1F497D, #305496)\n  - Background: Clean white/light gray\n  - Table borders: Light gray (#D4D4D4) thin lines\n  - Font: Clean sans-serif, numbers right-aligned\n  - Subtotal rows: Light gray background (#E7E6E6)\n  - Total rows: Light blue background (#BDD7EE)\n  \n#### 2. Asset Classification Management Page (资产分类管理页)\n- **Tab Navigation**: 资产分类 | 委外投资标签 | 公募基金标签 | 资产代码\n- **Editable Data Table** for each sheet with:\n  - Add row button\n  - Inline editing (click to edit cells)\n  - Delete row (with confirmation)\n  - Save changes button (calls API to persist)\n- Load initial data from `多资产资产分类.xlsx`\n\n#### 3. Asset Search Page (资产穿透查询页)\n- **Search Input**: Enter asset code or name\n- **Results Table**:\n  - Columns: 产品简称, 产品代码, 投资经理, 持仓金额, 占产品净资产比例, 占部门该资产总持仓比例\n  - Summary row at bottom: 部门合计持仓\n\n### Data Structures\n\n**Holdings API Response**:\n```json\n{\n  \"date\": \"2026-01-22\",\n  \"groupBy\": null | \"投资经理\" | \"产品代码\",\n  \"groups\": [\"朱轶伦\", \"张三\", ...],  // when groupBy is set\n  \"data\": [\n    {\n      \"currency\": \"人民币资产\",\n      \"assetGroup\": \"债权类资产\", \n      \"category\": \"利率债\",\n      \"isSubtotal\": false,\n      \"values\": { \"total\": 123.45, \"朱轶伦\": 50.0, \"张三\": 73.45 },\n      \"shares\": { \"total\": 0.15, \"朱轶伦\": 0.10, \"张三\": 0.20 }\n    },\n    ...\n  ],\n  \"summary\": {\n    \"totalAssets\": 800.0,\n    \"netAssets\": 750.0\n  }\n}\n```\n\n**Sample columns from Excel files**:\n- 持仓盈亏表: 产品简称, 产品代码, 资产代码, 资产简称, 持仓成本(元), 日终市值(元)-市价估值, 新版资产大类, 新版资产小类\n- 产品概览表: 产品代码, 产品简称, 净资产(亿), 产品经理, 组合久期, 权益仓位, 多资产品类, 币种\n\n### UI Component Structure\n```\nApp\n├── Sidebar (Navigation)\n│   ├── 持仓分析\n│   ├── 资产分类管理\n│   └── 资产穿透查询\n├── HoldingsPage\n│   ├── FileUploadZone\n│   ├── FilterBar\n│   │   ├── DimensionSelector\n│   │   ├── ValueTypeToggle (金额/占比)\n│   │   └── ShareDirectionToggle (行/列)\n│   └── HoldingsTable (hierarchical merged cells)\n├── ClassificationPage\n│   ├── TabNav\n│   └── EditableDataTable\n└── AssetSearchPage\n    ├── SearchInput\n    └── ResultsTable\n```\n\n## MUST NOT DO\n- Do NOT create placeholder/mock data - use real classification file\n- Do NOT use generic Inter/Arial fonts - use distinctive professional fonts (IBM Plex Sans, Source Sans Pro, or similar)\n- Do NOT create incomplete implementations - all features must work\n- Do NOT skip merged cell logic in the table - this is CRITICAL for the hierarchical display\n- Do NOT forget the subtotal rows (XX合计) with proper styling\n\n## CONTEXT\n- **Classification file**: `/Users/fanshengxia/Desktop/部门持仓分析系统/多资产资产分类.xlsx`\n- **Reference Python logic**: `/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py` (especially `classify_row()`, `load_classification_rules()`, `compute_category_stats()`)\n- **Sample holdings file**: `/Users/fanshengxia/Desktop/部门持仓分析系统/持仓盈亏明细列表_20260122.xlsx`\n- **Sample overview file**: `/Users/fanshengxia/Desktop/部门持仓分析系统/产品运作概览信息表增加指标变化_20260122.xlsx`\n\nThe table should look like a professional financial report similar to Bloomberg Terminal or Wind Financial Terminal - clean, information-dense, with clear visual hierarchy through color-coded row groups.\n\n**Return**: List of all created files and brief instructions to run the application.","category":"visual-engineering","load_skills":["frontend-design","xlsx"],"run_in_background":false},"tool_output":{"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:53:37.186Z","tool_name":"delegate_task","tool_input":{"session_id":"ses_40b6d8e8dffenJiVE4UWHlzTxU","prompt":"Continue implementing the full-stack application. Start by creating the project structure:\n\n1. Create `backend/` folder with Python FastAPI app\n2. Create `frontend/` folder with React Vite app\n\nBegin with the backend - create main.py with the API endpoints, then classification.py with the classification logic ported from the existing Python file.\n\nReturn the list of files created and any commands needed to run.","load_skills":["frontend-design","xlsx"],"run_in_background":false}}
{"type":"tool_result","timestamp":"2026-01-25T09:53:45.827Z","tool_name":"delegate_task","tool_input":{"session_id":"ses_40b6d8e8dffenJiVE4UWHlzTxU","prompt":"Continue implementing the full-stack application. Start by creating the project structure:\n\n1. Create `backend/` folder with Python FastAPI app\n2. Create `frontend/` folder with React Vite app\n\nBegin with the backend - create main.py with the API endpoints, then classification.py with the classification logic ported from the existing Python file.\n\nReturn the list of files created and any commands needed to run.","load_skills":["frontend-design","xlsx"],"run_in_background":false},"tool_output":{"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:53:51.547Z","tool_name":"bash","tool_input":{"command":"ls -la /Users/fanshengxia/Desktop/部门持仓分析系统/","description":"List current project directory structure"}}
{"type":"tool_result","timestamp":"2026-01-25T09:53:51.586Z","tool_name":"bash","tool_input":{"command":"ls -la /Users/fanshengxia/Desktop/部门持仓分析系统/","description":"List current project directory structure"},"tool_output":{"output":"total 36512\ndrwxr-xr-x   9 fanshengxia  staff       288 Jan 25 17:35 .\ndrwx------@ 75 fanshengxia  staff      2400 Jan 25 17:31 ..\n-rw-r--r--@  1 fanshengxia  staff      6148 Jan 25 17:27 .DS_Store\n-rw-r--r--@  1 fanshengxia  staff      2137 Jan 25 17:46 prompt\n-rw-r--r--@  1 fanshengxia  staff    280896 Jan 25 14:25 产品运作概览信息表增加指标变化_20260122.xlsx\n-rw-r--r--@  1 fanshengxia  staff     11096 Oct 21 16:32 多资产执行情况分析平台需求.md\n-rw-r--r--@  1 fanshengxia  staff  14146724 Jan 19 17:53 多资产资产分类.xlsx\n-rw-r--r--@  1 fanshengxia  staff     43201 Jan 17 09:54 投委会团队持仓统计分析.py\n-rw-rw-r--@  1 fanshengxia  staff   4190444 Jan 23 16:32 持仓盈亏明细列表_20260122.xlsx\n","exit":0,"description":"List current project directory structure","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:54:02.683Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"content":"创建后端 FastAPI 服务器和API","id":"2","priority":"high","status":"in_progress"},{"id":"3","priority":"high","status":"pending","content":"创建前端 React + Vite 项目结构"},{"priority":"high","status":"pending","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4"},{"status":"pending","content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high"},{"content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium","status":"pending"},{"priority":"medium","status":"pending","content":"样式优化与交互完善 - 专业金融风格UI","id":"7"}]}}
{"type":"tool_result","timestamp":"2026-01-25T09:54:02.698Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"content":"创建后端 FastAPI 服务器和API","id":"2","priority":"high","status":"in_progress"},{"id":"3","priority":"high","status":"pending","content":"创建前端 React + Vite 项目结构"},{"priority":"high","status":"pending","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4"},{"status":"pending","content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high"},{"content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium","status":"pending"},{"priority":"medium","status":"pending","content":"样式优化与交互完善 - 专业金融风格UI","id":"7"}]},"tool_output":{"todos":[{"id":"1","priority":"high","status":"completed","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"content":"创建后端 FastAPI 服务器和API","id":"2","priority":"high","status":"in_progress"},{"id":"3","priority":"high","status":"pending","content":"创建前端 React + Vite 项目结构"},{"priority":"high","status":"pending","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4"},{"status":"pending","content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high"},{"content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium","status":"pending"},{"priority":"medium","status":"pending","content":"样式优化与交互完善 - 专业金融风格UI","id":"7"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:57:19.084Z","tool_name":"bash","tool_input":{"command":"mkdir -p /Users/fanshengxia/Desktop/部门持仓分析系统/backend","description":"Create backend directory"}}
{"type":"tool_result","timestamp":"2026-01-25T09:57:19.128Z","tool_name":"bash","tool_input":{"command":"mkdir -p /Users/fanshengxia/Desktop/部门持仓分析系统/backend","description":"Create backend directory"},"tool_output":{"output":"","exit":0,"description":"Create backend directory","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:57:28.992Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/requirements.txt","content":"fastapi>=0.109.0\nuvicorn>=0.27.0\npython-multipart>=0.0.9\npandas>=2.0.0\nopenpyxl>=3.1.0\nnumpy>=1.24.0\npydantic>=2.0.0\n"}}
{"type":"tool_result","timestamp":"2026-01-25T09:57:29.001Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/requirements.txt","content":"fastapi>=0.109.0\nuvicorn>=0.27.0\npython-multipart>=0.0.9\npandas>=2.0.0\nopenpyxl>=3.1.0\nnumpy>=1.24.0\npydantic>=2.0.0\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/requirements.txt","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:58:35.202Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py","content":"\"\"\"资产分类逻辑模块 - 移植自投委会团队持仓统计分析.py\"\"\"\nfrom dataclasses import dataclass, field\nfrom pathlib import Path\nfrom typing import Dict, List, Optional, Set, Tuple\nimport numpy as np\nimport pandas as pd\n\n@dataclass\nclass ClassificationRules:\n    structure: List[Dict] = field(default_factory=list)\n    label_to_category: Dict[str, str] = field(default_factory=dict)\n    asset_code_to_category: Dict[str, str] = field(default_factory=dict)\n    asset_name_to_category: Dict[str, str] = field(default_factory=dict)\n    asset_code_to_label: Dict[str, str] = field(default_factory=dict)\n    asset_name_to_label: Dict[str, str] = field(default_factory=dict)\n    category_to_hierarchy: Dict[str, Tuple[str, str]] = field(default_factory=dict)\n    trading_code_to_category: Dict[str, str] = field(default_factory=dict)\n\ndef normalize_text(value, *, upper: bool = False) -> str:\n    if value is None or (isinstance(value, float) and np.isnan(value)):\n        return \"\"\n    text = str(value).strip()\n    return text.upper() if upper else text\n\ndef load_classification_rules(path: str) -> ClassificationRules:\n    \"\"\"从多资产资产分类.xlsx加载分类规则\"\"\"\n    structure_df = pd.read_excel(path, sheet_name=\"资产分类\")\n    sub_col = \"细分资产类别\"\n    tag_col = \"标签\" if \"标签\" in structure_df.columns else None\n    target_cols = [col for col in structure_df.columns if col.startswith(\"细分资产类别\") and col != sub_col]\n    \n    required_cols = [\"本外币\", \"大类资产\", sub_col]\n    keep_cols = [col for col in required_cols + ([tag_col] if tag_col else []) + target_cols if col in structure_df.columns]\n    structure_df = structure_df[keep_cols]\n    structure_df[[\"本外币\", \"大类资产\"]] = structure_df[[\"本外币\", \"大类资产\"]].ffill()\n    structure_df[sub_col] = structure_df[sub_col].fillna(\"\").apply(normalize_text)\n    \n    structure_entries: List[Dict] = []\n    category_to_hierarchy: Dict[str, Tuple[str, str]] = {}\n    label_to_category: Dict[str, str] = {}\n    group_lookup: Dict[Tuple[str, str], Dict] = {}\n    \n    for _, row in structure_df.iterrows():\n        currency = normalize_text(row[\"本外币\"])\n        group = normalize_text(row[\"大类资产\"])\n        sub = normalize_text(row[sub_col])\n        \n        if sub:\n            key = (currency, group)\n            if key not in group_lookup:\n                entry = {\"currency\": currency, \"group\": group, \"categories\": [], \"total_label\": None}\n                structure_entries.append(entry)\n                group_lookup[key] = entry\n            entry = group_lookup[key]\n            if \"合计\" in sub:\n                entry[\"total_label\"] = sub\n            else:\n                if sub not in entry[\"categories\"]:\n                    entry[\"categories\"].append(sub)\n            category_to_hierarchy[sub] = (currency, group)\n        \n        if tag_col:\n            label = normalize_text(row.get(tag_col))\n            for target_col in target_cols:\n                target = normalize_text(row.get(target_col))\n                if label and target:\n                    label_to_category.setdefault(label, target)\n    \n    # 读取委外投资标签\n    try:\n        tag_df = pd.read_excel(path, sheet_name=\"委外投资标签\")\n    except:\n        tag_df = pd.DataFrame()\n    \n    rename_map = {\"新版资产大类\": \"资产名称\", \"多资产专户细分策略\": \"细分策略\"}\n    tag_df = tag_df.rename(columns={k: v for k, v in rename_map.items() if k in tag_df.columns})\n    if \"多资产分类\" not in tag_df.columns and \"细分资产类别\" in tag_df.columns:\n        tag_df = tag_df.rename(columns={\"细分资产类别\": \"多资产分类\"})\n    \n    for column in [\"资产代码\", \"资产名称\", \"标签\", \"多资产分类\"]:\n        if column not in tag_df.columns:\n            tag_df[column] = pd.NA\n    \n    tag_df[\"资产代码\"] = tag_df[\"资产代码\"].apply(lambda x: normalize_text(x, upper=True))\n    tag_df[\"资产名称\"] = tag_df[\"资产名称\"].apply(normalize_text)\n    tag_df[\"标签\"] = tag_df[\"标签\"].replace({\"#N/A\": np.nan}).apply(normalize_text)\n    tag_df[\"多资产分类\"] = tag_df[\"多资产分类\"].replace({\"#N/A\": np.nan}).apply(normalize_text)\n    \n    asset_code_to_category: Dict[str, str] = {}\n    asset_name_to_category: Dict[str, str] = {}\n    asset_code_to_label: Dict[str, str] = {}\n    asset_name_to_label: Dict[str, str] = {}\n    trading_code_to_category: Dict[str, str] = {}\n    \n    for _, row in tag_df.dropna(subset=[\"资产代码\"]).iterrows():\n        code = row[\"资产代码\"]\n        if pd.notna(row.get(\"多资产分类\")) and row[\"多资产分类\"]:\n            asset_code_to_category.setdefault(code, row[\"多资产分类\"])\n        if pd.notna(row.get(\"标签\")) and row[\"标签\"]:\n            asset_code_to_label.setdefault(code, row[\"标签\"])\n    \n    for _, row in tag_df.dropna(subset=[\"资产名称\"]).iterrows():\n        name = row[\"资产名称\"]\n        if pd.notna(row.get(\"多资产分类\")) and row[\"多资产分类\"]:\n            asset_name_to_category.setdefault(name, row[\"多资产分类\"])\n        if pd.notna(row.get(\"标签\")) and row[\"标签\"]:\n            asset_name_to_label.setdefault(name, row[\"标签\"])\n    \n    for _, row in tag_df.dropna(subset=[\"标签\", \"多资产分类\"]).iterrows():\n        label = row[\"标签\"]\n        category = row[\"多资产分类\"]\n        if label and category:\n            label_to_category.setdefault(label, category)\n    \n    # 读取公募基金标签\n    try:\n        fund_tag_df = pd.read_excel(path, sheet_name=\"公募基金标签\")\n    except:\n        fund_tag_df = pd.DataFrame(columns=[\"基金代码\", \"资产简称\", \"细分资产类别\"])\n    \n    fund_tag_df = fund_tag_df.rename(columns={\"细分资产类别\": \"多资产分类\"})\n    for column in [\"基金代码\", \"资产简称\", \"多资产分类\"]:\n        if column not in fund_tag_df.columns:\n            fund_tag_df[column] = pd.NA\n    \n    fund_tag_df[\"基金代码\"] = fund_tag_df[\"基金代码\"].apply(lambda x: normalize_text(x, upper=True))\n    fund_tag_df[\"资产简称\"] = fund_tag_df[\"资产简称\"].apply(normalize_text)\n    fund_tag_df[\"多资产分类\"] = fund_tag_df[\"多资产分类\"].apply(normalize_text)\n    \n    for _, row in fund_tag_df.dropna(subset=[\"基金代码\", \"多资产分类\"]).iterrows():\n        trading_code = row[\"基金代码\"]\n        category = row[\"多资产分类\"]\n        if trading_code and category:\n            trading_code_to_category.setdefault(trading_code, category)\n            if category not in category_to_hierarchy:\n                category_to_hierarchy[category] = (\"未分类\", \"未分类\")\n    \n    return ClassificationRules(\n        structure=structure_entries,\n        label_to_category=label_to_category,\n        asset_code_to_category=asset_code_to_category,\n        asset_name_to_category=asset_name_to_category,\n        asset_code_to_label=asset_code_to_label,\n        asset_name_to_label=asset_name_to_label,\n        category_to_hierarchy=category_to_hierarchy,\n        trading_code_to_category=trading_code_to_category,\n    )\n\ndef classify_row(row: pd.Series, rules: ClassificationRules) -> str:\n    \"\"\"根据分类规则对单行资产进行分类\"\"\"\n    direct = normalize_text(row.get(\"指定分类\"))\n    if direct:\n        return direct\n    \n    label = normalize_text(row.get(\"委外标签\"))\n    label_category = rules.label_to_category.get(label, \"\")\n    if label_category:\n        return label_category\n    \n    sub = normalize_text(row.get(\"新版资产子类\") or row.get(\"新版资产小类\"))\n    main = normalize_text(row.get(\"新版资产大类\"))\n    name = normalize_text(row.get(\"资产名称_norm\") or row.get(\"资产简称\"))\n    \n    override_map = {\n        \"外币存放(线上)\": \"现金及存款\", \"外币存放（线上）\": \"现金及存款\",\n        \"外币存放（线下）\": \"现金及存款\", \"外币存放\": \"现金及存款\",\n        \"公募货币市场基金\": \"纯债基金\", \"券商收益凭证\": \"券商收益凭证\",\n        \"正回购\": \"正回购\", \"黄金基金\": \"黄金基金\",\n        \"短期纯债型基金\": \"纯债基金\", \"中长期纯债型基金\": \"纯债基金\",\n        \"被动指数型债券基金\": \"纯债基金\", \"混合债券型一级基金\": \"一级债基\",\n        \"混合债券型二级基金\": \"二级债基\", \"偏股混合型基金\": \"混合型基金\",\n        \"金融机构永续债\": \"金融债\", \"金融机构TLAC债\": \"金融债\",\n    }\n    if sub in override_map:\n        return override_map[sub]\n    \n    public_fund_map = {\n        \"国际(QDII)普通债券型基金\": \"纯债基金\", \"被动指数型基金\": \"股票型基金\",\n        \"国际(QDII)被动指数型股票基金\": \"股票型基金\", \"普通股票型基金\": \"股票型基金\",\n        \"货币市场型基金\": \"纯债基金\", \"灵活配置型基金\": \"股票型基金\",\n        \"增强指数型基金\": \"股票型基金\", \"国际(QDII)灵活配置型基金\": \"股票型基金\",\n    }\n    if main == \"公募基金\" and sub in public_fund_map:\n        return public_fund_map[sub]\n    \n    if sub in {\"他行发行的大额定期存单（CD）\", \"存放同业（线上）\"}:\n        return \"存放同业\"\n    if sub == \"委外现金管理投资\":\n        return \"保险资管计划\"\n    if sub in {\"现金及活期存款\"} or main == \"逆回购\":\n        return \"现金及逆回购\"\n    if sub == \"中证金债\":\n        return \"中证金债\"\n    if sub == \"同业借款\":\n        return \"同业借款\"\n    \n    if sub in {\"国债\", \"政策性金融债\"}:\n        return \"利率债\"\n    if main == \"同业存单\":\n        return \"NCD\"\n    if sub in {\"金融债\", \"金融机构二级资本债\", \"金融机构次级债\"}:\n        return \"金融债\"\n    \n    bond_set = {\"中票\", \"企业债\", \"公司债\", \"短融\", \"超短融\", \"非公开公司债\", \"非公开定向债务融资工具\", \"境内非金融机构信用债券\"}\n    if sub in bond_set:\n        return \"产业债\"  # 简化处理，不区分城投\n    \n    if sub in {\"企业资产支持证券\", \"企业资产支持证券(入池)\", \"资产支持票据\", \"资产支持票据(入池)\", \"固收类REITS\"}:\n        return \"ABS/ABN/类REITS\"\n    if sub in {\"可交换债\", \"可转债\", \"私募可交换债\"}:\n        return \"可转债/可交债\"\n    \n    if main == \"非标准化债权类资产\":\n        return \"项目类非标\"\n    if main in {\"理财直接融资工具\", \"新增可投资资产\", \"特定方式证券投资\"}:\n        return \"项目类非标\"\n    \n    if \"黄金\" in name and \"基金\" in name:\n        return \"黄金基金\"\n    \n    if sub == \"一级公募债券基金\":\n        return \"一级债基\"\n    if sub == \"二级公募债券基金\":\n        return \"二级债基\"\n    if sub == \"公募混合基金\":\n        return \"混合型基金\"\n    if sub in {\"公募股票基金\", \"公募股票分级基金\", \"其他公募基金\"}:\n        return \"股票型基金\"\n    if sub == \"互认基金\" or \"互认基金\" in name:\n        return \"互认基金\"\n    \n    foreign_asset_map = {\n        \"外币存款证\": \"现金及存款\", \"境外金融机构信用债券\": \"外币债券\",\n        \"外币活期存款\": \"现金及存款\", \"外国政府债券\": \"外币债券\",\n    }\n    if main == \"外币资产\" and sub in foreign_asset_map:\n        return foreign_asset_map[sub]\n    \n    if sub == \"非现固定收益类委外资产\":\n        if label in {\"收盘价\", \"模型法\"}:\n            return \"委外债券投资（低波）\"\n        if label == \"美元专户\":\n            return \"QDII资管计划\"\n        if label == \"可转债专户\":\n            return \"可转债专户\"\n        if label == \"二级债基专户\":\n            return \"二级债基专户\"\n        return \"委外债券投资（市值）\"\n    \n    if sub == \"权益类委外资产\":\n        return \"委外权益投资\"\n    if sub == \"混合类委外资产\":\n        if \"量化\" in label or \"量化\" in name:\n            return \"委外量化投资\"\n        return \"委外权益投资\"\n    if sub == \"商品及金融衍生品类委外资产\":\n        return \"委外衍生品投资\"\n    \n    if main == \"权益类投资\":\n        return \"优先股/优先级等\"\n    \n    if main in {\"外币存放\", \"外币活期存款\"}:\n        return \"现金及存款\"\n    if main == \"外币存款证\":\n        return \"现金及存款\"\n    if sub in {\"外国债券\", \"外币债券\"}:\n        return \"外币债券\"\n    \n    if main == \"金融衍生品\":\n        return \"金融衍生品\"\n    \n    # 默认分类\n    if main == \"委外投资\":\n        return \"委外债券投资（市值）\"\n    if \"现金\" in main or \"存款\" in main:\n        return \"现金及逆回购\"\n    if \"债券\" in main or \"债\" in sub:\n        return \"产业债\"\n    \n    return \"其他（未分类）\"\n\ndef enrich_holdings(df: pd.DataFrame, rules: ClassificationRules) -> pd.DataFrame:\n    \"\"\"丰富持仓数据，添加分类所需的中间字段\"\"\"\n    df = df.copy()\n    \n    # 标准化市值列\n    value_col = None\n    for col in [\"日终市值(元)-市价估值\", \"日终市值(元)-产品法估值\", \"持仓成本(元)\"]:\n        if col in df.columns:\n            value_col = col\n            break\n    \n    if value_col:\n        df[\"结算金额折人民币\"] = pd.to_numeric(df[value_col], errors=\"coerce\")\n    else:\n        df[\"结算金额折人民币\"] = 0\n    \n    df = df[df[\"结算金额折人民币\"].notna()]\n    \n    if \"资产代码\" in df.columns:\n        df[\"资产代码_norm\"] = df[\"资产代码\"].apply(lambda x: normalize_text(x, upper=True))\n    else:\n        df[\"资产代码_norm\"] = \"\"\n    \n    if \"资产简称\" in df.columns:\n        df[\"资产名称_norm\"] = df[\"资产简称\"].apply(normalize_text)\n    elif \"资产名称\" in df.columns:\n        df[\"资产名称_norm\"] = df[\"资产名称\"].apply(normalize_text)\n    else:\n        df[\"资产名称_norm\"] = \"\"\n    \n    if \"流通代码\" in df.columns:\n        df[\"流通代码_norm\"] = df[\"流通代码\"].apply(lambda x: normalize_text(x, upper=True))\n    else:\n        df[\"流通代码_norm\"] = \"\"\n    \n    # 映射标签和分类\n    df[\"委外标签\"] = df[\"资产代码_norm\"].map(rules.asset_code_to_label)\n    df.loc[df[\"委外标签\"].isna(), \"委外标签\"] = df[\"资产名称_norm\"].map(rules.asset_name_to_label)\n    \n    df[\"指定分类\"] = df[\"资产代码_norm\"].map(rules.asset_code_to_category)\n    df.loc[df[\"指定分类\"].isna(), \"指定分类\"] = df[\"资产名称_norm\"].map(rules.asset_name_to_category)\n    df.loc[df[\"指定分类\"].isna(), \"指定分类\"] = df[\"流通代码_norm\"].map(rules.trading_code_to_category)\n    \n    for col in [\"新版资产小类\", \"新版资产大类\"]:\n        if col in df.columns:\n            df[col] = df[col].apply(normalize_text)\n        else:\n            df[col] = \"\"\n    \n    return df\n\ndef classify_assets(df: pd.DataFrame, rules: ClassificationRules) -> pd.DataFrame:\n    \"\"\"对持仓数据进行资产分类\"\"\"\n    df = df.copy()\n    df[\"资产分类\"] = df.apply(classify_row, axis=1, args=(rules,))\n    return df\n"}}
{"type":"tool_result","timestamp":"2026-01-25T09:58:38.543Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py","content":"\"\"\"资产分类逻辑模块 - 移植自投委会团队持仓统计分析.py\"\"\"\nfrom dataclasses import dataclass, field\nfrom pathlib import Path\nfrom typing import Dict, List, Optional, Set, Tuple\nimport numpy as np\nimport pandas as pd\n\n@dataclass\nclass ClassificationRules:\n    structure: List[Dict] = field(default_factory=list)\n    label_to_category: Dict[str, str] = field(default_factory=dict)\n    asset_code_to_category: Dict[str, str] = field(default_factory=dict)\n    asset_name_to_category: Dict[str, str] = field(default_factory=dict)\n    asset_code_to_label: Dict[str, str] = field(default_factory=dict)\n    asset_name_to_label: Dict[str, str] = field(default_factory=dict)\n    category_to_hierarchy: Dict[str, Tuple[str, str]] = field(default_factory=dict)\n    trading_code_to_category: Dict[str, str] = field(default_factory=dict)\n\ndef normalize_text(value, *, upper: bool = False) -> str:\n    if value is None or (isinstance(value, float) and np.isnan(value)):\n        return \"\"\n    text = str(value).strip()\n    return text.upper() if upper else text\n\ndef load_classification_rules(path: str) -> ClassificationRules:\n    \"\"\"从多资产资产分类.xlsx加载分类规则\"\"\"\n    structure_df = pd.read_excel(path, sheet_name=\"资产分类\")\n    sub_col = \"细分资产类别\"\n    tag_col = \"标签\" if \"标签\" in structure_df.columns else None\n    target_cols = [col for col in structure_df.columns if col.startswith(\"细分资产类别\") and col != sub_col]\n    \n    required_cols = [\"本外币\", \"大类资产\", sub_col]\n    keep_cols = [col for col in required_cols + ([tag_col] if tag_col else []) + target_cols if col in structure_df.columns]\n    structure_df = structure_df[keep_cols]\n    structure_df[[\"本外币\", \"大类资产\"]] = structure_df[[\"本外币\", \"大类资产\"]].ffill()\n    structure_df[sub_col] = structure_df[sub_col].fillna(\"\").apply(normalize_text)\n    \n    structure_entries: List[Dict] = []\n    category_to_hierarchy: Dict[str, Tuple[str, str]] = {}\n    label_to_category: Dict[str, str] = {}\n    group_lookup: Dict[Tuple[str, str], Dict] = {}\n    \n    for _, row in structure_df.iterrows():\n        currency = normalize_text(row[\"本外币\"])\n        group = normalize_text(row[\"大类资产\"])\n        sub = normalize_text(row[sub_col])\n        \n        if sub:\n            key = (currency, group)\n            if key not in group_lookup:\n                entry = {\"currency\": currency, \"group\": group, \"categories\": [], \"total_label\": None}\n                structure_entries.append(entry)\n                group_lookup[key] = entry\n            entry = group_lookup[key]\n            if \"合计\" in sub:\n                entry[\"total_label\"] = sub\n            else:\n                if sub not in entry[\"categories\"]:\n                    entry[\"categories\"].append(sub)\n            category_to_hierarchy[sub] = (currency, group)\n        \n        if tag_col:\n            label = normalize_text(row.get(tag_col))\n            for target_col in target_cols:\n                target = normalize_text(row.get(target_col))\n                if label and target:\n                    label_to_category.setdefault(label, target)\n    \n    # 读取委外投资标签\n    try:\n        tag_df = pd.read_excel(path, sheet_name=\"委外投资标签\")\n    except:\n        tag_df = pd.DataFrame()\n    \n    rename_map = {\"新版资产大类\": \"资产名称\", \"多资产专户细分策略\": \"细分策略\"}\n    tag_df = tag_df.rename(columns={k: v for k, v in rename_map.items() if k in tag_df.columns})\n    if \"多资产分类\" not in tag_df.columns and \"细分资产类别\" in tag_df.columns:\n        tag_df = tag_df.rename(columns={\"细分资产类别\": \"多资产分类\"})\n    \n    for column in [\"资产代码\", \"资产名称\", \"标签\", \"多资产分类\"]:\n        if column not in tag_df.columns:\n            tag_df[column] = pd.NA\n    \n    tag_df[\"资产代码\"] = tag_df[\"资产代码\"].apply(lambda x: normalize_text(x, upper=True))\n    tag_df[\"资产名称\"] = tag_df[\"资产名称\"].apply(normalize_text)\n    tag_df[\"标签\"] = tag_df[\"标签\"].replace({\"#N/A\": np.nan}).apply(normalize_text)\n    tag_df[\"多资产分类\"] = tag_df[\"多资产分类\"].replace({\"#N/A\": np.nan}).apply(normalize_text)\n    \n    asset_code_to_category: Dict[str, str] = {}\n    asset_name_to_category: Dict[str, str] = {}\n    asset_code_to_label: Dict[str, str] = {}\n    asset_name_to_label: Dict[str, str] = {}\n    trading_code_to_category: Dict[str, str] = {}\n    \n    for _, row in tag_df.dropna(subset=[\"资产代码\"]).iterrows():\n        code = row[\"资产代码\"]\n        if pd.notna(row.get(\"多资产分类\")) and row[\"多资产分类\"]:\n            asset_code_to_category.setdefault(code, row[\"多资产分类\"])\n        if pd.notna(row.get(\"标签\")) and row[\"标签\"]:\n            asset_code_to_label.setdefault(code, row[\"标签\"])\n    \n    for _, row in tag_df.dropna(subset=[\"资产名称\"]).iterrows():\n        name = row[\"资产名称\"]\n        if pd.notna(row.get(\"多资产分类\")) and row[\"多资产分类\"]:\n            asset_name_to_category.setdefault(name, row[\"多资产分类\"])\n        if pd.notna(row.get(\"标签\")) and row[\"标签\"]:\n            asset_name_to_label.setdefault(name, row[\"标签\"])\n    \n    for _, row in tag_df.dropna(subset=[\"标签\", \"多资产分类\"]).iterrows():\n        label = row[\"标签\"]\n        category = row[\"多资产分类\"]\n        if label and category:\n            label_to_category.setdefault(label, category)\n    \n    # 读取公募基金标签\n    try:\n        fund_tag_df = pd.read_excel(path, sheet_name=\"公募基金标签\")\n    except:\n        fund_tag_df = pd.DataFrame(columns=[\"基金代码\", \"资产简称\", \"细分资产类别\"])\n    \n    fund_tag_df = fund_tag_df.rename(columns={\"细分资产类别\": \"多资产分类\"})\n    for column in [\"基金代码\", \"资产简称\", \"多资产分类\"]:\n        if column not in fund_tag_df.columns:\n            fund_tag_df[column] = pd.NA\n    \n    fund_tag_df[\"基金代码\"] = fund_tag_df[\"基金代码\"].apply(lambda x: normalize_text(x, upper=True))\n    fund_tag_df[\"资产简称\"] = fund_tag_df[\"资产简称\"].apply(normalize_text)\n    fund_tag_df[\"多资产分类\"] = fund_tag_df[\"多资产分类\"].apply(normalize_text)\n    \n    for _, row in fund_tag_df.dropna(subset=[\"基金代码\", \"多资产分类\"]).iterrows():\n        trading_code = row[\"基金代码\"]\n        category = row[\"多资产分类\"]\n        if trading_code and category:\n            trading_code_to_category.setdefault(trading_code, category)\n            if category not in category_to_hierarchy:\n                category_to_hierarchy[category] = (\"未分类\", \"未分类\")\n    \n    return ClassificationRules(\n        structure=structure_entries,\n        label_to_category=label_to_category,\n        asset_code_to_category=asset_code_to_category,\n        asset_name_to_category=asset_name_to_category,\n        asset_code_to_label=asset_code_to_label,\n        asset_name_to_label=asset_name_to_label,\n        category_to_hierarchy=category_to_hierarchy,\n        trading_code_to_category=trading_code_to_category,\n    )\n\ndef classify_row(row: pd.Series, rules: ClassificationRules) -> str:\n    \"\"\"根据分类规则对单行资产进行分类\"\"\"\n    direct = normalize_text(row.get(\"指定分类\"))\n    if direct:\n        return direct\n    \n    label = normalize_text(row.get(\"委外标签\"))\n    label_category = rules.label_to_category.get(label, \"\")\n    if label_category:\n        return label_category\n    \n    sub = normalize_text(row.get(\"新版资产子类\") or row.get(\"新版资产小类\"))\n    main = normalize_text(row.get(\"新版资产大类\"))\n    name = normalize_text(row.get(\"资产名称_norm\") or row.get(\"资产简称\"))\n    \n    override_map = {\n        \"外币存放(线上)\": \"现金及存款\", \"外币存放（线上）\": \"现金及存款\",\n        \"外币存放（线下）\": \"现金及存款\", \"外币存放\": \"现金及存款\",\n        \"公募货币市场基金\": \"纯债基金\", \"券商收益凭证\": \"券商收益凭证\",\n        \"正回购\": \"正回购\", \"黄金基金\": \"黄金基金\",\n        \"短期纯债型基金\": \"纯债基金\", \"中长期纯债型基金\": \"纯债基金\",\n        \"被动指数型债券基金\": \"纯债基金\", \"混合债券型一级基金\": \"一级债基\",\n        \"混合债券型二级基金\": \"二级债基\", \"偏股混合型基金\": \"混合型基金\",\n        \"金融机构永续债\": \"金融债\", \"金融机构TLAC债\": \"金融债\",\n    }\n    if sub in override_map:\n        return override_map[sub]\n    \n    public_fund_map = {\n        \"国际(QDII)普通债券型基金\": \"纯债基金\", \"被动指数型基金\": \"股票型基金\",\n        \"国际(QDII)被动指数型股票基金\": \"股票型基金\", \"普通股票型基金\": \"股票型基金\",\n        \"货币市场型基金\": \"纯债基金\", \"灵活配置型基金\": \"股票型基金\",\n        \"增强指数型基金\": \"股票型基金\", \"国际(QDII)灵活配置型基金\": \"股票型基金\",\n    }\n    if main == \"公募基金\" and sub in public_fund_map:\n        return public_fund_map[sub]\n    \n    if sub in {\"他行发行的大额定期存单（CD）\", \"存放同业（线上）\"}:\n        return \"存放同业\"\n    if sub == \"委外现金管理投资\":\n        return \"保险资管计划\"\n    if sub in {\"现金及活期存款\"} or main == \"逆回购\":\n        return \"现金及逆回购\"\n    if sub == \"中证金债\":\n        return \"中证金债\"\n    if sub == \"同业借款\":\n        return \"同业借款\"\n    \n    if sub in {\"国债\", \"政策性金融债\"}:\n        return \"利率债\"\n    if main == \"同业存单\":\n        return \"NCD\"\n    if sub in {\"金融债\", \"金融机构二级资本债\", \"金融机构次级债\"}:\n        return \"金融债\"\n    \n    bond_set = {\"中票\", \"企业债\", \"公司债\", \"短融\", \"超短融\", \"非公开公司债\", \"非公开定向债务融资工具\", \"境内非金融机构信用债券\"}\n    if sub in bond_set:\n        return \"产业债\"  # 简化处理，不区分城投\n    \n    if sub in {\"企业资产支持证券\", \"企业资产支持证券(入池)\", \"资产支持票据\", \"资产支持票据(入池)\", \"固收类REITS\"}:\n        return \"ABS/ABN/类REITS\"\n    if sub in {\"可交换债\", \"可转债\", \"私募可交换债\"}:\n        return \"可转债/可交债\"\n    \n    if main == \"非标准化债权类资产\":\n        return \"项目类非标\"\n    if main in {\"理财直接融资工具\", \"新增可投资资产\", \"特定方式证券投资\"}:\n        return \"项目类非标\"\n    \n    if \"黄金\" in name and \"基金\" in name:\n        return \"黄金基金\"\n    \n    if sub == \"一级公募债券基金\":\n        return \"一级债基\"\n    if sub == \"二级公募债券基金\":\n        return \"二级债基\"\n    if sub == \"公募混合基金\":\n        return \"混合型基金\"\n    if sub in {\"公募股票基金\", \"公募股票分级基金\", \"其他公募基金\"}:\n        return \"股票型基金\"\n    if sub == \"互认基金\" or \"互认基金\" in name:\n        return \"互认基金\"\n    \n    foreign_asset_map = {\n        \"外币存款证\": \"现金及存款\", \"境外金融机构信用债券\": \"外币债券\",\n        \"外币活期存款\": \"现金及存款\", \"外国政府债券\": \"外币债券\",\n    }\n    if main == \"外币资产\" and sub in foreign_asset_map:\n        return foreign_asset_map[sub]\n    \n    if sub == \"非现固定收益类委外资产\":\n        if label in {\"收盘价\", \"模型法\"}:\n            return \"委外债券投资（低波）\"\n        if label == \"美元专户\":\n            return \"QDII资管计划\"\n        if label == \"可转债专户\":\n            return \"可转债专户\"\n        if label == \"二级债基专户\":\n            return \"二级债基专户\"\n        return \"委外债券投资（市值）\"\n    \n    if sub == \"权益类委外资产\":\n        return \"委外权益投资\"\n    if sub == \"混合类委外资产\":\n        if \"量化\" in label or \"量化\" in name:\n            return \"委外量化投资\"\n        return \"委外权益投资\"\n    if sub == \"商品及金融衍生品类委外资产\":\n        return \"委外衍生品投资\"\n    \n    if main == \"权益类投资\":\n        return \"优先股/优先级等\"\n    \n    if main in {\"外币存放\", \"外币活期存款\"}:\n        return \"现金及存款\"\n    if main == \"外币存款证\":\n        return \"现金及存款\"\n    if sub in {\"外国债券\", \"外币债券\"}:\n        return \"外币债券\"\n    \n    if main == \"金融衍生品\":\n        return \"金融衍生品\"\n    \n    # 默认分类\n    if main == \"委外投资\":\n        return \"委外债券投资（市值）\"\n    if \"现金\" in main or \"存款\" in main:\n        return \"现金及逆回购\"\n    if \"债券\" in main or \"债\" in sub:\n        return \"产业债\"\n    \n    return \"其他（未分类）\"\n\ndef enrich_holdings(df: pd.DataFrame, rules: ClassificationRules) -> pd.DataFrame:\n    \"\"\"丰富持仓数据，添加分类所需的中间字段\"\"\"\n    df = df.copy()\n    \n    # 标准化市值列\n    value_col = None\n    for col in [\"日终市值(元)-市价估值\", \"日终市值(元)-产品法估值\", \"持仓成本(元)\"]:\n        if col in df.columns:\n            value_col = col\n            break\n    \n    if value_col:\n        df[\"结算金额折人民币\"] = pd.to_numeric(df[value_col], errors=\"coerce\")\n    else:\n        df[\"结算金额折人民币\"] = 0\n    \n    df = df[df[\"结算金额折人民币\"].notna()]\n    \n    if \"资产代码\" in df.columns:\n        df[\"资产代码_norm\"] = df[\"资产代码\"].apply(lambda x: normalize_text(x, upper=True))\n    else:\n        df[\"资产代码_norm\"] = \"\"\n    \n    if \"资产简称\" in df.columns:\n        df[\"资产名称_norm\"] = df[\"资产简称\"].apply(normalize_text)\n    elif \"资产名称\" in df.columns:\n        df[\"资产名称_norm\"] = df[\"资产名称\"].apply(normalize_text)\n    else:\n        df[\"资产名称_norm\"] = \"\"\n    \n    if \"流通代码\" in df.columns:\n        df[\"流通代码_norm\"] = df[\"流通代码\"].apply(lambda x: normalize_text(x, upper=True))\n    else:\n        df[\"流通代码_norm\"] = \"\"\n    \n    # 映射标签和分类\n    df[\"委外标签\"] = df[\"资产代码_norm\"].map(rules.asset_code_to_label)\n    df.loc[df[\"委外标签\"].isna(), \"委外标签\"] = df[\"资产名称_norm\"].map(rules.asset_name_to_label)\n    \n    df[\"指定分类\"] = df[\"资产代码_norm\"].map(rules.asset_code_to_category)\n    df.loc[df[\"指定分类\"].isna(), \"指定分类\"] = df[\"资产名称_norm\"].map(rules.asset_name_to_category)\n    df.loc[df[\"指定分类\"].isna(), \"指定分类\"] = df[\"流通代码_norm\"].map(rules.trading_code_to_category)\n    \n    for col in [\"新版资产小类\", \"新版资产大类\"]:\n        if col in df.columns:\n            df[col] = df[col].apply(normalize_text)\n        else:\n            df[col] = \"\"\n    \n    return df\n\ndef classify_assets(df: pd.DataFrame, rules: ClassificationRules) -> pd.DataFrame:\n    \"\"\"对持仓数据进行资产分类\"\"\"\n    df = df.copy()\n    df[\"资产分类\"] = df.apply(classify_row, axis=1, args=(rules,))\n    return df\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T09:59:35.404Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py","content":"from fastapi import FastAPI, UploadFile, File, HTTPException, Query\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom fastapi.responses import JSONResponse\nfrom pydantic import BaseModel\nfrom typing import Dict, List, Optional, Any\nimport pandas as pd\nimport numpy as np\nimport tempfile\nimport os\nimport json\nfrom pathlib import Path\n\nfrom classification import (\n    ClassificationRules, \n    load_classification_rules, \n    enrich_holdings, \n    classify_assets,\n    normalize_text\n)\n\napp = FastAPI(title=\"部门持仓分析系统 API\")\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\nBASE_DIR = Path(__file__).parent.parent\nCLASSIFICATION_FILE = BASE_DIR / \"多资产资产分类.xlsx\"\n\ncached_rules: Optional[ClassificationRules] = None\ncached_holdings_df: Optional[pd.DataFrame] = None\ncached_overview_df: Optional[pd.DataFrame] = None\ncached_date: Optional[str] = None\n\ndef get_classification_rules() -> ClassificationRules:\n    global cached_rules\n    if cached_rules is None:\n        cached_rules = load_classification_rules(str(CLASSIFICATION_FILE))\n    return cached_rules\n\ndef dataframe_to_json_safe(df: pd.DataFrame) -> List[Dict]:\n    df_copy = df.copy()\n    for col in df_copy.columns:\n        if df_copy[col].dtype == 'object':\n            df_copy[col] = df_copy[col].fillna('')\n        else:\n            df_copy[col] = df_copy[col].replace([np.inf, -np.inf], np.nan).fillna(0)\n    return df_copy.to_dict(orient='records')\n\n@app.get(\"/api/health\")\nasync def health_check():\n    return {\"status\": \"ok\", \"classification_file_exists\": CLASSIFICATION_FILE.exists()}\n\n@app.get(\"/api/classifications\")\nasync def get_classifications():\n    try:\n        sheets_data = {}\n        sheet_names = [\"资产分类\", \"委外投资标签\", \"公募基金标签\", \"资产代码\"]\n        \n        for sheet_name in sheet_names:\n            try:\n                df = pd.read_excel(str(CLASSIFICATION_FILE), sheet_name=sheet_name)\n                sheets_data[sheet_name] = {\n                    \"columns\": list(df.columns),\n                    \"data\": dataframe_to_json_safe(df)\n                }\n            except Exception as e:\n                sheets_data[sheet_name] = {\"columns\": [], \"data\": [], \"error\": str(e)}\n        \n        return JSONResponse(content=sheets_data)\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\nclass ClassificationUpdate(BaseModel):\n    sheet_name: str\n    data: List[Dict[str, Any]]\n\n@app.post(\"/api/classifications\")\nasync def update_classifications(update: ClassificationUpdate):\n    global cached_rules\n    try:\n        df = pd.DataFrame(update.data)\n        \n        with pd.ExcelFile(str(CLASSIFICATION_FILE)) as xls:\n            all_sheets = {sheet: pd.read_excel(xls, sheet_name=sheet) for sheet in xls.sheet_names}\n        \n        all_sheets[update.sheet_name] = df\n        \n        with pd.ExcelWriter(str(CLASSIFICATION_FILE), engine='openpyxl') as writer:\n            for sheet_name, sheet_df in all_sheets.items():\n                sheet_df.to_excel(writer, sheet_name=sheet_name, index=False)\n        \n        cached_rules = None\n        return {\"status\": \"success\", \"message\": f\"Sheet '{update.sheet_name}' updated successfully\"}\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/upload\")\nasync def upload_files(\n    holdings_file: UploadFile = File(..., description=\"持仓盈亏明细列表\"),\n    overview_file: UploadFile = File(..., description=\"产品运作概览信息表\")\n):\n    global cached_holdings_df, cached_overview_df, cached_date\n    \n    try:\n        with tempfile.NamedTemporaryFile(delete=False, suffix=\".xlsx\") as tmp_holdings:\n            content = await holdings_file.read()\n            tmp_holdings.write(content)\n            holdings_path = tmp_holdings.name\n        \n        with tempfile.NamedTemporaryFile(delete=False, suffix=\".xlsx\") as tmp_overview:\n            content = await overview_file.read()\n            tmp_overview.write(content)\n            overview_path = tmp_overview.name\n        \n        holdings_df = pd.read_excel(holdings_path)\n        overview_df = pd.read_excel(overview_path)\n        \n        rules = get_classification_rules()\n        enriched_df = enrich_holdings(holdings_df, rules)\n        classified_df = classify_assets(enriched_df, rules)\n        \n        if \"产品代码\" in overview_df.columns:\n            classified_df = classified_df.merge(\n                overview_df[[\"产品代码\", \"产品经理\", \"净资产(亿)\", \"多资产品类\", \"币种\"]].drop_duplicates(),\n                on=\"产品代码\",\n                how=\"left\"\n            )\n        \n        cached_holdings_df = classified_df\n        cached_overview_df = overview_df\n        \n        filename = holdings_file.filename or \"\"\n        import re\n        date_match = re.search(r'(\\d{8})', filename)\n        if date_match:\n            date_str = date_match.group(1)\n            cached_date = f\"{date_str[:4]}-{date_str[4:6]}-{date_str[6:8]}\"\n        else:\n            cached_date = pd.Timestamp.now().strftime(\"%Y-%m-%d\")\n        \n        os.unlink(holdings_path)\n        os.unlink(overview_path)\n        \n        total_rows = len(classified_df)\n        categories = classified_df[\"资产分类\"].nunique() if \"资产分类\" in classified_df.columns else 0\n        products = classified_df[\"产品代码\"].nunique() if \"产品代码\" in classified_df.columns else 0\n        \n        return {\n            \"status\": \"success\",\n            \"date\": cached_date,\n            \"stats\": {\n                \"total_rows\": total_rows,\n                \"categories\": categories,\n                \"products\": products\n            },\n            \"overview_columns\": list(overview_df.columns)\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/holdings\")\nasync def get_holdings(\n    group_by: Optional[str] = Query(None, description=\"分组维度，如: 产品经理, 产品代码\"),\n    value_type: str = Query(\"amount\", description=\"数值类型: amount=金额, share=占比\"),\n    share_direction: str = Query(\"row\", description=\"占比方向: row=行占比, column=列占比\"),\n    second_dimension: Optional[str] = Query(None, description=\"第二维度，如产品代码\")\n):\n    global cached_holdings_df, cached_date\n    \n    if cached_holdings_df is None:\n        raise HTTPException(status_code=400, detail=\"请先上传持仓文件\")\n    \n    try:\n        df = cached_holdings_df.copy()\n        rules = get_classification_rules()\n        \n        value_col = \"结算金额折人民币\"\n        df[value_col] = pd.to_numeric(df[value_col], errors=\"coerce\").fillna(0)\n        \n        result_data = []\n        groups = []\n        \n        if group_by and group_by in df.columns:\n            groups = sorted(df[group_by].dropna().unique().tolist())\n        \n        for entry in rules.structure:\n            currency = entry[\"currency\"]\n            group_name = entry[\"group\"]\n            categories = entry.get(\"categories\", [])\n            total_label = entry.get(\"total_label\")\n            \n            group_total_values = {}\n            group_total_shares = {}\n            \n            for category in categories:\n                cat_df = df[df[\"资产分类\"] == category]\n                row_data = {\n                    \"currency\": currency,\n                    \"assetGroup\": group_name,\n                    \"category\": category,\n                    \"isSubtotal\": False,\n                    \"values\": {},\n                    \"shares\": {}\n                }\n                \n                total_amount = cat_df[value_col].sum() / 1e8\n                row_data[\"values\"][\"total\"] = round(total_amount, 4)\n                group_total_values[\"total\"] = group_total_values.get(\"total\", 0) + total_amount\n                \n                if groups:\n                    for g in groups:\n                        g_amount = cat_df[cat_df[group_by] == g][value_col].sum() / 1e8\n                        row_data[\"values\"][str(g)] = round(g_amount, 4)\n                        group_total_values[str(g)] = group_total_values.get(str(g), 0) + g_amount\n                \n                result_data.append(row_data)\n            \n            if total_label or categories:\n                subtotal_data = {\n                    \"currency\": currency,\n                    \"assetGroup\": group_name,\n                    \"category\": total_label or f\"{group_name}合计\",\n                    \"isSubtotal\": True,\n                    \"values\": {k: round(v, 4) for k, v in group_total_values.items()},\n                    \"shares\": {}\n                }\n                result_data.append(subtotal_data)\n        \n        unclassified_df = df[~df[\"资产分类\"].isin([cat for entry in rules.structure for cat in entry.get(\"categories\", [])])]\n        if not unclassified_df.empty:\n            for category in unclassified_df[\"资产分类\"].unique():\n                cat_df = unclassified_df[unclassified_df[\"资产分类\"] == category]\n                row_data = {\n                    \"currency\": \"未分类\",\n                    \"assetGroup\": \"未分类\",\n                    \"category\": category,\n                    \"isSubtotal\": False,\n                    \"values\": {\"total\": round(cat_df[value_col].sum() / 1e8, 4)},\n                    \"shares\": {}\n                }\n                if groups:\n                    for g in groups:\n                        row_data[\"values\"][str(g)] = round(cat_df[cat_df[group_by] == g][value_col].sum() / 1e8, 4)\n                result_data.append(row_data)\n        \n        total_assets = df[value_col].sum() / 1e8\n        repo_amount = df[df[\"资产分类\"] == \"正回购\"][value_col].sum() / 1e8\n        net_assets = total_assets - 2 * repo_amount\n        \n        for row in result_data:\n            base = net_assets if net_assets > 0 else total_assets\n            if value_type == \"share\":\n                if share_direction == \"row\":\n                    row_total = row[\"values\"].get(\"total\", 0)\n                    if row_total > 0:\n                        for k in row[\"values\"]:\n                            row[\"shares\"][k] = round(row[\"values\"][k] / row_total, 6)\n                else:\n                    for k in row[\"values\"]:\n                        col_total = sum(r[\"values\"].get(k, 0) for r in result_data if not r[\"isSubtotal\"])\n                        if col_total > 0:\n                            row[\"shares\"][k] = round(row[\"values\"][k] / col_total, 6)\n            else:\n                for k in row[\"values\"]:\n                    if base > 0:\n                        row[\"shares\"][k] = round(row[\"values\"][k] / base, 6)\n        \n        return {\n            \"date\": cached_date,\n            \"groupBy\": group_by,\n            \"groups\": groups,\n            \"data\": result_data,\n            \"summary\": {\n                \"totalAssets\": round(total_assets, 4),\n                \"netAssets\": round(net_assets, 4)\n            }\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/asset-search\")\nasync def search_asset(keyword: str = Query(..., min_length=1)):\n    global cached_holdings_df\n    \n    if cached_holdings_df is None:\n        raise HTTPException(status_code=400, detail=\"请先上传持仓文件\")\n    \n    try:\n        df = cached_holdings_df.copy()\n        keyword_lower = keyword.lower()\n        \n        mask = (\n            df[\"资产代码\"].astype(str).str.lower().str.contains(keyword_lower, na=False) |\n            df[\"资产名称_norm\"].astype(str).str.lower().str.contains(keyword_lower, na=False)\n        )\n        if \"资产简称\" in df.columns:\n            mask = mask | df[\"资产简称\"].astype(str).str.lower().str.contains(keyword_lower, na=False)\n        \n        matched_df = df[mask]\n        \n        if matched_df.empty:\n            return {\"keyword\": keyword, \"results\": [], \"summary\": None}\n        \n        value_col = \"结算金额折人民币\"\n        matched_df[value_col] = pd.to_numeric(matched_df[value_col], errors=\"coerce\").fillna(0)\n        \n        results = []\n        total_holding = 0\n        \n        for _, row in matched_df.iterrows():\n            amount = row[value_col] / 1e8\n            total_holding += amount\n            \n            product_net_asset = float(row.get(\"净资产(亿)\", 0) or 0)\n            product_share = (amount / product_net_asset) if product_net_asset > 0 else 0\n            \n            results.append({\n                \"productName\": row.get(\"产品简称\", \"\"),\n                \"productCode\": row.get(\"产品代码\", \"\"),\n                \"manager\": row.get(\"产品经理\", \"\"),\n                \"assetCode\": row.get(\"资产代码\", \"\"),\n                \"assetName\": row.get(\"资产名称_norm\", \"\") or row.get(\"资产简称\", \"\"),\n                \"category\": row.get(\"资产分类\", \"\"),\n                \"amount\": round(amount, 6),\n                \"productShare\": round(product_share, 6)\n            })\n        \n        for result in results:\n            result[\"departmentShare\"] = round(result[\"amount\"] / total_holding, 6) if total_holding > 0 else 0\n        \n        results.sort(key=lambda x: x[\"amount\"], reverse=True)\n        \n        return {\n            \"keyword\": keyword,\n            \"results\": results,\n            \"summary\": {\n                \"totalHolding\": round(total_holding, 4),\n                \"productCount\": len(set(r[\"productCode\"] for r in results)),\n                \"matchedAssets\": len(results)\n            }\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/overview-columns\")\nasync def get_overview_columns():\n    global cached_overview_df\n    if cached_overview_df is None:\n        raise HTTPException(status_code=400, detail=\"请先上传产品概览文件\")\n    return {\"columns\": list(cached_overview_df.columns)}\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n"}}
{"type":"tool_result","timestamp":"2026-01-25T09:59:38.459Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py","content":"from fastapi import FastAPI, UploadFile, File, HTTPException, Query\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom fastapi.responses import JSONResponse\nfrom pydantic import BaseModel\nfrom typing import Dict, List, Optional, Any\nimport pandas as pd\nimport numpy as np\nimport tempfile\nimport os\nimport json\nfrom pathlib import Path\n\nfrom classification import (\n    ClassificationRules, \n    load_classification_rules, \n    enrich_holdings, \n    classify_assets,\n    normalize_text\n)\n\napp = FastAPI(title=\"部门持仓分析系统 API\")\n\napp.add_middleware(\n    CORSMiddleware,\n    allow_origins=[\"*\"],\n    allow_credentials=True,\n    allow_methods=[\"*\"],\n    allow_headers=[\"*\"],\n)\n\nBASE_DIR = Path(__file__).parent.parent\nCLASSIFICATION_FILE = BASE_DIR / \"多资产资产分类.xlsx\"\n\ncached_rules: Optional[ClassificationRules] = None\ncached_holdings_df: Optional[pd.DataFrame] = None\ncached_overview_df: Optional[pd.DataFrame] = None\ncached_date: Optional[str] = None\n\ndef get_classification_rules() -> ClassificationRules:\n    global cached_rules\n    if cached_rules is None:\n        cached_rules = load_classification_rules(str(CLASSIFICATION_FILE))\n    return cached_rules\n\ndef dataframe_to_json_safe(df: pd.DataFrame) -> List[Dict]:\n    df_copy = df.copy()\n    for col in df_copy.columns:\n        if df_copy[col].dtype == 'object':\n            df_copy[col] = df_copy[col].fillna('')\n        else:\n            df_copy[col] = df_copy[col].replace([np.inf, -np.inf], np.nan).fillna(0)\n    return df_copy.to_dict(orient='records')\n\n@app.get(\"/api/health\")\nasync def health_check():\n    return {\"status\": \"ok\", \"classification_file_exists\": CLASSIFICATION_FILE.exists()}\n\n@app.get(\"/api/classifications\")\nasync def get_classifications():\n    try:\n        sheets_data = {}\n        sheet_names = [\"资产分类\", \"委外投资标签\", \"公募基金标签\", \"资产代码\"]\n        \n        for sheet_name in sheet_names:\n            try:\n                df = pd.read_excel(str(CLASSIFICATION_FILE), sheet_name=sheet_name)\n                sheets_data[sheet_name] = {\n                    \"columns\": list(df.columns),\n                    \"data\": dataframe_to_json_safe(df)\n                }\n            except Exception as e:\n                sheets_data[sheet_name] = {\"columns\": [], \"data\": [], \"error\": str(e)}\n        \n        return JSONResponse(content=sheets_data)\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\nclass ClassificationUpdate(BaseModel):\n    sheet_name: str\n    data: List[Dict[str, Any]]\n\n@app.post(\"/api/classifications\")\nasync def update_classifications(update: ClassificationUpdate):\n    global cached_rules\n    try:\n        df = pd.DataFrame(update.data)\n        \n        with pd.ExcelFile(str(CLASSIFICATION_FILE)) as xls:\n            all_sheets = {sheet: pd.read_excel(xls, sheet_name=sheet) for sheet in xls.sheet_names}\n        \n        all_sheets[update.sheet_name] = df\n        \n        with pd.ExcelWriter(str(CLASSIFICATION_FILE), engine='openpyxl') as writer:\n            for sheet_name, sheet_df in all_sheets.items():\n                sheet_df.to_excel(writer, sheet_name=sheet_name, index=False)\n        \n        cached_rules = None\n        return {\"status\": \"success\", \"message\": f\"Sheet '{update.sheet_name}' updated successfully\"}\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.post(\"/api/upload\")\nasync def upload_files(\n    holdings_file: UploadFile = File(..., description=\"持仓盈亏明细列表\"),\n    overview_file: UploadFile = File(..., description=\"产品运作概览信息表\")\n):\n    global cached_holdings_df, cached_overview_df, cached_date\n    \n    try:\n        with tempfile.NamedTemporaryFile(delete=False, suffix=\".xlsx\") as tmp_holdings:\n            content = await holdings_file.read()\n            tmp_holdings.write(content)\n            holdings_path = tmp_holdings.name\n        \n        with tempfile.NamedTemporaryFile(delete=False, suffix=\".xlsx\") as tmp_overview:\n            content = await overview_file.read()\n            tmp_overview.write(content)\n            overview_path = tmp_overview.name\n        \n        holdings_df = pd.read_excel(holdings_path)\n        overview_df = pd.read_excel(overview_path)\n        \n        rules = get_classification_rules()\n        enriched_df = enrich_holdings(holdings_df, rules)\n        classified_df = classify_assets(enriched_df, rules)\n        \n        if \"产品代码\" in overview_df.columns:\n            classified_df = classified_df.merge(\n                overview_df[[\"产品代码\", \"产品经理\", \"净资产(亿)\", \"多资产品类\", \"币种\"]].drop_duplicates(),\n                on=\"产品代码\",\n                how=\"left\"\n            )\n        \n        cached_holdings_df = classified_df\n        cached_overview_df = overview_df\n        \n        filename = holdings_file.filename or \"\"\n        import re\n        date_match = re.search(r'(\\d{8})', filename)\n        if date_match:\n            date_str = date_match.group(1)\n            cached_date = f\"{date_str[:4]}-{date_str[4:6]}-{date_str[6:8]}\"\n        else:\n            cached_date = pd.Timestamp.now().strftime(\"%Y-%m-%d\")\n        \n        os.unlink(holdings_path)\n        os.unlink(overview_path)\n        \n        total_rows = len(classified_df)\n        categories = classified_df[\"资产分类\"].nunique() if \"资产分类\" in classified_df.columns else 0\n        products = classified_df[\"产品代码\"].nunique() if \"产品代码\" in classified_df.columns else 0\n        \n        return {\n            \"status\": \"success\",\n            \"date\": cached_date,\n            \"stats\": {\n                \"total_rows\": total_rows,\n                \"categories\": categories,\n                \"products\": products\n            },\n            \"overview_columns\": list(overview_df.columns)\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/holdings\")\nasync def get_holdings(\n    group_by: Optional[str] = Query(None, description=\"分组维度，如: 产品经理, 产品代码\"),\n    value_type: str = Query(\"amount\", description=\"数值类型: amount=金额, share=占比\"),\n    share_direction: str = Query(\"row\", description=\"占比方向: row=行占比, column=列占比\"),\n    second_dimension: Optional[str] = Query(None, description=\"第二维度，如产品代码\")\n):\n    global cached_holdings_df, cached_date\n    \n    if cached_holdings_df is None:\n        raise HTTPException(status_code=400, detail=\"请先上传持仓文件\")\n    \n    try:\n        df = cached_holdings_df.copy()\n        rules = get_classification_rules()\n        \n        value_col = \"结算金额折人民币\"\n        df[value_col] = pd.to_numeric(df[value_col], errors=\"coerce\").fillna(0)\n        \n        result_data = []\n        groups = []\n        \n        if group_by and group_by in df.columns:\n            groups = sorted(df[group_by].dropna().unique().tolist())\n        \n        for entry in rules.structure:\n            currency = entry[\"currency\"]\n            group_name = entry[\"group\"]\n            categories = entry.get(\"categories\", [])\n            total_label = entry.get(\"total_label\")\n            \n            group_total_values = {}\n            group_total_shares = {}\n            \n            for category in categories:\n                cat_df = df[df[\"资产分类\"] == category]\n                row_data = {\n                    \"currency\": currency,\n                    \"assetGroup\": group_name,\n                    \"category\": category,\n                    \"isSubtotal\": False,\n                    \"values\": {},\n                    \"shares\": {}\n                }\n                \n                total_amount = cat_df[value_col].sum() / 1e8\n                row_data[\"values\"][\"total\"] = round(total_amount, 4)\n                group_total_values[\"total\"] = group_total_values.get(\"total\", 0) + total_amount\n                \n                if groups:\n                    for g in groups:\n                        g_amount = cat_df[cat_df[group_by] == g][value_col].sum() / 1e8\n                        row_data[\"values\"][str(g)] = round(g_amount, 4)\n                        group_total_values[str(g)] = group_total_values.get(str(g), 0) + g_amount\n                \n                result_data.append(row_data)\n            \n            if total_label or categories:\n                subtotal_data = {\n                    \"currency\": currency,\n                    \"assetGroup\": group_name,\n                    \"category\": total_label or f\"{group_name}合计\",\n                    \"isSubtotal\": True,\n                    \"values\": {k: round(v, 4) for k, v in group_total_values.items()},\n                    \"shares\": {}\n                }\n                result_data.append(subtotal_data)\n        \n        unclassified_df = df[~df[\"资产分类\"].isin([cat for entry in rules.structure for cat in entry.get(\"categories\", [])])]\n        if not unclassified_df.empty:\n            for category in unclassified_df[\"资产分类\"].unique():\n                cat_df = unclassified_df[unclassified_df[\"资产分类\"] == category]\n                row_data = {\n                    \"currency\": \"未分类\",\n                    \"assetGroup\": \"未分类\",\n                    \"category\": category,\n                    \"isSubtotal\": False,\n                    \"values\": {\"total\": round(cat_df[value_col].sum() / 1e8, 4)},\n                    \"shares\": {}\n                }\n                if groups:\n                    for g in groups:\n                        row_data[\"values\"][str(g)] = round(cat_df[cat_df[group_by] == g][value_col].sum() / 1e8, 4)\n                result_data.append(row_data)\n        \n        total_assets = df[value_col].sum() / 1e8\n        repo_amount = df[df[\"资产分类\"] == \"正回购\"][value_col].sum() / 1e8\n        net_assets = total_assets - 2 * repo_amount\n        \n        for row in result_data:\n            base = net_assets if net_assets > 0 else total_assets\n            if value_type == \"share\":\n                if share_direction == \"row\":\n                    row_total = row[\"values\"].get(\"total\", 0)\n                    if row_total > 0:\n                        for k in row[\"values\"]:\n                            row[\"shares\"][k] = round(row[\"values\"][k] / row_total, 6)\n                else:\n                    for k in row[\"values\"]:\n                        col_total = sum(r[\"values\"].get(k, 0) for r in result_data if not r[\"isSubtotal\"])\n                        if col_total > 0:\n                            row[\"shares\"][k] = round(row[\"values\"][k] / col_total, 6)\n            else:\n                for k in row[\"values\"]:\n                    if base > 0:\n                        row[\"shares\"][k] = round(row[\"values\"][k] / base, 6)\n        \n        return {\n            \"date\": cached_date,\n            \"groupBy\": group_by,\n            \"groups\": groups,\n            \"data\": result_data,\n            \"summary\": {\n                \"totalAssets\": round(total_assets, 4),\n                \"netAssets\": round(net_assets, 4)\n            }\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/asset-search\")\nasync def search_asset(keyword: str = Query(..., min_length=1)):\n    global cached_holdings_df\n    \n    if cached_holdings_df is None:\n        raise HTTPException(status_code=400, detail=\"请先上传持仓文件\")\n    \n    try:\n        df = cached_holdings_df.copy()\n        keyword_lower = keyword.lower()\n        \n        mask = (\n            df[\"资产代码\"].astype(str).str.lower().str.contains(keyword_lower, na=False) |\n            df[\"资产名称_norm\"].astype(str).str.lower().str.contains(keyword_lower, na=False)\n        )\n        if \"资产简称\" in df.columns:\n            mask = mask | df[\"资产简称\"].astype(str).str.lower().str.contains(keyword_lower, na=False)\n        \n        matched_df = df[mask]\n        \n        if matched_df.empty:\n            return {\"keyword\": keyword, \"results\": [], \"summary\": None}\n        \n        value_col = \"结算金额折人民币\"\n        matched_df[value_col] = pd.to_numeric(matched_df[value_col], errors=\"coerce\").fillna(0)\n        \n        results = []\n        total_holding = 0\n        \n        for _, row in matched_df.iterrows():\n            amount = row[value_col] / 1e8\n            total_holding += amount\n            \n            product_net_asset = float(row.get(\"净资产(亿)\", 0) or 0)\n            product_share = (amount / product_net_asset) if product_net_asset > 0 else 0\n            \n            results.append({\n                \"productName\": row.get(\"产品简称\", \"\"),\n                \"productCode\": row.get(\"产品代码\", \"\"),\n                \"manager\": row.get(\"产品经理\", \"\"),\n                \"assetCode\": row.get(\"资产代码\", \"\"),\n                \"assetName\": row.get(\"资产名称_norm\", \"\") or row.get(\"资产简称\", \"\"),\n                \"category\": row.get(\"资产分类\", \"\"),\n                \"amount\": round(amount, 6),\n                \"productShare\": round(product_share, 6)\n            })\n        \n        for result in results:\n            result[\"departmentShare\"] = round(result[\"amount\"] / total_holding, 6) if total_holding > 0 else 0\n        \n        results.sort(key=lambda x: x[\"amount\"], reverse=True)\n        \n        return {\n            \"keyword\": keyword,\n            \"results\": results,\n            \"summary\": {\n                \"totalHolding\": round(total_holding, 4),\n                \"productCount\": len(set(r[\"productCode\"] for r in results)),\n                \"matchedAssets\": len(results)\n            }\n        }\n    except Exception as e:\n        raise HTTPException(status_code=500, detail=str(e))\n\n@app.get(\"/api/overview-columns\")\nasync def get_overview_columns():\n    global cached_overview_df\n    if cached_overview_df is None:\n        raise HTTPException(status_code=400, detail=\"请先上传产品概览文件\")\n    return {\"columns\": list(cached_overview_df.columns)}\n\nif __name__ == \"__main__\":\n    import uvicorn\n    uvicorn.run(app, host=\"0.0.0.0\", port=8000)\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:00:04.066Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"content":"创建后端 FastAPI 服务器和API","id":"2","priority":"high","status":"completed"},{"id":"3","priority":"high","status":"in_progress","content":"创建前端 React + Vite 项目结构"},{"priority":"high","status":"pending","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4"},{"content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high","status":"pending"},{"status":"pending","content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium"},{"priority":"medium","status":"pending","content":"样式优化与交互完善 - 专业金融风格UI","id":"7"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:00:04.074Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"content":"创建后端 FastAPI 服务器和API","id":"2","priority":"high","status":"completed"},{"id":"3","priority":"high","status":"in_progress","content":"创建前端 React + Vite 项目结构"},{"priority":"high","status":"pending","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4"},{"content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high","status":"pending"},{"status":"pending","content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium"},{"priority":"medium","status":"pending","content":"样式优化与交互完善 - 专业金融风格UI","id":"7"}]},"tool_output":{"todos":[{"id":"1","priority":"high","status":"completed","content":"分析需求并设计系统架构 - 已完成数据结构分析"},{"content":"创建后端 FastAPI 服务器和API","id":"2","priority":"high","status":"completed"},{"id":"3","priority":"high","status":"in_progress","content":"创建前端 React + Vite 项目结构"},{"priority":"high","status":"pending","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4"},{"content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high","status":"pending"},{"status":"pending","content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium"},{"priority":"medium","status":"pending","content":"样式优化与交互完善 - 专业金融风格UI","id":"7"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:02:47.765Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统 && npm create vite@latest frontend -- --template react-ts && cd frontend && npm install && npm install @tanstack/react-table lucide-react","description":"Create React Vite frontend project","timeout":180000}}
{"type":"tool_result","timestamp":"2026-01-25T10:05:47.907Z","tool_name":"bash","tool_input":{},"tool_output":{"output":"\n> npx\n> create-vite frontend --template react-ts\n\n│\n◇  Scaffolding project in /Users/fanshengxia/Desktop/部门持仓分析系统/frontend...\n│\n└  Done. Now run:\n\n  cd frontend\n  npm install\n  npm run dev\n\n\nadded 175 packages, and audited 176 packages in 2m\n\n45 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n\n\n<bash_metadata>\nbash tool terminated command after exceeding timeout 180000 ms\n</bash_metadata>","exit":null,"description":"Create React Vite frontend project","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:07:17.038Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm install @tanstack/react-table lucide-react 2>&1 | head -20","description":"Install additional frontend dependencies","timeout":60000}}
{"type":"tool_result","timestamp":"2026-01-25T10:07:42.478Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm install @tanstack/react-table lucide-react 2>&1 | head -20","description":"Install additional frontend dependencies","timeout":60000},"tool_output":{"output":"\nadded 4 packages, and audited 180 packages in 25s\n\n47 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n","exit":0,"description":"Install additional frontend dependencies","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:07:50.366Z","tool_name":"bash","tool_input":{"description":"Install TailwindCSS","timeout":60000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm install -D tailwindcss postcss autoprefixer && npx tailwindcss init -p 2>&1 | head -20"}}
{"type":"tool_result","timestamp":"2026-01-25T10:07:58.289Z","tool_name":"bash","tool_input":{"description":"Install TailwindCSS","timeout":60000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm install -D tailwindcss postcss autoprefixer && npx tailwindcss init -p 2>&1 | head -20"},"tool_output":{"output":"\nadded 4 packages, and audited 184 packages in 7s\n\n49 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\nnpm error could not determine executable to run\nnpm error A complete log of this run can be found in: /Users/fanshengxia/.npm/_logs/2026-01-25T10_07_57_744Z-debug-0.log\n","exit":0,"description":"Install TailwindCSS","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:11:17.210Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && node node_modules/tailwindcss/lib/cli.js init -p 2>&1 || echo \"Creating config manually\"","description":"Initialize TailwindCSS config"}}
{"type":"tool_result","timestamp":"2026-01-25T10:11:17.323Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && node node_modules/tailwindcss/lib/cli.js init -p 2>&1 || echo \"Creating config manually\"","description":"Initialize TailwindCSS config"},"tool_output":{"output":"node:internal/modules/cjs/loader:1408\n  throw err;\n  ^\n\nError: Cannot find module '/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/node_modules/tailwindcss/lib/cli.js'\n    at Function._resolveFilename (node:internal/modules/cjs/loader:1405:15)\n    at defaultResolveImpl (node:internal/modules/cjs/loader:1061:19)\n    at resolveForCJSWithHooks (node:internal/modules/cjs/loader:1066:22)\n    at Function._load (node:internal/modules/cjs/loader:1215:37)\n    at TracingChannel.traceSync (node:diagnostics_channel:322:14)\n    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)\n    at Function.executeUserEntryPoint [as runMain] (node:internal/modules/run_main:151:5)\n    at node:internal/main/run_main_module:33:47 {\n  code: 'MODULE_NOT_FOUND',\n  requireStack: []\n}\n\nNode.js v23.11.0\nCreating config manually\n","exit":0,"description":"Initialize TailwindCSS config","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:11:26.941Z","tool_name":"write","tool_input":{"content":"/** @type {import('tailwindcss').Config} */\nexport default {\n  content: [\n    \"./index.html\",\n    \"./src/**/*.{js,ts,jsx,tsx}\",\n  ],\n  theme: {\n    extend: {\n      colors: {\n        navy: {\n          50: '#e7ecf1',\n          100: '#c3ceda',\n          200: '#9bafc2',\n          300: '#7390aa',\n          400: '#547898',\n          500: '#356186',\n          600: '#30597c',\n          700: '#284f6f',\n          800: '#1F497D',\n          900: '#142c4a',\n        },\n        financial: {\n          header: '#1F497D',\n          headerAlt: '#305496',\n          subtotal: '#E7E6E6',\n          total: '#BDD7EE',\n          border: '#D4D4D4',\n        }\n      },\n      fontFamily: {\n        sans: ['IBM Plex Sans', 'Source Sans Pro', 'system-ui', 'sans-serif'],\n        mono: ['IBM Plex Mono', 'monospace'],\n      }\n    },\n  },\n  plugins: [],\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/tailwind.config.js"}}
{"type":"tool_use","timestamp":"2026-01-25T10:11:28.376Z","tool_name":"write","tool_input":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js"}}
{"type":"tool_result","timestamp":"2026-01-25T10:11:28.421Z","tool_name":"write","tool_input":{"content":"/** @type {import('tailwindcss').Config} */\nexport default {\n  content: [\n    \"./index.html\",\n    \"./src/**/*.{js,ts,jsx,tsx}\",\n  ],\n  theme: {\n    extend: {\n      colors: {\n        navy: {\n          50: '#e7ecf1',\n          100: '#c3ceda',\n          200: '#9bafc2',\n          300: '#7390aa',\n          400: '#547898',\n          500: '#356186',\n          600: '#30597c',\n          700: '#284f6f',\n          800: '#1F497D',\n          900: '#142c4a',\n        },\n        financial: {\n          header: '#1F497D',\n          headerAlt: '#305496',\n          subtotal: '#E7E6E6',\n          total: '#BDD7EE',\n          border: '#D4D4D4',\n        }\n      },\n      fontFamily: {\n        sans: ['IBM Plex Sans', 'Source Sans Pro', 'system-ui', 'sans-serif'],\n        mono: ['IBM Plex Mono', 'monospace'],\n      }\n    },\n  },\n  plugins: [],\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/tailwind.config.js"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/tailwind.config.js","exists":false,"truncated":false}}
{"type":"tool_result","timestamp":"2026-01-25T10:11:28.423Z","tool_name":"write","tool_input":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:11:43.059Z","tool_name":"write","tool_input":{"content":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --navy-primary: #1F497D;\n  --navy-secondary: #305496;\n  --subtotal-bg: #E7E6E6;\n  --total-bg: #BDD7EE;\n  --border-color: #D4D4D4;\n}\n\nbody {\n  font-family: 'IBM Plex Sans', 'Source Sans Pro', system-ui, sans-serif;\n  background-color: #f8fafc;\n  color: #1e293b;\n}\n\n.financial-table {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.financial-table th,\n.financial-table td {\n  border: 1px solid var(--border-color);\n  padding: 8px 12px;\n  font-size: 13px;\n}\n\n.financial-table th {\n  background-color: var(--navy-primary);\n  color: white;\n  font-weight: 600;\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n}\n\n.financial-table td {\n  vertical-align: middle;\n}\n\n.financial-table td.currency-cell {\n  background-color: var(--navy-secondary);\n  color: white;\n  font-weight: 700;\n  text-align: center;\n  writing-mode: horizontal-tb;\n}\n\n.financial-table td.value-cell {\n  text-align: right;\n  font-family: 'IBM Plex Mono', monospace;\n  font-size: 12px;\n}\n\n.financial-table tr.subtotal-row td {\n  background-color: var(--subtotal-bg);\n  font-weight: 600;\n}\n\n.financial-table tr.total-row td {\n  background-color: var(--total-bg);\n  font-weight: 700;\n}\n\n.file-drop-zone {\n  border: 2px dashed #cbd5e1;\n  border-radius: 12px;\n  padding: 48px;\n  text-align: center;\n  transition: all 0.2s ease;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n\n.file-drop-zone:hover,\n.file-drop-zone.drag-over {\n  border-color: var(--navy-primary);\n  background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);\n}\n\n.sidebar-link {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #64748b;\n  transition: all 0.15s ease;\n  font-weight: 500;\n}\n\n.sidebar-link:hover {\n  background-color: #f1f5f9;\n  color: #1e293b;\n}\n\n.sidebar-link.active {\n  background-color: var(--navy-primary);\n  color: white;\n}\n\n.filter-select {\n  padding: 8px 12px;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  background: white;\n  font-size: 14px;\n  min-width: 160px;\n  cursor: pointer;\n}\n\n.filter-select:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 0 0 3px rgba(31, 73, 125, 0.1);\n}\n\n.toggle-btn {\n  padding: 6px 14px;\n  border: 1px solid #e2e8f0;\n  background: white;\n  font-size: 13px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.toggle-btn:first-child {\n  border-radius: 6px 0 0 6px;\n}\n\n.toggle-btn:last-child {\n  border-radius: 0 6px 6px 0;\n  border-left: none;\n}\n\n.toggle-btn.active {\n  background-color: var(--navy-primary);\n  color: white;\n  border-color: var(--navy-primary);\n}\n\n.editable-cell {\n  cursor: pointer;\n  transition: background-color 0.15s ease;\n}\n\n.editable-cell:hover {\n  background-color: #fef3c7;\n}\n\n.editable-cell input {\n  width: 100%;\n  padding: 4px 8px;\n  border: 2px solid var(--navy-primary);\n  border-radius: 4px;\n  font-size: inherit;\n  font-family: inherit;\n}\n\n.search-input {\n  width: 100%;\n  max-width: 400px;\n  padding: 12px 16px 12px 44px;\n  border: 2px solid #e2e8f0;\n  border-radius: 10px;\n  font-size: 15px;\n  transition: all 0.2s ease;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 4px 12px rgba(31, 73, 125, 0.15);\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css"}}
{"type":"tool_use","timestamp":"2026-01-25T10:11:50.042Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css"}}
{"type":"tool_result","timestamp":"2026-01-25T10:11:50.050Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css"},"tool_output":{"preview":":root {\n  font-family: system-ui, Avenir, Helvetica, Arial, sans-serif;\n  line-height: 1.5;\n  font-weight: 400;\n\n  color-scheme: light dark;\n  color: rgba(255, 255, 255, 0.87);\n  background-color: #242424;\n\n  font-synthesis: none;\n  text-rendering: optimizeLegibility;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\na {\n  font-weight: 500;\n  color: #646cff;\n  text-decoration: inherit;\n}","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:12:07.897Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css","content":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --navy-primary: #1F497D;\n  --navy-secondary: #305496;\n  --subtotal-bg: #E7E6E6;\n  --total-bg: #BDD7EE;\n  --border-color: #D4D4D4;\n}\n\nbody {\n  font-family: 'IBM Plex Sans', 'Source Sans Pro', system-ui, sans-serif;\n  background-color: #f8fafc;\n  color: #1e293b;\n  margin: 0;\n}\n\n.financial-table {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.financial-table th,\n.financial-table td {\n  border: 1px solid var(--border-color);\n  padding: 8px 12px;\n  font-size: 13px;\n}\n\n.financial-table th {\n  background-color: var(--navy-primary);\n  color: white;\n  font-weight: 600;\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n}\n\n.financial-table td {\n  vertical-align: middle;\n}\n\n.financial-table td.currency-cell {\n  background-color: var(--navy-secondary);\n  color: white;\n  font-weight: 700;\n  text-align: center;\n}\n\n.financial-table td.value-cell {\n  text-align: right;\n  font-family: 'IBM Plex Mono', monospace;\n  font-size: 12px;\n}\n\n.financial-table tr.subtotal-row td {\n  background-color: var(--subtotal-bg);\n  font-weight: 600;\n}\n\n.financial-table tr.total-row td {\n  background-color: var(--total-bg);\n  font-weight: 700;\n}\n\n.file-drop-zone {\n  border: 2px dashed #cbd5e1;\n  border-radius: 12px;\n  padding: 48px;\n  text-align: center;\n  transition: all 0.2s ease;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n\n.file-drop-zone:hover,\n.file-drop-zone.drag-over {\n  border-color: var(--navy-primary);\n  background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);\n}\n\n.sidebar-link {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #64748b;\n  transition: all 0.15s ease;\n  font-weight: 500;\n  text-decoration: none;\n}\n\n.sidebar-link:hover {\n  background-color: #f1f5f9;\n  color: #1e293b;\n}\n\n.sidebar-link.active {\n  background-color: var(--navy-primary);\n  color: white;\n}\n\n.filter-select {\n  padding: 8px 12px;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  background: white;\n  font-size: 14px;\n  min-width: 160px;\n  cursor: pointer;\n}\n\n.filter-select:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 0 0 3px rgba(31, 73, 125, 0.1);\n}\n\n.toggle-btn {\n  padding: 6px 14px;\n  border: 1px solid #e2e8f0;\n  background: white;\n  font-size: 13px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.toggle-btn:first-child {\n  border-radius: 6px 0 0 6px;\n}\n\n.toggle-btn:last-child {\n  border-radius: 0 6px 6px 0;\n  border-left: none;\n}\n\n.toggle-btn.active {\n  background-color: var(--navy-primary);\n  color: white;\n  border-color: var(--navy-primary);\n}\n\n.search-input {\n  width: 100%;\n  max-width: 400px;\n  padding: 12px 16px 12px 44px;\n  border: 2px solid #e2e8f0;\n  border-radius: 10px;\n  font-size: 15px;\n  transition: all 0.2s ease;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 4px 12px rgba(31, 73, 125, 0.15);\n}\n"}}
{"type":"tool_result","timestamp":"2026-01-25T10:12:07.959Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css","content":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --navy-primary: #1F497D;\n  --navy-secondary: #305496;\n  --subtotal-bg: #E7E6E6;\n  --total-bg: #BDD7EE;\n  --border-color: #D4D4D4;\n}\n\nbody {\n  font-family: 'IBM Plex Sans', 'Source Sans Pro', system-ui, sans-serif;\n  background-color: #f8fafc;\n  color: #1e293b;\n  margin: 0;\n}\n\n.financial-table {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.financial-table th,\n.financial-table td {\n  border: 1px solid var(--border-color);\n  padding: 8px 12px;\n  font-size: 13px;\n}\n\n.financial-table th {\n  background-color: var(--navy-primary);\n  color: white;\n  font-weight: 600;\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n}\n\n.financial-table td {\n  vertical-align: middle;\n}\n\n.financial-table td.currency-cell {\n  background-color: var(--navy-secondary);\n  color: white;\n  font-weight: 700;\n  text-align: center;\n}\n\n.financial-table td.value-cell {\n  text-align: right;\n  font-family: 'IBM Plex Mono', monospace;\n  font-size: 12px;\n}\n\n.financial-table tr.subtotal-row td {\n  background-color: var(--subtotal-bg);\n  font-weight: 600;\n}\n\n.financial-table tr.total-row td {\n  background-color: var(--total-bg);\n  font-weight: 700;\n}\n\n.file-drop-zone {\n  border: 2px dashed #cbd5e1;\n  border-radius: 12px;\n  padding: 48px;\n  text-align: center;\n  transition: all 0.2s ease;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n\n.file-drop-zone:hover,\n.file-drop-zone.drag-over {\n  border-color: var(--navy-primary);\n  background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);\n}\n\n.sidebar-link {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #64748b;\n  transition: all 0.15s ease;\n  font-weight: 500;\n  text-decoration: none;\n}\n\n.sidebar-link:hover {\n  background-color: #f1f5f9;\n  color: #1e293b;\n}\n\n.sidebar-link.active {\n  background-color: var(--navy-primary);\n  color: white;\n}\n\n.filter-select {\n  padding: 8px 12px;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  background: white;\n  font-size: 14px;\n  min-width: 160px;\n  cursor: pointer;\n}\n\n.filter-select:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 0 0 3px rgba(31, 73, 125, 0.1);\n}\n\n.toggle-btn {\n  padding: 6px 14px;\n  border: 1px solid #e2e8f0;\n  background: white;\n  font-size: 13px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.toggle-btn:first-child {\n  border-radius: 6px 0 0 6px;\n}\n\n.toggle-btn:last-child {\n  border-radius: 0 6px 6px 0;\n  border-left: none;\n}\n\n.toggle-btn.active {\n  background-color: var(--navy-primary);\n  color: white;\n  border-color: var(--navy-primary);\n}\n\n.search-input {\n  width: 100%;\n  max-width: 400px;\n  padding: 12px 16px 12px 44px;\n  border: 2px solid #e2e8f0;\n  border-radius: 10px;\n  font-size: 15px;\n  transition: all 0.2s ease;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 4px 12px rgba(31, 73, 125, 0.15);\n}\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css","exists":true,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:13:18.477Z","tool_name":"bash","tool_input":{"command":"mkdir -p /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/lib","description":"Create component directories"}}
{"type":"tool_result","timestamp":"2026-01-25T10:13:19.787Z","tool_name":"bash","tool_input":{"command":"mkdir -p /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/lib","description":"Create component directories"},"tool_output":{"output":"","exit":0,"description":"Create component directories","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:13:37.486Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/lib/api.ts","content":"const API_BASE = 'http://localhost:8000/api';\n\nexport interface HoldingsRow {\n  currency: string;\n  assetGroup: string;\n  category: string;\n  isSubtotal: boolean;\n  values: Record<string, number>;\n  shares: Record<string, number>;\n}\n\nexport interface HoldingsData {\n  date: string;\n  groupBy: string | null;\n  groups: string[];\n  data: HoldingsRow[];\n  summary: {\n    totalAssets: number;\n    netAssets: number;\n  };\n}\n\nexport interface UploadResponse {\n  status: string;\n  date: string;\n  stats: {\n    total_rows: number;\n    categories: number;\n    products: number;\n  };\n  overview_columns: string[];\n}\n\nexport interface SearchResult {\n  productName: string;\n  productCode: string;\n  manager: string;\n  assetCode: string;\n  assetName: string;\n  category: string;\n  amount: number;\n  productShare: number;\n  departmentShare: number;\n}\n\nexport interface SearchResponse {\n  keyword: string;\n  results: SearchResult[];\n  summary: {\n    totalHolding: number;\n    productCount: number;\n    matchedAssets: number;\n  } | null;\n}\n\nexport interface ClassificationSheet {\n  columns: string[];\n  data: Record<string, unknown>[];\n  error?: string;\n}\n\nexport async function uploadFiles(holdingsFile: File, overviewFile: File): Promise<UploadResponse> {\n  const formData = new FormData();\n  formData.append('holdings_file', holdingsFile);\n  formData.append('overview_file', overviewFile);\n  \n  const response = await fetch(`${API_BASE}/upload`, {\n    method: 'POST',\n    body: formData,\n  });\n  \n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Upload failed');\n  }\n  \n  return response.json();\n}\n\nexport async function getHoldings(params: {\n  groupBy?: string;\n  valueType?: 'amount' | 'share';\n  shareDirection?: 'row' | 'column';\n}): Promise<HoldingsData> {\n  const searchParams = new URLSearchParams();\n  if (params.groupBy) searchParams.set('group_by', params.groupBy);\n  if (params.valueType) searchParams.set('value_type', params.valueType);\n  if (params.shareDirection) searchParams.set('share_direction', params.shareDirection);\n  \n  const response = await fetch(`${API_BASE}/holdings?${searchParams}`);\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to fetch holdings');\n  }\n  return response.json();\n}\n\nexport async function searchAsset(keyword: string): Promise<SearchResponse> {\n  const response = await fetch(`${API_BASE}/asset-search?keyword=${encodeURIComponent(keyword)}`);\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Search failed');\n  }\n  return response.json();\n}\n\nexport async function getClassifications(): Promise<Record<string, ClassificationSheet>> {\n  const response = await fetch(`${API_BASE}/classifications`);\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to fetch classifications');\n  }\n  return response.json();\n}\n\nexport async function updateClassifications(sheetName: string, data: Record<string, unknown>[]): Promise<void> {\n  const response = await fetch(`${API_BASE}/classifications`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ sheet_name: sheetName, data }),\n  });\n  \n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to update classifications');\n  }\n}\n\nexport async function getOverviewColumns(): Promise<string[]> {\n  const response = await fetch(`${API_BASE}/overview-columns`);\n  if (!response.ok) return [];\n  const data = await response.json();\n  return data.columns || [];\n}\n"}}
{"type":"tool_result","timestamp":"2026-01-25T10:13:37.503Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/lib/api.ts","content":"const API_BASE = 'http://localhost:8000/api';\n\nexport interface HoldingsRow {\n  currency: string;\n  assetGroup: string;\n  category: string;\n  isSubtotal: boolean;\n  values: Record<string, number>;\n  shares: Record<string, number>;\n}\n\nexport interface HoldingsData {\n  date: string;\n  groupBy: string | null;\n  groups: string[];\n  data: HoldingsRow[];\n  summary: {\n    totalAssets: number;\n    netAssets: number;\n  };\n}\n\nexport interface UploadResponse {\n  status: string;\n  date: string;\n  stats: {\n    total_rows: number;\n    categories: number;\n    products: number;\n  };\n  overview_columns: string[];\n}\n\nexport interface SearchResult {\n  productName: string;\n  productCode: string;\n  manager: string;\n  assetCode: string;\n  assetName: string;\n  category: string;\n  amount: number;\n  productShare: number;\n  departmentShare: number;\n}\n\nexport interface SearchResponse {\n  keyword: string;\n  results: SearchResult[];\n  summary: {\n    totalHolding: number;\n    productCount: number;\n    matchedAssets: number;\n  } | null;\n}\n\nexport interface ClassificationSheet {\n  columns: string[];\n  data: Record<string, unknown>[];\n  error?: string;\n}\n\nexport async function uploadFiles(holdingsFile: File, overviewFile: File): Promise<UploadResponse> {\n  const formData = new FormData();\n  formData.append('holdings_file', holdingsFile);\n  formData.append('overview_file', overviewFile);\n  \n  const response = await fetch(`${API_BASE}/upload`, {\n    method: 'POST',\n    body: formData,\n  });\n  \n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Upload failed');\n  }\n  \n  return response.json();\n}\n\nexport async function getHoldings(params: {\n  groupBy?: string;\n  valueType?: 'amount' | 'share';\n  shareDirection?: 'row' | 'column';\n}): Promise<HoldingsData> {\n  const searchParams = new URLSearchParams();\n  if (params.groupBy) searchParams.set('group_by', params.groupBy);\n  if (params.valueType) searchParams.set('value_type', params.valueType);\n  if (params.shareDirection) searchParams.set('share_direction', params.shareDirection);\n  \n  const response = await fetch(`${API_BASE}/holdings?${searchParams}`);\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to fetch holdings');\n  }\n  return response.json();\n}\n\nexport async function searchAsset(keyword: string): Promise<SearchResponse> {\n  const response = await fetch(`${API_BASE}/asset-search?keyword=${encodeURIComponent(keyword)}`);\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Search failed');\n  }\n  return response.json();\n}\n\nexport async function getClassifications(): Promise<Record<string, ClassificationSheet>> {\n  const response = await fetch(`${API_BASE}/classifications`);\n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to fetch classifications');\n  }\n  return response.json();\n}\n\nexport async function updateClassifications(sheetName: string, data: Record<string, unknown>[]): Promise<void> {\n  const response = await fetch(`${API_BASE}/classifications`, {\n    method: 'POST',\n    headers: { 'Content-Type': 'application/json' },\n    body: JSON.stringify({ sheet_name: sheetName, data }),\n  });\n  \n  if (!response.ok) {\n    const error = await response.json();\n    throw new Error(error.detail || 'Failed to update classifications');\n  }\n}\n\nexport async function getOverviewColumns(): Promise<string[]> {\n  const response = await fetch(`${API_BASE}/overview-columns`);\n  if (!response.ok) return [];\n  const data = await response.json();\n  return data.columns || [];\n}\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/lib/api.ts","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:14:00.776Z","tool_name":"write","tool_input":{"content":"import { useState, useCallback } from 'react';\nimport { Upload, FileSpreadsheet, AlertCircle, CheckCircle2 } from 'lucide-react';\nimport { uploadFiles, getHoldings, getOverviewColumns, type UploadResponse, type HoldingsData } from '../lib/api';\nimport { HoldingsTable } from '../components/HoldingsTable';\nimport { FilterBar } from '../components/FilterBar';\n\nexport function HoldingsPage() {\n  const [holdingsFile, setHoldingsFile] = useState<File | null>(null);\n  const [overviewFile, setOverviewFile] = useState<File | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [uploadResult, setUploadResult] = useState<UploadResponse | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [holdingsData, setHoldingsData] = useState<HoldingsData | null>(null);\n  const [overviewColumns, setOverviewColumns] = useState<string[]>([]);\n  const [groupBy, setGroupBy] = useState<string>('');\n  const [valueType, setValueType] = useState<'amount' | 'share'>('amount');\n  const [shareDirection, setShareDirection] = useState<'row' | 'column'>('row');\n  const [loading, setLoading] = useState(false);\n\n  const handleUpload = useCallback(async () => {\n    if (!holdingsFile || !overviewFile) return;\n    \n    setUploading(true);\n    setError(null);\n    \n    try {\n      const result = await uploadFiles(holdingsFile, overviewFile);\n      setUploadResult(result);\n      setOverviewColumns(result.overview_columns);\n      \n      const holdings = await getHoldings({ valueType: 'amount' });\n      setHoldingsData(holdings);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Upload failed');\n    } finally {\n      setUploading(false);\n    }\n  }, [holdingsFile, overviewFile]);\n\n  const handleFilterChange = useCallback(async (newGroupBy: string, newValueType: 'amount' | 'share', newShareDirection: 'row' | 'column') => {\n    setGroupBy(newGroupBy);\n    setValueType(newValueType);\n    setShareDirection(newShareDirection);\n    setLoading(true);\n    \n    try {\n      const holdings = await getHoldings({\n        groupBy: newGroupBy || undefined,\n        valueType: newValueType,\n        shareDirection: newShareDirection,\n      });\n      setHoldingsData(holdings);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch data');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent, type: 'holdings' | 'overview') => {\n    e.preventDefault();\n    const file = e.dataTransfer.files[0];\n    if (file && file.name.endsWith('.xlsx')) {\n      if (type === 'holdings') setHoldingsFile(file);\n      else setOverviewFile(file);\n    }\n  }, []);\n\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold text-gray-800 mb-6\">持仓分析</h1>\n      \n      {!uploadResult && (\n        <div className=\"grid grid-cols-2 gap-6 mb-6\">\n          <div\n            className={`file-drop-zone ${holdingsFile ? 'border-green-500 bg-green-50' : ''}`}\n            onDrop={(e) => handleDrop(e, 'holdings')}\n            onDragOver={(e) => e.preventDefault()}\n          >\n            <FileSpreadsheet className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\n            <p className=\"text-lg font-medium text-gray-700 mb-2\">持仓盈亏明细列表</p>\n            {holdingsFile ? (\n              <p className=\"text-green-600 flex items-center justify-center gap-2\">\n                <CheckCircle2 className=\"w-5 h-5\" />\n                {holdingsFile.name}\n              </p>\n            ) : (\n              <p className=\"text-gray-500 text-sm\">拖拽文件到此处，或点击选择</p>\n            )}\n            <input\n              type=\"file\"\n              accept=\".xlsx\"\n              className=\"hidden\"\n              id=\"holdings-input\"\n              onChange={(e) => setHoldingsFile(e.target.files?.[0] || null)}\n            />\n            <label htmlFor=\"holdings-input\" className=\"mt-4 inline-block px-4 py-2 bg-white border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 text-sm\">\n              选择文件\n            </label>\n          </div>\n          \n          <div\n            className={`file-drop-zone ${overviewFile ? 'border-green-500 bg-green-50' : ''}`}\n            onDrop={(e) => handleDrop(e, 'overview')}\n            onDragOver={(e) => e.preventDefault()}\n          >\n            <FileSpreadsheet className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\n            <p className=\"text-lg font-medium text-gray-700 mb-2\">产品运作概览信息表</p>\n            {overviewFile ? (\n              <p className=\"text-green-600 flex items-center justify-center gap-2\">\n                <CheckCircle2 className=\"w-5 h-5\" />\n                {overviewFile.name}\n              </p>\n            ) : (\n              <p className=\"text-gray-500 text-sm\">拖拽文件到此处，或点击选择</p>\n            )}\n            <input\n              type=\"file\"\n              accept=\".xlsx\"\n              className=\"hidden\"\n              id=\"overview-input\"\n              onChange={(e) => setOverviewFile(e.target.files?.[0] || null)}\n            />\n            <label htmlFor=\"overview-input\" className=\"mt-4 inline-block px-4 py-2 bg-white border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 text-sm\">\n              选择文件\n            </label>\n          </div>\n        </div>\n      )}\n      \n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 text-red-700\">\n          <AlertCircle className=\"w-5 h-5\" />\n          {error}\n        </div>\n      )}\n      \n      {!uploadResult && holdingsFile && overviewFile && (\n        <button\n          onClick={handleUpload}\n          disabled={uploading}\n          className=\"w-full py-3 bg-navy-800 text-white rounded-lg font-medium hover:bg-navy-700 disabled:opacity-50 flex items-center justify-center gap-2\"\n        >\n          {uploading ? (\n            <>\n              <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n              处理中...\n            </>\n          ) : (\n            <>\n              <Upload className=\"w-5 h-5\" />\n              开始分析\n            </>\n          )}\n        </button>\n      )}\n      \n      {uploadResult && holdingsData && (\n        <>\n          <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n            <p className=\"text-blue-800\">\n              <strong>数据日期:</strong> {holdingsData.date} | \n              <strong> 持仓记录:</strong> {uploadResult.stats.total_rows.toLocaleString()} | \n              <strong> 资产类别:</strong> {uploadResult.stats.categories} | \n              <strong> 产品数:</strong> {uploadResult.stats.products}\n            </p>\n          </div>\n          \n          <FilterBar\n            columns={overviewColumns}\n            groupBy={groupBy}\n            valueType={valueType}\n            shareDirection={shareDirection}\n            onFilterChange={handleFilterChange}\n          />\n          \n          <div className=\"mt-4 bg-white rounded-lg shadow overflow-hidden\">\n            {loading ? (\n              <div className=\"p-12 text-center text-gray-500\">\n                <div className=\"w-8 h-8 border-2 border-navy-800 border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\n                加载中...\n              </div>\n            ) : (\n              <HoldingsTable \n                data={holdingsData} \n                valueType={valueType}\n              />\n            )}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/HoldingsPage.tsx"}}
{"type":"tool_result","timestamp":"2026-01-25T10:14:00.811Z","tool_name":"write","tool_input":{"content":"import { useState, useCallback } from 'react';\nimport { Upload, FileSpreadsheet, AlertCircle, CheckCircle2 } from 'lucide-react';\nimport { uploadFiles, getHoldings, getOverviewColumns, type UploadResponse, type HoldingsData } from '../lib/api';\nimport { HoldingsTable } from '../components/HoldingsTable';\nimport { FilterBar } from '../components/FilterBar';\n\nexport function HoldingsPage() {\n  const [holdingsFile, setHoldingsFile] = useState<File | null>(null);\n  const [overviewFile, setOverviewFile] = useState<File | null>(null);\n  const [uploading, setUploading] = useState(false);\n  const [uploadResult, setUploadResult] = useState<UploadResponse | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [holdingsData, setHoldingsData] = useState<HoldingsData | null>(null);\n  const [overviewColumns, setOverviewColumns] = useState<string[]>([]);\n  const [groupBy, setGroupBy] = useState<string>('');\n  const [valueType, setValueType] = useState<'amount' | 'share'>('amount');\n  const [shareDirection, setShareDirection] = useState<'row' | 'column'>('row');\n  const [loading, setLoading] = useState(false);\n\n  const handleUpload = useCallback(async () => {\n    if (!holdingsFile || !overviewFile) return;\n    \n    setUploading(true);\n    setError(null);\n    \n    try {\n      const result = await uploadFiles(holdingsFile, overviewFile);\n      setUploadResult(result);\n      setOverviewColumns(result.overview_columns);\n      \n      const holdings = await getHoldings({ valueType: 'amount' });\n      setHoldingsData(holdings);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Upload failed');\n    } finally {\n      setUploading(false);\n    }\n  }, [holdingsFile, overviewFile]);\n\n  const handleFilterChange = useCallback(async (newGroupBy: string, newValueType: 'amount' | 'share', newShareDirection: 'row' | 'column') => {\n    setGroupBy(newGroupBy);\n    setValueType(newValueType);\n    setShareDirection(newShareDirection);\n    setLoading(true);\n    \n    try {\n      const holdings = await getHoldings({\n        groupBy: newGroupBy || undefined,\n        valueType: newValueType,\n        shareDirection: newShareDirection,\n      });\n      setHoldingsData(holdings);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to fetch data');\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  const handleDrop = useCallback((e: React.DragEvent, type: 'holdings' | 'overview') => {\n    e.preventDefault();\n    const file = e.dataTransfer.files[0];\n    if (file && file.name.endsWith('.xlsx')) {\n      if (type === 'holdings') setHoldingsFile(file);\n      else setOverviewFile(file);\n    }\n  }, []);\n\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold text-gray-800 mb-6\">持仓分析</h1>\n      \n      {!uploadResult && (\n        <div className=\"grid grid-cols-2 gap-6 mb-6\">\n          <div\n            className={`file-drop-zone ${holdingsFile ? 'border-green-500 bg-green-50' : ''}`}\n            onDrop={(e) => handleDrop(e, 'holdings')}\n            onDragOver={(e) => e.preventDefault()}\n          >\n            <FileSpreadsheet className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\n            <p className=\"text-lg font-medium text-gray-700 mb-2\">持仓盈亏明细列表</p>\n            {holdingsFile ? (\n              <p className=\"text-green-600 flex items-center justify-center gap-2\">\n                <CheckCircle2 className=\"w-5 h-5\" />\n                {holdingsFile.name}\n              </p>\n            ) : (\n              <p className=\"text-gray-500 text-sm\">拖拽文件到此处，或点击选择</p>\n            )}\n            <input\n              type=\"file\"\n              accept=\".xlsx\"\n              className=\"hidden\"\n              id=\"holdings-input\"\n              onChange={(e) => setHoldingsFile(e.target.files?.[0] || null)}\n            />\n            <label htmlFor=\"holdings-input\" className=\"mt-4 inline-block px-4 py-2 bg-white border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 text-sm\">\n              选择文件\n            </label>\n          </div>\n          \n          <div\n            className={`file-drop-zone ${overviewFile ? 'border-green-500 bg-green-50' : ''}`}\n            onDrop={(e) => handleDrop(e, 'overview')}\n            onDragOver={(e) => e.preventDefault()}\n          >\n            <FileSpreadsheet className=\"w-12 h-12 mx-auto mb-4 text-gray-400\" />\n            <p className=\"text-lg font-medium text-gray-700 mb-2\">产品运作概览信息表</p>\n            {overviewFile ? (\n              <p className=\"text-green-600 flex items-center justify-center gap-2\">\n                <CheckCircle2 className=\"w-5 h-5\" />\n                {overviewFile.name}\n              </p>\n            ) : (\n              <p className=\"text-gray-500 text-sm\">拖拽文件到此处，或点击选择</p>\n            )}\n            <input\n              type=\"file\"\n              accept=\".xlsx\"\n              className=\"hidden\"\n              id=\"overview-input\"\n              onChange={(e) => setOverviewFile(e.target.files?.[0] || null)}\n            />\n            <label htmlFor=\"overview-input\" className=\"mt-4 inline-block px-4 py-2 bg-white border border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 text-sm\">\n              选择文件\n            </label>\n          </div>\n        </div>\n      )}\n      \n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 text-red-700\">\n          <AlertCircle className=\"w-5 h-5\" />\n          {error}\n        </div>\n      )}\n      \n      {!uploadResult && holdingsFile && overviewFile && (\n        <button\n          onClick={handleUpload}\n          disabled={uploading}\n          className=\"w-full py-3 bg-navy-800 text-white rounded-lg font-medium hover:bg-navy-700 disabled:opacity-50 flex items-center justify-center gap-2\"\n        >\n          {uploading ? (\n            <>\n              <div className=\"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n              处理中...\n            </>\n          ) : (\n            <>\n              <Upload className=\"w-5 h-5\" />\n              开始分析\n            </>\n          )}\n        </button>\n      )}\n      \n      {uploadResult && holdingsData && (\n        <>\n          <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n            <p className=\"text-blue-800\">\n              <strong>数据日期:</strong> {holdingsData.date} | \n              <strong> 持仓记录:</strong> {uploadResult.stats.total_rows.toLocaleString()} | \n              <strong> 资产类别:</strong> {uploadResult.stats.categories} | \n              <strong> 产品数:</strong> {uploadResult.stats.products}\n            </p>\n          </div>\n          \n          <FilterBar\n            columns={overviewColumns}\n            groupBy={groupBy}\n            valueType={valueType}\n            shareDirection={shareDirection}\n            onFilterChange={handleFilterChange}\n          />\n          \n          <div className=\"mt-4 bg-white rounded-lg shadow overflow-hidden\">\n            {loading ? (\n              <div className=\"p-12 text-center text-gray-500\">\n                <div className=\"w-8 h-8 border-2 border-navy-800 border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\n                加载中...\n              </div>\n            ) : (\n              <HoldingsTable \n                data={holdingsData} \n                valueType={valueType}\n              />\n            )}\n          </div>\n        </>\n      )}\n    </div>\n  );\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/HoldingsPage.tsx"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/HoldingsPage.tsx","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:16:35.020Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components/HoldingsTable.tsx","content":"import { useMemo } from 'react';\nimport { type HoldingsData } from '../lib/api';\n\ninterface HoldingsTableProps {\n  data: HoldingsData;\n  valueType: 'amount' | 'share';\n}\n\nexport function HoldingsTable({ data, valueType }: HoldingsTableProps) {\n  const { processedData, currencySpans, groupSpans } = useMemo(() => {\n    const rows = data.data;\n    const currencySpans: Map<number, number> = new Map();\n    const groupSpans: Map<number, number> = new Map();\n    \n    let currentCurrency = '';\n    let currencyStart = 0;\n    let currentGroup = '';\n    let groupStart = 0;\n    \n    rows.forEach((row, index) => {\n      if (row.currency !== currentCurrency) {\n        if (currentCurrency && index > currencyStart) {\n          currencySpans.set(currencyStart, index - currencyStart);\n        }\n        currentCurrency = row.currency;\n        currencyStart = index;\n      }\n      \n      if (row.assetGroup !== currentGroup || row.currency !== currentCurrency) {\n        if (currentGroup && index > groupStart) {\n          groupSpans.set(groupStart, index - groupStart);\n        }\n        currentGroup = row.assetGroup;\n        groupStart = index;\n      }\n    });\n    \n    if (rows.length > currencyStart) {\n      currencySpans.set(currencyStart, rows.length - currencyStart);\n    }\n    if (rows.length > groupStart) {\n      groupSpans.set(groupStart, rows.length - groupStart);\n    }\n    \n    return { processedData: rows, currencySpans, groupSpans };\n  }, [data.data]);\n\n  const formatValue = (value: number | undefined, isShare: boolean) => {\n    if (value === undefined || value === null) return '-';\n    if (isShare) {\n      return `${(value * 100).toFixed(2)}%`;\n    }\n    return value.toFixed(2);\n  };\n\n  const columns = data.groups.length > 0 ? ['total', ...data.groups] : ['total'];\n  const hasGroups = data.groups.length > 0;\n\n  return (\n    <div className=\"overflow-x-auto max-h-[calc(100vh-320px)]\">\n      <table className=\"financial-table\">\n        <thead>\n          <tr>\n            <th className=\"min-w-[100px]\">本外币</th>\n            <th className=\"min-w-[140px]\">大类资产</th>\n            <th className=\"min-w-[180px]\">细分资产类别</th>\n            {hasGroups ? (\n              columns.map((col) => (\n                <th key={col} className=\"min-w-[100px]\">\n                  {col === 'total' ? `${data.date}${valueType === 'amount' ? '(亿)' : '占比'}` : col}\n                </th>\n              ))\n            ) : (\n              <>\n                <th className=\"min-w-[100px]\">{data.date}(亿)</th>\n                <th className=\"min-w-[80px]\">占比</th>\n              </>\n            )}\n          </tr>\n        </thead>\n        <tbody>\n          {processedData.map((row, index) => {\n            const showCurrency = currencySpans.has(index);\n            const currencyRowSpan = currencySpans.get(index) || 1;\n            const showGroup = groupSpans.has(index);\n            const groupRowSpan = groupSpans.get(index) || 1;\n            \n            const isTotal = row.category === '总资产' || row.category === '净资产';\n            const rowClass = isTotal \n              ? 'total-row' \n              : row.isSubtotal \n                ? 'subtotal-row' \n                : '';\n\n            return (\n              <tr key={`${row.currency}-${row.assetGroup}-${row.category}`} className={rowClass}>\n                {showCurrency && (\n                  <td \n                    className=\"currency-cell\" \n                    rowSpan={currencyRowSpan}\n                  >\n                    {row.currency}\n                  </td>\n                )}\n                {showGroup && (\n                  <td \n                    rowSpan={groupRowSpan}\n                    className=\"text-left font-medium\"\n                  >\n                    {row.assetGroup}\n                  </td>\n                )}\n                <td className={`text-left ${row.isSubtotal || isTotal ? 'font-semibold' : ''}`}>\n                  {row.category}\n                </td>\n                {hasGroups ? (\n                  columns.map((col) => {\n                    const val = valueType === 'share' \n                      ? row.shares[col] \n                      : row.values[col];\n                    return (\n                      <td key={col} className=\"value-cell\">\n                        {formatValue(val, valueType === 'share')}\n                      </td>\n                    );\n                  })\n                ) : (\n                  <>\n                    <td className=\"value-cell\">\n                      {formatValue(row.values.total, false)}\n                    </td>\n                    <td className=\"value-cell\">\n                      {formatValue(row.shares.total, true)}\n                    </td>\n                  </>\n                )}\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n"}}
{"type":"tool_result","timestamp":"2026-01-25T10:16:35.047Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components/HoldingsTable.tsx","content":"import { useMemo } from 'react';\nimport { type HoldingsData } from '../lib/api';\n\ninterface HoldingsTableProps {\n  data: HoldingsData;\n  valueType: 'amount' | 'share';\n}\n\nexport function HoldingsTable({ data, valueType }: HoldingsTableProps) {\n  const { processedData, currencySpans, groupSpans } = useMemo(() => {\n    const rows = data.data;\n    const currencySpans: Map<number, number> = new Map();\n    const groupSpans: Map<number, number> = new Map();\n    \n    let currentCurrency = '';\n    let currencyStart = 0;\n    let currentGroup = '';\n    let groupStart = 0;\n    \n    rows.forEach((row, index) => {\n      if (row.currency !== currentCurrency) {\n        if (currentCurrency && index > currencyStart) {\n          currencySpans.set(currencyStart, index - currencyStart);\n        }\n        currentCurrency = row.currency;\n        currencyStart = index;\n      }\n      \n      if (row.assetGroup !== currentGroup || row.currency !== currentCurrency) {\n        if (currentGroup && index > groupStart) {\n          groupSpans.set(groupStart, index - groupStart);\n        }\n        currentGroup = row.assetGroup;\n        groupStart = index;\n      }\n    });\n    \n    if (rows.length > currencyStart) {\n      currencySpans.set(currencyStart, rows.length - currencyStart);\n    }\n    if (rows.length > groupStart) {\n      groupSpans.set(groupStart, rows.length - groupStart);\n    }\n    \n    return { processedData: rows, currencySpans, groupSpans };\n  }, [data.data]);\n\n  const formatValue = (value: number | undefined, isShare: boolean) => {\n    if (value === undefined || value === null) return '-';\n    if (isShare) {\n      return `${(value * 100).toFixed(2)}%`;\n    }\n    return value.toFixed(2);\n  };\n\n  const columns = data.groups.length > 0 ? ['total', ...data.groups] : ['total'];\n  const hasGroups = data.groups.length > 0;\n\n  return (\n    <div className=\"overflow-x-auto max-h-[calc(100vh-320px)]\">\n      <table className=\"financial-table\">\n        <thead>\n          <tr>\n            <th className=\"min-w-[100px]\">本外币</th>\n            <th className=\"min-w-[140px]\">大类资产</th>\n            <th className=\"min-w-[180px]\">细分资产类别</th>\n            {hasGroups ? (\n              columns.map((col) => (\n                <th key={col} className=\"min-w-[100px]\">\n                  {col === 'total' ? `${data.date}${valueType === 'amount' ? '(亿)' : '占比'}` : col}\n                </th>\n              ))\n            ) : (\n              <>\n                <th className=\"min-w-[100px]\">{data.date}(亿)</th>\n                <th className=\"min-w-[80px]\">占比</th>\n              </>\n            )}\n          </tr>\n        </thead>\n        <tbody>\n          {processedData.map((row, index) => {\n            const showCurrency = currencySpans.has(index);\n            const currencyRowSpan = currencySpans.get(index) || 1;\n            const showGroup = groupSpans.has(index);\n            const groupRowSpan = groupSpans.get(index) || 1;\n            \n            const isTotal = row.category === '总资产' || row.category === '净资产';\n            const rowClass = isTotal \n              ? 'total-row' \n              : row.isSubtotal \n                ? 'subtotal-row' \n                : '';\n\n            return (\n              <tr key={`${row.currency}-${row.assetGroup}-${row.category}`} className={rowClass}>\n                {showCurrency && (\n                  <td \n                    className=\"currency-cell\" \n                    rowSpan={currencyRowSpan}\n                  >\n                    {row.currency}\n                  </td>\n                )}\n                {showGroup && (\n                  <td \n                    rowSpan={groupRowSpan}\n                    className=\"text-left font-medium\"\n                  >\n                    {row.assetGroup}\n                  </td>\n                )}\n                <td className={`text-left ${row.isSubtotal || isTotal ? 'font-semibold' : ''}`}>\n                  {row.category}\n                </td>\n                {hasGroups ? (\n                  columns.map((col) => {\n                    const val = valueType === 'share' \n                      ? row.shares[col] \n                      : row.values[col];\n                    return (\n                      <td key={col} className=\"value-cell\">\n                        {formatValue(val, valueType === 'share')}\n                      </td>\n                    );\n                  })\n                ) : (\n                  <>\n                    <td className=\"value-cell\">\n                      {formatValue(row.values.total, false)}\n                    </td>\n                    <td className=\"value-cell\">\n                      {formatValue(row.shares.total, true)}\n                    </td>\n                  </>\n                )}\n              </tr>\n            );\n          })}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components/HoldingsTable.tsx","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:16:43.226Z","tool_name":"write","tool_input":{"content":"import { Filter } from 'lucide-react';\n\ninterface FilterBarProps {\n  columns: string[];\n  groupBy: string;\n  valueType: 'amount' | 'share';\n  shareDirection: 'row' | 'column';\n  onFilterChange: (groupBy: string, valueType: 'amount' | 'share', shareDirection: 'row' | 'column') => void;\n}\n\nexport function FilterBar({ columns, groupBy, valueType, shareDirection, onFilterChange }: FilterBarProps) {\n  const dimensionColumns = columns.filter(col => \n    ['产品经理', '产品代码', '产品简称', '多资产品类', '币种', '形态', '是否招商', '渠道明细'].includes(col)\n  );\n\n  return (\n    <div className=\"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div className=\"flex items-center gap-2 text-gray-600\">\n        <Filter className=\"w-4 h-4\" />\n        <span className=\"text-sm font-medium\">筛选器</span>\n      </div>\n      \n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-sm text-gray-500\">分组维度:</span>\n        <select\n          className=\"filter-select\"\n          value={groupBy}\n          onChange={(e) => onFilterChange(e.target.value, valueType, shareDirection)}\n        >\n          <option value=\"\">不分组</option>\n          {dimensionColumns.map((col) => (\n            <option key={col} value={col}>{col}</option>\n          ))}\n        </select>\n      </div>\n      \n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-sm text-gray-500\">显示:</span>\n        <div className=\"flex\">\n          <button\n            className={`toggle-btn ${valueType === 'amount' ? 'active' : ''}`}\n            onClick={() => onFilterChange(groupBy, 'amount', shareDirection)}\n          >\n            金额(亿)\n          </button>\n          <button\n            className={`toggle-btn ${valueType === 'share' ? 'active' : ''}`}\n            onClick={() => onFilterChange(groupBy, 'share', shareDirection)}\n          >\n            占比(%)\n          </button>\n        </div>\n      </div>\n      \n      {valueType === 'share' && (\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-sm text-gray-500\">占比方向:</span>\n          <div className=\"flex\">\n            <button\n              className={`toggle-btn ${shareDirection === 'row' ? 'active' : ''}`}\n              onClick={() => onFilterChange(groupBy, valueType, 'row')}\n            >\n              按行\n            </button>\n            <button\n              className={`toggle-btn ${shareDirection === 'column' ? 'active' : ''}`}\n              onClick={() => onFilterChange(groupBy, valueType, 'column')}\n            >\n              按列\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components/FilterBar.tsx"}}
{"type":"tool_result","timestamp":"2026-01-25T10:16:43.243Z","tool_name":"write","tool_input":{"content":"import { Filter } from 'lucide-react';\n\ninterface FilterBarProps {\n  columns: string[];\n  groupBy: string;\n  valueType: 'amount' | 'share';\n  shareDirection: 'row' | 'column';\n  onFilterChange: (groupBy: string, valueType: 'amount' | 'share', shareDirection: 'row' | 'column') => void;\n}\n\nexport function FilterBar({ columns, groupBy, valueType, shareDirection, onFilterChange }: FilterBarProps) {\n  const dimensionColumns = columns.filter(col => \n    ['产品经理', '产品代码', '产品简称', '多资产品类', '币种', '形态', '是否招商', '渠道明细'].includes(col)\n  );\n\n  return (\n    <div className=\"flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm border border-gray-200\">\n      <div className=\"flex items-center gap-2 text-gray-600\">\n        <Filter className=\"w-4 h-4\" />\n        <span className=\"text-sm font-medium\">筛选器</span>\n      </div>\n      \n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-sm text-gray-500\">分组维度:</span>\n        <select\n          className=\"filter-select\"\n          value={groupBy}\n          onChange={(e) => onFilterChange(e.target.value, valueType, shareDirection)}\n        >\n          <option value=\"\">不分组</option>\n          {dimensionColumns.map((col) => (\n            <option key={col} value={col}>{col}</option>\n          ))}\n        </select>\n      </div>\n      \n      <div className=\"flex items-center gap-2\">\n        <span className=\"text-sm text-gray-500\">显示:</span>\n        <div className=\"flex\">\n          <button\n            className={`toggle-btn ${valueType === 'amount' ? 'active' : ''}`}\n            onClick={() => onFilterChange(groupBy, 'amount', shareDirection)}\n          >\n            金额(亿)\n          </button>\n          <button\n            className={`toggle-btn ${valueType === 'share' ? 'active' : ''}`}\n            onClick={() => onFilterChange(groupBy, 'share', shareDirection)}\n          >\n            占比(%)\n          </button>\n        </div>\n      </div>\n      \n      {valueType === 'share' && (\n        <div className=\"flex items-center gap-2\">\n          <span className=\"text-sm text-gray-500\">占比方向:</span>\n          <div className=\"flex\">\n            <button\n              className={`toggle-btn ${shareDirection === 'row' ? 'active' : ''}`}\n              onClick={() => onFilterChange(groupBy, valueType, 'row')}\n            >\n              按行\n            </button>\n            <button\n              className={`toggle-btn ${shareDirection === 'column' ? 'active' : ''}`}\n              onClick={() => onFilterChange(groupBy, valueType, 'column')}\n            >\n              按列\n            </button>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components/FilterBar.tsx"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/components/FilterBar.tsx","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:17:04.250Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/ClassificationPage.tsx","content":"import { useState, useEffect, useCallback } from 'react';\nimport { Plus, Trash2, Save, AlertCircle } from 'lucide-react';\nimport { getClassifications, updateClassifications, type ClassificationSheet } from '../lib/api';\n\nconst SHEET_NAMES = ['资产分类', '委外投资标签', '公募基金标签', '资产代码'];\n\nexport function ClassificationPage() {\n  const [activeTab, setActiveTab] = useState(SHEET_NAMES[0]);\n  const [sheets, setSheets] = useState<Record<string, ClassificationSheet>>({});\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [editingCell, setEditingCell] = useState<{ row: number; col: string } | null>(null);\n  const [hasChanges, setHasChanges] = useState(false);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      setLoading(true);\n      const data = await getClassifications();\n      setSheets(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load data');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCellChange = useCallback((rowIndex: number, column: string, value: string) => {\n    setSheets(prev => {\n      const sheet = prev[activeTab];\n      if (!sheet) return prev;\n      \n      const newData = [...sheet.data];\n      newData[rowIndex] = { ...newData[rowIndex], [column]: value };\n      \n      return {\n        ...prev,\n        [activeTab]: { ...sheet, data: newData }\n      };\n    });\n    setHasChanges(true);\n  }, [activeTab]);\n\n  const handleAddRow = useCallback(() => {\n    setSheets(prev => {\n      const sheet = prev[activeTab];\n      if (!sheet) return prev;\n      \n      const newRow: Record<string, unknown> = {};\n      sheet.columns.forEach(col => { newRow[col] = ''; });\n      \n      return {\n        ...prev,\n        [activeTab]: { ...sheet, data: [...sheet.data, newRow] }\n      };\n    });\n    setHasChanges(true);\n  }, [activeTab]);\n\n  const handleDeleteRow = useCallback((rowIndex: number) => {\n    if (!confirm('确定要删除这行吗?')) return;\n    \n    setSheets(prev => {\n      const sheet = prev[activeTab];\n      if (!sheet) return prev;\n      \n      const newData = sheet.data.filter((_, i) => i !== rowIndex);\n      return {\n        ...prev,\n        [activeTab]: { ...sheet, data: newData }\n      };\n    });\n    setHasChanges(true);\n  }, [activeTab]);\n\n  const handleSave = async () => {\n    const sheet = sheets[activeTab];\n    if (!sheet) return;\n    \n    try {\n      setSaving(true);\n      setError(null);\n      await updateClassifications(activeTab, sheet.data);\n      setHasChanges(false);\n      alert('保存成功!');\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to save');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const currentSheet = sheets[activeTab];\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-800\">资产分类管理</h1>\n        \n        <div className=\"flex items-center gap-3\">\n          <button\n            onClick={handleAddRow}\n            className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\n          >\n            <Plus className=\"w-4 h-4\" />\n            新增行\n          </button>\n          \n          <button\n            onClick={handleSave}\n            disabled={!hasChanges || saving}\n            className=\"flex items-center gap-2 px-4 py-2 bg-navy-800 text-white rounded-lg hover:bg-navy-700 disabled:opacity-50\"\n          >\n            {saving ? (\n              <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n            ) : (\n              <Save className=\"w-4 h-4\" />\n            )}\n            保存更改\n          </button>\n        </div>\n      </div>\n      \n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 text-red-700\">\n          <AlertCircle className=\"w-5 h-5\" />\n          {error}\n        </div>\n      )}\n      \n      <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n        <div className=\"flex border-b\">\n          {SHEET_NAMES.map((name) => (\n            <button\n              key={name}\n              onClick={() => setActiveTab(name)}\n              className={`px-6 py-3 text-sm font-medium transition-colors ${\n                activeTab === name\n                  ? 'bg-navy-800 text-white'\n                  : 'text-gray-600 hover:bg-gray-100'\n              }`}\n            >\n              {name}\n            </button>\n          ))}\n        </div>\n        \n        {loading ? (\n          <div className=\"p-12 text-center text-gray-500\">\n            <div className=\"w-8 h-8 border-2 border-navy-800 border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\n            加载中...\n          </div>\n        ) : currentSheet ? (\n          <div className=\"overflow-x-auto max-h-[calc(100vh-280px)]\">\n            <table className=\"financial-table\">\n              <thead>\n                <tr>\n                  <th className=\"w-12\">#</th>\n                  {currentSheet.columns.map((col) => (\n                    <th key={col} className=\"min-w-[120px]\">{col}</th>\n                  ))}\n                  <th className=\"w-16\">操作</th>\n                </tr>\n              </thead>\n              <tbody>\n                {currentSheet.data.map((row, rowIndex) => (\n                  <tr key={rowIndex}>\n                    <td className=\"text-center text-gray-500 text-sm\">{rowIndex + 1}</td>\n                    {currentSheet.columns.map((col) => (\n                      <td\n                        key={col}\n                        className=\"editable-cell\"\n                        onClick={() => setEditingCell({ row: rowIndex, col })}\n                      >\n                        {editingCell?.row === rowIndex && editingCell?.col === col ? (\n                          <input\n                            type=\"text\"\n                            autoFocus\n                            value={String(row[col] ?? '')}\n                            onChange={(e) => handleCellChange(rowIndex, col, e.target.value)}\n                            onBlur={() => setEditingCell(null)}\n                            onKeyDown={(e) => {\n                              if (e.key === 'Enter') setEditingCell(null);\n                            }}\n                          />\n                        ) : (\n                          <span className=\"block truncate max-w-[200px]\">\n                            {String(row[col] ?? '')}\n                          </span>\n                        )}\n                      </td>\n                    ))}\n                    <td className=\"text-center\">\n                      <button\n                        onClick={() => handleDeleteRow(rowIndex)}\n                        className=\"p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        ) : (\n          <div className=\"p-12 text-center text-gray-500\">无数据</div>\n        )}\n      </div>\n    </div>\n  );\n}\n"}}
{"type":"tool_result","timestamp":"2026-01-25T10:17:04.281Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/ClassificationPage.tsx","content":"import { useState, useEffect, useCallback } from 'react';\nimport { Plus, Trash2, Save, AlertCircle } from 'lucide-react';\nimport { getClassifications, updateClassifications, type ClassificationSheet } from '../lib/api';\n\nconst SHEET_NAMES = ['资产分类', '委外投资标签', '公募基金标签', '资产代码'];\n\nexport function ClassificationPage() {\n  const [activeTab, setActiveTab] = useState(SHEET_NAMES[0]);\n  const [sheets, setSheets] = useState<Record<string, ClassificationSheet>>({});\n  const [loading, setLoading] = useState(true);\n  const [saving, setSaving] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [editingCell, setEditingCell] = useState<{ row: number; col: string } | null>(null);\n  const [hasChanges, setHasChanges] = useState(false);\n\n  useEffect(() => {\n    loadData();\n  }, []);\n\n  const loadData = async () => {\n    try {\n      setLoading(true);\n      const data = await getClassifications();\n      setSheets(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load data');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleCellChange = useCallback((rowIndex: number, column: string, value: string) => {\n    setSheets(prev => {\n      const sheet = prev[activeTab];\n      if (!sheet) return prev;\n      \n      const newData = [...sheet.data];\n      newData[rowIndex] = { ...newData[rowIndex], [column]: value };\n      \n      return {\n        ...prev,\n        [activeTab]: { ...sheet, data: newData }\n      };\n    });\n    setHasChanges(true);\n  }, [activeTab]);\n\n  const handleAddRow = useCallback(() => {\n    setSheets(prev => {\n      const sheet = prev[activeTab];\n      if (!sheet) return prev;\n      \n      const newRow: Record<string, unknown> = {};\n      sheet.columns.forEach(col => { newRow[col] = ''; });\n      \n      return {\n        ...prev,\n        [activeTab]: { ...sheet, data: [...sheet.data, newRow] }\n      };\n    });\n    setHasChanges(true);\n  }, [activeTab]);\n\n  const handleDeleteRow = useCallback((rowIndex: number) => {\n    if (!confirm('确定要删除这行吗?')) return;\n    \n    setSheets(prev => {\n      const sheet = prev[activeTab];\n      if (!sheet) return prev;\n      \n      const newData = sheet.data.filter((_, i) => i !== rowIndex);\n      return {\n        ...prev,\n        [activeTab]: { ...sheet, data: newData }\n      };\n    });\n    setHasChanges(true);\n  }, [activeTab]);\n\n  const handleSave = async () => {\n    const sheet = sheets[activeTab];\n    if (!sheet) return;\n    \n    try {\n      setSaving(true);\n      setError(null);\n      await updateClassifications(activeTab, sheet.data);\n      setHasChanges(false);\n      alert('保存成功!');\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to save');\n    } finally {\n      setSaving(false);\n    }\n  };\n\n  const currentSheet = sheets[activeTab];\n\n  return (\n    <div className=\"p-6\">\n      <div className=\"flex items-center justify-between mb-6\">\n        <h1 className=\"text-2xl font-bold text-gray-800\">资产分类管理</h1>\n        \n        <div className=\"flex items-center gap-3\">\n          <button\n            onClick={handleAddRow}\n            className=\"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\n          >\n            <Plus className=\"w-4 h-4\" />\n            新增行\n          </button>\n          \n          <button\n            onClick={handleSave}\n            disabled={!hasChanges || saving}\n            className=\"flex items-center gap-2 px-4 py-2 bg-navy-800 text-white rounded-lg hover:bg-navy-700 disabled:opacity-50\"\n          >\n            {saving ? (\n              <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n            ) : (\n              <Save className=\"w-4 h-4\" />\n            )}\n            保存更改\n          </button>\n        </div>\n      </div>\n      \n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 text-red-700\">\n          <AlertCircle className=\"w-5 h-5\" />\n          {error}\n        </div>\n      )}\n      \n      <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n        <div className=\"flex border-b\">\n          {SHEET_NAMES.map((name) => (\n            <button\n              key={name}\n              onClick={() => setActiveTab(name)}\n              className={`px-6 py-3 text-sm font-medium transition-colors ${\n                activeTab === name\n                  ? 'bg-navy-800 text-white'\n                  : 'text-gray-600 hover:bg-gray-100'\n              }`}\n            >\n              {name}\n            </button>\n          ))}\n        </div>\n        \n        {loading ? (\n          <div className=\"p-12 text-center text-gray-500\">\n            <div className=\"w-8 h-8 border-2 border-navy-800 border-t-transparent rounded-full animate-spin mx-auto mb-4\" />\n            加载中...\n          </div>\n        ) : currentSheet ? (\n          <div className=\"overflow-x-auto max-h-[calc(100vh-280px)]\">\n            <table className=\"financial-table\">\n              <thead>\n                <tr>\n                  <th className=\"w-12\">#</th>\n                  {currentSheet.columns.map((col) => (\n                    <th key={col} className=\"min-w-[120px]\">{col}</th>\n                  ))}\n                  <th className=\"w-16\">操作</th>\n                </tr>\n              </thead>\n              <tbody>\n                {currentSheet.data.map((row, rowIndex) => (\n                  <tr key={rowIndex}>\n                    <td className=\"text-center text-gray-500 text-sm\">{rowIndex + 1}</td>\n                    {currentSheet.columns.map((col) => (\n                      <td\n                        key={col}\n                        className=\"editable-cell\"\n                        onClick={() => setEditingCell({ row: rowIndex, col })}\n                      >\n                        {editingCell?.row === rowIndex && editingCell?.col === col ? (\n                          <input\n                            type=\"text\"\n                            autoFocus\n                            value={String(row[col] ?? '')}\n                            onChange={(e) => handleCellChange(rowIndex, col, e.target.value)}\n                            onBlur={() => setEditingCell(null)}\n                            onKeyDown={(e) => {\n                              if (e.key === 'Enter') setEditingCell(null);\n                            }}\n                          />\n                        ) : (\n                          <span className=\"block truncate max-w-[200px]\">\n                            {String(row[col] ?? '')}\n                          </span>\n                        )}\n                      </td>\n                    ))}\n                    <td className=\"text-center\">\n                      <button\n                        onClick={() => handleDeleteRow(rowIndex)}\n                        className=\"p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded\"\n                      >\n                        <Trash2 className=\"w-4 h-4\" />\n                      </button>\n                    </td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        ) : (\n          <div className=\"p-12 text-center text-gray-500\">无数据</div>\n        )}\n      </div>\n    </div>\n  );\n}\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/ClassificationPage.tsx","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:17:36.738Z","tool_name":"write","tool_input":{"content":"import { useState, useCallback } from 'react';\nimport { Search, AlertCircle } from 'lucide-react';\nimport { searchAsset, type SearchResponse } from '../lib/api';\n\nexport function SearchPage() {\n  const [keyword, setKeyword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [result, setResult] = useState<SearchResponse | null>(null);\n\n  const handleSearch = useCallback(async () => {\n    if (!keyword.trim()) return;\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      const data = await searchAsset(keyword.trim());\n      setResult(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Search failed');\n    } finally {\n      setLoading(false);\n    }\n  }, [keyword]);\n\n  const formatPercent = (value: number) => `${(value * 100).toFixed(2)}%`;\n  const formatAmount = (value: number) => value.toFixed(4);\n\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold text-gray-800 mb-6\">资产穿透查询</h1>\n      \n      <div className=\"relative mb-6\">\n        <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n        <input\n          type=\"text\"\n          className=\"search-input\"\n          placeholder=\"输入资产代码或名称...\"\n          value={keyword}\n          onChange={(e) => setKeyword(e.target.value)}\n          onKeyDown={(e) => e.key === 'Enter' && handleSearch()}\n        />\n        <button\n          onClick={handleSearch}\n          disabled={loading || !keyword.trim()}\n          className=\"absolute right-2 top-1/2 -translate-y-1/2 px-4 py-2 bg-navy-800 text-white rounded-lg text-sm font-medium hover:bg-navy-700 disabled:opacity-50\"\n        >\n          {loading ? '搜索中...' : '搜索'}\n        </button>\n      </div>\n      \n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 text-red-700\">\n          <AlertCircle className=\"w-5 h-5\" />\n          {error}\n        </div>\n      )}\n      \n      {result && result.summary && (\n        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <p className=\"text-blue-800\">\n            <strong>搜索关键词:</strong> {result.keyword} | \n            <strong> 匹配资产:</strong> {result.summary.matchedAssets} 条 | \n            <strong> 涉及产品:</strong> {result.summary.productCount} 个 | \n            <strong> 部门合计持仓:</strong> {result.summary.totalHolding.toFixed(4)} 亿\n          </p>\n        </div>\n      )}\n      \n      {result && result.results.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n          <div className=\"overflow-x-auto max-h-[calc(100vh-320px)]\">\n            <table className=\"financial-table\">\n              <thead>\n                <tr>\n                  <th>产品简称</th>\n                  <th>产品代码</th>\n                  <th>投资经理</th>\n                  <th>资产代码</th>\n                  <th>资产名称</th>\n                  <th>资产分类</th>\n                  <th>持仓金额(亿)</th>\n                  <th>占产品净资产</th>\n                  <th>占部门该资产</th>\n                </tr>\n              </thead>\n              <tbody>\n                {result.results.map((row, index) => (\n                  <tr key={index}>\n                    <td>{row.productName}</td>\n                    <td className=\"font-mono text-sm\">{row.productCode}</td>\n                    <td>{row.manager}</td>\n                    <td className=\"font-mono text-sm\">{row.assetCode}</td>\n                    <td className=\"max-w-[200px] truncate\" title={row.assetName}>\n                      {row.assetName}\n                    </td>\n                    <td>{row.category}</td>\n                    <td className=\"value-cell\">{formatAmount(row.amount)}</td>\n                    <td className=\"value-cell\">{formatPercent(row.productShare)}</td>\n                    <td className=\"value-cell\">{formatPercent(row.departmentShare)}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n      \n      {result && result.results.length === 0 && (\n        <div className=\"p-12 text-center text-gray-500 bg-white rounded-lg shadow\">\n          未找到匹配的资产\n        </div>\n      )}\n    </div>\n  );\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/SearchPage.tsx"}}
{"type":"tool_result","timestamp":"2026-01-25T10:17:36.764Z","tool_name":"write","tool_input":{"content":"import { useState, useCallback } from 'react';\nimport { Search, AlertCircle } from 'lucide-react';\nimport { searchAsset, type SearchResponse } from '../lib/api';\n\nexport function SearchPage() {\n  const [keyword, setKeyword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n  const [result, setResult] = useState<SearchResponse | null>(null);\n\n  const handleSearch = useCallback(async () => {\n    if (!keyword.trim()) return;\n    \n    setLoading(true);\n    setError(null);\n    \n    try {\n      const data = await searchAsset(keyword.trim());\n      setResult(data);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Search failed');\n    } finally {\n      setLoading(false);\n    }\n  }, [keyword]);\n\n  const formatPercent = (value: number) => `${(value * 100).toFixed(2)}%`;\n  const formatAmount = (value: number) => value.toFixed(4);\n\n  return (\n    <div className=\"p-6\">\n      <h1 className=\"text-2xl font-bold text-gray-800 mb-6\">资产穿透查询</h1>\n      \n      <div className=\"relative mb-6\">\n        <Search className=\"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400\" />\n        <input\n          type=\"text\"\n          className=\"search-input\"\n          placeholder=\"输入资产代码或名称...\"\n          value={keyword}\n          onChange={(e) => setKeyword(e.target.value)}\n          onKeyDown={(e) => e.key === 'Enter' && handleSearch()}\n        />\n        <button\n          onClick={handleSearch}\n          disabled={loading || !keyword.trim()}\n          className=\"absolute right-2 top-1/2 -translate-y-1/2 px-4 py-2 bg-navy-800 text-white rounded-lg text-sm font-medium hover:bg-navy-700 disabled:opacity-50\"\n        >\n          {loading ? '搜索中...' : '搜索'}\n        </button>\n      </div>\n      \n      {error && (\n        <div className=\"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center gap-3 text-red-700\">\n          <AlertCircle className=\"w-5 h-5\" />\n          {error}\n        </div>\n      )}\n      \n      {result && result.summary && (\n        <div className=\"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\n          <p className=\"text-blue-800\">\n            <strong>搜索关键词:</strong> {result.keyword} | \n            <strong> 匹配资产:</strong> {result.summary.matchedAssets} 条 | \n            <strong> 涉及产品:</strong> {result.summary.productCount} 个 | \n            <strong> 部门合计持仓:</strong> {result.summary.totalHolding.toFixed(4)} 亿\n          </p>\n        </div>\n      )}\n      \n      {result && result.results.length > 0 && (\n        <div className=\"bg-white rounded-lg shadow overflow-hidden\">\n          <div className=\"overflow-x-auto max-h-[calc(100vh-320px)]\">\n            <table className=\"financial-table\">\n              <thead>\n                <tr>\n                  <th>产品简称</th>\n                  <th>产品代码</th>\n                  <th>投资经理</th>\n                  <th>资产代码</th>\n                  <th>资产名称</th>\n                  <th>资产分类</th>\n                  <th>持仓金额(亿)</th>\n                  <th>占产品净资产</th>\n                  <th>占部门该资产</th>\n                </tr>\n              </thead>\n              <tbody>\n                {result.results.map((row, index) => (\n                  <tr key={index}>\n                    <td>{row.productName}</td>\n                    <td className=\"font-mono text-sm\">{row.productCode}</td>\n                    <td>{row.manager}</td>\n                    <td className=\"font-mono text-sm\">{row.assetCode}</td>\n                    <td className=\"max-w-[200px] truncate\" title={row.assetName}>\n                      {row.assetName}\n                    </td>\n                    <td>{row.category}</td>\n                    <td className=\"value-cell\">{formatAmount(row.amount)}</td>\n                    <td className=\"value-cell\">{formatPercent(row.productShare)}</td>\n                    <td className=\"value-cell\">{formatPercent(row.departmentShare)}</td>\n                  </tr>\n                ))}\n              </tbody>\n            </table>\n          </div>\n        </div>\n      )}\n      \n      {result && result.results.length === 0 && (\n        <div className=\"p-12 text-center text-gray-500 bg-white rounded-lg shadow\">\n          未找到匹配的资产\n        </div>\n      )}\n    </div>\n  );\n}\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/SearchPage.tsx"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/pages/SearchPage.tsx","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:17:45.143Z","tool_name":"write","tool_input":{"content":"import { useState } from 'react';\nimport { BarChart3, Settings, Search, TrendingUp } from 'lucide-react';\nimport { HoldingsPage } from './pages/HoldingsPage';\nimport { ClassificationPage } from './pages/ClassificationPage';\nimport { SearchPage } from './pages/SearchPage';\n\ntype Page = 'holdings' | 'classification' | 'search';\n\nfunction App() {\n  const [currentPage, setCurrentPage] = useState<Page>('holdings');\n\n  const navItems: { id: Page; label: string; icon: React.ReactNode }[] = [\n    { id: 'holdings', label: '持仓分析', icon: <BarChart3 className=\"w-5 h-5\" /> },\n    { id: 'classification', label: '资产分类管理', icon: <Settings className=\"w-5 h-5\" /> },\n    { id: 'search', label: '资产穿透查询', icon: <Search className=\"w-5 h-5\" /> },\n  ];\n\n  return (\n    <div className=\"flex min-h-screen bg-gray-100\">\n      <aside className=\"w-64 bg-white border-r border-gray-200 flex flex-col\">\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 bg-navy-800 rounded-lg flex items-center justify-center\">\n              <TrendingUp className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"font-bold text-gray-800\">持仓分析系统</h1>\n              <p className=\"text-xs text-gray-500\">多资产投资部</p>\n            </div>\n          </div>\n        </div>\n        \n        <nav className=\"flex-1 p-4\">\n          <div className=\"space-y-2\">\n            {navItems.map((item) => (\n              <button\n                key={item.id}\n                onClick={() => setCurrentPage(item.id)}\n                className={`sidebar-link w-full ${currentPage === item.id ? 'active' : ''}`}\n              >\n                {item.icon}\n                {item.label}\n              </button>\n            ))}\n          </div>\n        </nav>\n        \n        <div className=\"p-4 border-t border-gray-200\">\n          <p className=\"text-xs text-gray-400 text-center\">\n            v1.0.0 | 2026\n          </p>\n        </div>\n      </aside>\n      \n      <main className=\"flex-1 overflow-auto\">\n        {currentPage === 'holdings' && <HoldingsPage />}\n        {currentPage === 'classification' && <ClassificationPage />}\n        {currentPage === 'search' && <SearchPage />}\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/App.tsx"}}
{"type":"tool_use","timestamp":"2026-01-25T10:17:55.020Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/App.tsx"}}
{"type":"tool_result","timestamp":"2026-01-25T10:17:55.029Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/App.tsx"},"tool_output":{"preview":"import { useState } from 'react'\nimport reactLogo from './assets/react.svg'\nimport viteLogo from '/vite.svg'\nimport './App.css'\n\nfunction App() {\n  const [count, setCount] = useState(0)\n\n  return (\n    <>\n      <div>\n        <a href=\"https://vite.dev\" target=\"_blank\">\n          <img src={viteLogo} className=\"logo\" alt=\"Vite logo\" />\n        </a>\n        <a href=\"https://react.dev\" target=\"_blank\">\n          <img src={reactLogo} className=\"logo react\" alt=\"React logo\" />\n        </a>\n      </div>\n      <h1>Vite + React</h1>\n      <div className=\"card\">","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:18:12.491Z","tool_name":"write","tool_input":{"content":"import { useState } from 'react';\nimport { BarChart3, Settings, Search, TrendingUp } from 'lucide-react';\nimport { HoldingsPage } from './pages/HoldingsPage';\nimport { ClassificationPage } from './pages/ClassificationPage';\nimport { SearchPage } from './pages/SearchPage';\n\ntype Page = 'holdings' | 'classification' | 'search';\n\nfunction App() {\n  const [currentPage, setCurrentPage] = useState<Page>('holdings');\n\n  const navItems: { id: Page; label: string; icon: React.ReactNode }[] = [\n    { id: 'holdings', label: '持仓分析', icon: <BarChart3 className=\"w-5 h-5\" /> },\n    { id: 'classification', label: '资产分类管理', icon: <Settings className=\"w-5 h-5\" /> },\n    { id: 'search', label: '资产穿透查询', icon: <Search className=\"w-5 h-5\" /> },\n  ];\n\n  return (\n    <div className=\"flex min-h-screen bg-gray-100\">\n      <aside className=\"w-64 bg-white border-r border-gray-200 flex flex-col\">\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 bg-navy-800 rounded-lg flex items-center justify-center\">\n              <TrendingUp className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"font-bold text-gray-800\">持仓分析系统</h1>\n              <p className=\"text-xs text-gray-500\">多资产投资部</p>\n            </div>\n          </div>\n        </div>\n        \n        <nav className=\"flex-1 p-4\">\n          <div className=\"space-y-2\">\n            {navItems.map((item) => (\n              <button\n                key={item.id}\n                onClick={() => setCurrentPage(item.id)}\n                className={`sidebar-link w-full ${currentPage === item.id ? 'active' : ''}`}\n              >\n                {item.icon}\n                {item.label}\n              </button>\n            ))}\n          </div>\n        </nav>\n        \n        <div className=\"p-4 border-t border-gray-200\">\n          <p className=\"text-xs text-gray-400 text-center\">\n            v1.0.0 | 2026\n          </p>\n        </div>\n      </aside>\n      \n      <main className=\"flex-1 overflow-auto\">\n        {currentPage === 'holdings' && <HoldingsPage />}\n        {currentPage === 'classification' && <ClassificationPage />}\n        {currentPage === 'search' && <SearchPage />}\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/App.tsx"}}
{"type":"tool_result","timestamp":"2026-01-25T10:18:12.536Z","tool_name":"write","tool_input":{"content":"import { useState } from 'react';\nimport { BarChart3, Settings, Search, TrendingUp } from 'lucide-react';\nimport { HoldingsPage } from './pages/HoldingsPage';\nimport { ClassificationPage } from './pages/ClassificationPage';\nimport { SearchPage } from './pages/SearchPage';\n\ntype Page = 'holdings' | 'classification' | 'search';\n\nfunction App() {\n  const [currentPage, setCurrentPage] = useState<Page>('holdings');\n\n  const navItems: { id: Page; label: string; icon: React.ReactNode }[] = [\n    { id: 'holdings', label: '持仓分析', icon: <BarChart3 className=\"w-5 h-5\" /> },\n    { id: 'classification', label: '资产分类管理', icon: <Settings className=\"w-5 h-5\" /> },\n    { id: 'search', label: '资产穿透查询', icon: <Search className=\"w-5 h-5\" /> },\n  ];\n\n  return (\n    <div className=\"flex min-h-screen bg-gray-100\">\n      <aside className=\"w-64 bg-white border-r border-gray-200 flex flex-col\">\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex items-center gap-3\">\n            <div className=\"w-10 h-10 bg-navy-800 rounded-lg flex items-center justify-center\">\n              <TrendingUp className=\"w-6 h-6 text-white\" />\n            </div>\n            <div>\n              <h1 className=\"font-bold text-gray-800\">持仓分析系统</h1>\n              <p className=\"text-xs text-gray-500\">多资产投资部</p>\n            </div>\n          </div>\n        </div>\n        \n        <nav className=\"flex-1 p-4\">\n          <div className=\"space-y-2\">\n            {navItems.map((item) => (\n              <button\n                key={item.id}\n                onClick={() => setCurrentPage(item.id)}\n                className={`sidebar-link w-full ${currentPage === item.id ? 'active' : ''}`}\n              >\n                {item.icon}\n                {item.label}\n              </button>\n            ))}\n          </div>\n        </nav>\n        \n        <div className=\"p-4 border-t border-gray-200\">\n          <p className=\"text-xs text-gray-400 text-center\">\n            v1.0.0 | 2026\n          </p>\n        </div>\n      </aside>\n      \n      <main className=\"flex-1 overflow-auto\">\n        {currentPage === 'holdings' && <HoldingsPage />}\n        {currentPage === 'classification' && <ClassificationPage />}\n        {currentPage === 'search' && <SearchPage />}\n      </main>\n    </div>\n  );\n}\n\nexport default App;\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/App.tsx"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/App.tsx","exists":true,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:18:30.617Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"分析需求并设计系统架构 - 已完成数据结构分析","id":"1","priority":"high","status":"completed"},{"id":"2","priority":"high","status":"completed","content":"创建后端 FastAPI 服务器和API"},{"content":"创建前端 React + Vite 项目结构","id":"3","priority":"high","status":"completed"},{"status":"completed","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4","priority":"high"},{"content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high","status":"completed"},{"status":"completed","content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium"},{"priority":"medium","status":"in_progress","content":"创建启动脚本和说明文档","id":"7"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:18:30.634Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"分析需求并设计系统架构 - 已完成数据结构分析","id":"1","priority":"high","status":"completed"},{"id":"2","priority":"high","status":"completed","content":"创建后端 FastAPI 服务器和API"},{"content":"创建前端 React + Vite 项目结构","id":"3","priority":"high","status":"completed"},{"status":"completed","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4","priority":"high"},{"content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high","status":"completed"},{"status":"completed","content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium"},{"priority":"medium","status":"in_progress","content":"创建启动脚本和说明文档","id":"7"}]},"tool_output":{"todos":[{"content":"分析需求并设计系统架构 - 已完成数据结构分析","id":"1","priority":"high","status":"completed"},{"id":"2","priority":"high","status":"completed","content":"创建后端 FastAPI 服务器和API"},{"content":"创建前端 React + Vite 项目结构","id":"3","priority":"high","status":"completed"},{"status":"completed","content":"实现资产分类管理页面 - CRUD操作资产标签分类","id":"4","priority":"high"},{"content":"实现主持仓分析页面 - 动态表格+筛选器+多维度切换","id":"5","priority":"high","status":"completed"},{"status":"completed","content":"实现资产搜索功能 - 按资产查询各产品持仓详情","id":"6","priority":"medium"},{"priority":"medium","status":"in_progress","content":"创建启动脚本和说明文档","id":"7"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:22:20.326Z","tool_name":"glob","tool_input":{"path":"/Users/fanshengxia/Desktop/部门持仓分析系统","pattern":"**/*"}}
{"type":"tool_result","timestamp":"2026-01-25T10:22:21.827Z","tool_name":"glob","tool_input":{"path":"/Users/fanshengxia/Desktop/部门持仓分析系统","pattern":"**/*"},"tool_output":{"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:22:30.645Z","tool_name":"todowrite","tool_input":{"todos":[{"priority":"high","id":"1","content":"Test backend API startup (install deps + run)","status":"pending"},{"id":"2","content":"Test frontend dev server startup","status":"pending","priority":"high"},{"content":"Fix any runtime errors found","status":"pending","priority":"high","id":"3"},{"id":"4","content":"Create startup script (start.sh)","status":"pending","priority":"medium"},{"priority":"medium","id":"5","content":"Create README.md with usage instructions","status":"pending"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:22:30.649Z","tool_name":"todowrite","tool_input":{"todos":[{"priority":"high","id":"1","content":"Test backend API startup (install deps + run)","status":"pending"},{"id":"2","content":"Test frontend dev server startup","status":"pending","priority":"high"},{"content":"Fix any runtime errors found","status":"pending","priority":"high","id":"3"},{"id":"4","content":"Create startup script (start.sh)","status":"pending","priority":"medium"},{"priority":"medium","id":"5","content":"Create README.md with usage instructions","status":"pending"}]},"tool_output":{"todos":[{"priority":"high","id":"1","content":"Test backend API startup (install deps + run)","status":"pending"},{"id":"2","content":"Test frontend dev server startup","status":"pending","priority":"high"},{"content":"Fix any runtime errors found","status":"pending","priority":"high","id":"3"},{"id":"4","content":"Create startup script (start.sh)","status":"pending","priority":"medium"},{"priority":"medium","id":"5","content":"Create README.md with usage instructions","status":"pending"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:22:37.751Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"in_progress"},{"priority":"high","status":"pending","content":"Test frontend dev server startup","id":"2"},{"content":"Fix any runtime errors found","id":"3","priority":"high","status":"pending"},{"content":"Create startup script (start.sh)","id":"4","priority":"medium","status":"pending"},{"priority":"medium","status":"pending","content":"Create README.md with usage instructions","id":"5"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:22:37.756Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"in_progress"},{"priority":"high","status":"pending","content":"Test frontend dev server startup","id":"2"},{"content":"Fix any runtime errors found","id":"3","priority":"high","status":"pending"},{"content":"Create startup script (start.sh)","id":"4","priority":"medium","status":"pending"},{"priority":"medium","status":"pending","content":"Create README.md with usage instructions","id":"5"}]},"tool_output":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"in_progress"},{"priority":"high","status":"pending","content":"Test frontend dev server startup","id":"2"},{"content":"Fix any runtime errors found","id":"3","priority":"high","status":"pending"},{"content":"Create startup script (start.sh)","id":"4","priority":"medium","status":"pending"},{"priority":"medium","status":"pending","content":"Create README.md with usage instructions","id":"5"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:22:38.453Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && pip install -r requirements.txt 2>&1 | tail -20","description":"Install backend Python dependencies"}}
{"type":"tool_result","timestamp":"2026-01-25T10:22:52.130Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && pip install -r requirements.txt 2>&1 | tail -20","description":"Install backend Python dependencies"},"tool_output":{"output":"open-interpreter 0.2.3 requires tiktoken<0.6.0,>=0.5.2, but you have tiktoken 0.7.0 which is incompatible.\nopen-interpreter 0.2.3 requires uvicorn<0.28.0,>=0.27.0, but you have uvicorn 0.35.0 which is incompatible.\npandasai 0.2.11 requires openai<0.28.0,>=0.27.5, but you have openai 1.93.0 which is incompatible.\nscipy 1.10.1 requires numpy<1.27.0,>=1.19.5, but you have numpy 2.0.2 which is incompatible.\nstreamlit 1.27.0 requires numpy<2,>=1.19.3, but you have numpy 2.0.2 which is incompatible.\ntransformers 4.27.1 requires tokenizers!=0.11.3,<0.14,>=0.11.1, but you have tokenizers 0.19.1 which is incompatible.\nunstructured 0.12.6 requires certifi==2024.2.2, but you have certifi 2025.6.15 which is incompatible.\nunstructured 0.12.6 requires charset-normalizer==3.3.2, but you have charset-normalizer 3.4.2 which is incompatible.\nunstructured 0.12.6 requires idna==3.6, but you have idna 3.10 which is incompatible.\nunstructured 0.12.6 requires numpy==1.26.4, but you have numpy 2.0.2 which is incompatible.\nunstructured 0.12.6 requires python-dateutil==2.8.2, but you have python-dateutil 2.9.0.post0 which is incompatible.\nunstructured 0.12.6 requires regex==2023.12.25, but you have regex 2024.5.15 which is incompatible.\nunstructured 0.12.6 requires requests==2.31.0, but you have requests 2.32.4 which is incompatible.\nunstructured 0.12.6 requires tqdm==4.66.2, but you have tqdm 4.66.4 which is incompatible.\nunstructured 0.12.6 requires typing-extensions==4.9.0, but you have typing-extensions 4.14.0 which is incompatible.\nunstructured 0.12.6 requires urllib3==1.26.18, but you have urllib3 2.5.0 which is incompatible.\nSuccessfully installed numpy-2.0.2 python-multipart-0.0.20\n\n[notice] A new release of pip is available: 25.1.1 -> 25.3\n[notice] To update, run: pip install --upgrade pip\n","exit":0,"description":"Install backend Python dependencies","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:22:59.443Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && timeout 5 python -c \"from main import app; print('Backend imports OK')\" 2>&1 || echo \"Import test completed\"","description":"Test backend Python imports"}}
{"type":"tool_result","timestamp":"2026-01-25T10:22:59.500Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && timeout 5 python -c \"from main import app; print('Backend imports OK')\" 2>&1 || echo \"Import test completed\"","description":"Test backend Python imports"},"tool_output":{"output":"zsh:1: command not found: timeout\nImport test completed\n","exit":0,"description":"Test backend Python imports","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:27:14.676Z","tool_name":"bash","tool_input":{"description":"Test backend Python imports","timeout":10000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && python -c \"from main import app; print('Backend imports OK')\" 2>&1"}}
{"type":"tool_result","timestamp":"2026-01-25T10:27:22.985Z","tool_name":"bash","tool_input":{"description":"Test backend Python imports","timeout":10000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && python -c \"from main import app; print('Backend imports OK')\" 2>&1"},"tool_output":{"output":"Traceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py\", line 6, in <module>\n    import pandas as pd\n  File \"/Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/__init__.py\", line 22, in <module>\n    from pandas.compat import is_numpy_dev as _is_numpy_dev  # pyright: ignore # noqa:F401\n  File \"/Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/compat/__init__.py\", line 25, in <module>\n    from pandas.compat.numpy import (\n  File \"/Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/compat/numpy/__init__.py\", line 4, in <module>\n    from pandas.util.version import Version\n  File \"/Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/util/__init__.py\", line 2, in <module>\n    from pandas.util._decorators import (  # noqa:F401\n  File \"/Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/util/_decorators.py\", line 14, in <module>\n    from pandas._libs.properties import cache_readonly\n  File \"/Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/_libs/__init__.py\", line 13, in <module>\n    from pandas._libs.interval import Interval\n  File \"pandas/_libs/interval.pyx\", line 1, in init pandas._libs.interval\nValueError: numpy.dtype size changed, may indicate binary incompatibility. Expected 96 from C header, got 88 from PyObject\n","exit":1,"description":"Test backend Python imports","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:27:30.468Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && python3 -m venv venv && source venv/bin/activate && pip install -r requirements.txt 2>&1 | tail -10","description":"Create venv and install dependencies","timeout":120000}}
{"type":"tool_result","timestamp":"2026-01-25T10:28:26.976Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && python3 -m venv venv && source venv/bin/activate && pip install -r requirements.txt 2>&1 | tail -10","description":"Create venv and install dependencies","timeout":120000},"tool_output":{"output":"     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 113.6/113.6 KB 1.6 MB/s eta 0:00:00\nCollecting exceptiongroup>=1.0.2\n  Downloading exceptiongroup-1.3.1-py3-none-any.whl (16 kB)\nCollecting idna>=2.8\n  Downloading idna-3.11-py3-none-any.whl (71 kB)\n     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 71.0/71.0 KB 2.9 MB/s eta 0:00:00\nInstalling collected packages: pytz, tzdata, typing-extensions, six, python-multipart, numpy, idna, h11, et-xmlfile, click, annotated-types, annotated-doc, uvicorn, typing-inspection, python-dateutil, pydantic-core, openpyxl, exceptiongroup, pydantic, pandas, anyio, starlette, fastapi\nSuccessfully installed annotated-doc-0.0.4 annotated-types-0.7.0 anyio-4.12.1 click-8.1.8 et-xmlfile-2.0.0 exceptiongroup-1.3.1 fastapi-0.128.0 h11-0.16.0 idna-3.11 numpy-2.0.2 openpyxl-3.1.5 pandas-2.3.3 pydantic-2.12.5 pydantic-core-2.41.5 python-dateutil-2.9.0.post0 python-multipart-0.0.20 pytz-2025.2 six-1.17.0 starlette-0.49.3 typing-extensions-4.15.0 typing-inspection-0.4.2 tzdata-2025.3 uvicorn-0.39.0\nWARNING: You are using pip version 22.0.4; however, version 25.3 is available.\nYou should consider upgrading via the '/Users/fanshengxia/Desktop/部门持仓分析系统/backend/venv/bin/python3 -m pip install --upgrade pip' command.\n","exit":0,"description":"Create venv and install dependencies","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:28:33.765Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"from main import app; print('Backend imports OK')\" 2>&1","description":"Test backend imports in venv","timeout":15000}}
{"type":"tool_result","timestamp":"2026-01-25T10:28:48.900Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"from main import app; print('Backend imports OK')\" 2>&1","description":"Test backend imports in venv","timeout":15000},"tool_output":{"output":"\n\n<bash_metadata>\nbash tool terminated command after exceeding timeout 15000 ms\n</bash_metadata>","exit":null,"description":"Test backend imports in venv","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:28:53.884Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py"}}
{"type":"tool_result","timestamp":"2026-01-25T10:28:53.895Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py"},"tool_output":{"preview":"from fastapi import FastAPI, UploadFile, File, HTTPException, Query\nfrom fastapi.middleware.cors import CORSMiddleware\nfrom fastapi.responses import JSONResponse\nfrom pydantic import BaseModel\nfrom typing import Dict, List, Optional, Any\nimport pandas as pd\nimport numpy as np\nimport tempfile\nimport os\nimport json\nfrom pathlib import Path\n\nfrom classification import (\n    ClassificationRules, \n    load_classification_rules, \n    enrich_holdings, \n    classify_assets,\n    normalize_text\n)\n","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:29:01.514Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"import pandas; print('pandas ok')\" 2>&1","description":"Test pandas import in venv","timeout":30000}}
{"type":"tool_result","timestamp":"2026-01-25T10:29:04.112Z","tool_name":"bash","tool_input":{"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"import pandas; print('pandas ok')\" 2>&1","description":"Test pandas import in venv","timeout":30000},"tool_output":{"output":"pandas ok\n","exit":0,"description":"Test pandas import in venv","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:32:18.580Z","tool_name":"bash","tool_input":{"timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"from classification import load_classification_rules; print('classification ok')\" 2>&1","description":"Test classification import"}}
{"type":"tool_result","timestamp":"2026-01-25T10:32:19.368Z","tool_name":"bash","tool_input":{"timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"from classification import load_classification_rules; print('classification ok')\" 2>&1","description":"Test classification import"},"tool_output":{"output":"classification ok\n","exit":0,"description":"Test classification import","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:32:25.248Z","tool_name":"bash","tool_input":{"description":"Test main.py imports","timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"from main import app; print('Backend imports OK')\" 2>&1"}}
{"type":"tool_result","timestamp":"2026-01-25T10:32:26.379Z","tool_name":"bash","tool_input":{"description":"Test main.py imports","timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && python -c \"from main import app; print('Backend imports OK')\" 2>&1"},"tool_output":{"output":"Backend imports OK\n","exit":0,"description":"Test main.py imports","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:32:31.950Z","tool_name":"bash","tool_input":{"timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && nohup python main.py > server.log 2>&1 &\nsleep 3 && curl -s http://localhost:8000/api/health | head -20","description":"Start backend server and test"}}
{"type":"tool_result","timestamp":"2026-01-25T10:32:36.748Z","tool_name":"bash","tool_input":{"timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/backend && source venv/bin/activate && nohup python main.py > server.log 2>&1 &\nsleep 3 && curl -s http://localhost:8000/api/health | head -20","description":"Start backend server and test"},"tool_output":{"output":"{\"status\":\"ok\",\"classification_file_exists\":true}","exit":0,"description":"Start backend server and test","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:32:43.545Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"Test backend API startup (install deps + run)"},{"content":"Test frontend dev server startup","id":"2","priority":"high","status":"in_progress"},{"status":"pending","content":"Fix any runtime errors found","id":"3","priority":"high"},{"id":"4","priority":"medium","status":"pending","content":"Create startup script (start.sh)"},{"status":"pending","content":"Create README.md with usage instructions","id":"5","priority":"medium"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:32:43.551Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"Test backend API startup (install deps + run)"},{"content":"Test frontend dev server startup","id":"2","priority":"high","status":"in_progress"},{"status":"pending","content":"Fix any runtime errors found","id":"3","priority":"high"},{"id":"4","priority":"medium","status":"pending","content":"Create startup script (start.sh)"},{"status":"pending","content":"Create README.md with usage instructions","id":"5","priority":"medium"}]},"tool_output":{"todos":[{"id":"1","priority":"high","status":"completed","content":"Test backend API startup (install deps + run)"},{"content":"Test frontend dev server startup","id":"2","priority":"high","status":"in_progress"},{"status":"pending","content":"Fix any runtime errors found","id":"3","priority":"high"},{"id":"4","priority":"medium","status":"pending","content":"Create startup script (start.sh)"},{"status":"pending","content":"Create README.md with usage instructions","id":"5","priority":"medium"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:32:44.647Z","tool_name":"bash","tool_input":{"command":"curl -s http://localhost:8000/api/classifications | jq 'keys' 2>/dev/null || curl -s http://localhost:8000/api/classifications | head -200","description":"Test classifications API"}}
{"type":"tool_result","timestamp":"2026-01-25T10:33:30.575Z","tool_name":"bash","tool_input":{"command":"curl -s http://localhost:8000/api/classifications | jq 'keys' 2>/dev/null || curl -s http://localhost:8000/api/classifications | head -200","description":"Test classifications API"},"tool_output":{"output":"[\n  \"公募基金标签\",\n  \"委外投资标签\",\n  \"资产代码\",\n  \"资产分类\"\n]\n","exit":0,"description":"Test classifications API","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:33:37.283Z","tool_name":"bash","tool_input":{"description":"Start frontend dev server","timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm run dev > /dev/null 2>&1 &\nsleep 5 && curl -s http://localhost:5173 | head -10"}}
{"type":"tool_result","timestamp":"2026-01-25T10:33:42.456Z","tool_name":"bash","tool_input":{"description":"Start frontend dev server","timeout":30000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm run dev > /dev/null 2>&1 &\nsleep 5 && curl -s http://localhost:5173 | head -10"},"tool_output":{"output":"<!doctype html>\n<html lang=\"en\">\n  <head>\n    <script type=\"module\">import { injectIntoGlobalHook } from \"/@react-refresh\";\ninjectIntoGlobalHook(window);\nwindow.$RefreshReg$ = () => {};\nwindow.$RefreshSig$ = () => (type) => type;</script>\n\n    <script type=\"module\" src=\"/@vite/client\"></script>\n\n","exit":0,"description":"Start frontend dev server","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:33:48.547Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"completed"},{"priority":"high","status":"completed","content":"Test frontend dev server startup","id":"2"},{"status":"completed","content":"Fix any runtime errors found","id":"3","priority":"high"},{"content":"Create startup script (start.sh)","id":"4","priority":"medium","status":"in_progress"},{"id":"5","priority":"medium","status":"pending","content":"Create README.md with usage instructions"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:33:48.556Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"completed"},{"priority":"high","status":"completed","content":"Test frontend dev server startup","id":"2"},{"status":"completed","content":"Fix any runtime errors found","id":"3","priority":"high"},{"content":"Create startup script (start.sh)","id":"4","priority":"medium","status":"in_progress"},{"id":"5","priority":"medium","status":"pending","content":"Create README.md with usage instructions"}]},"tool_output":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"completed"},{"priority":"high","status":"completed","content":"Test frontend dev server startup","id":"2"},{"status":"completed","content":"Fix any runtime errors found","id":"3","priority":"high"},{"content":"Create startup script (start.sh)","id":"4","priority":"medium","status":"in_progress"},{"id":"5","priority":"medium","status":"pending","content":"Create README.md with usage instructions"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:34:03.812Z","tool_name":"write","tool_input":{"content":"#!/bin/bash\n# 部门持仓分析系统 启动脚本\n\nset -e\n\nPROJECT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nBACKEND_DIR=\"$PROJECT_DIR/backend\"\nFRONTEND_DIR=\"$PROJECT_DIR/frontend\"\n\n# 颜色定义\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nNC='\\033[0m'\n\necho -e \"${GREEN}===== 部门持仓分析系统 =====${NC}\"\necho \"\"\n\n# 检查后端虚拟环境\nif [ ! -d \"$BACKEND_DIR/venv\" ]; then\n    echo -e \"${YELLOW}正在创建Python虚拟环境...${NC}\"\n    cd \"$BACKEND_DIR\"\n    python3 -m venv venv\n    source venv/bin/activate\n    pip install -r requirements.txt\n    echo -e \"${GREEN}虚拟环境创建完成${NC}\"\nelse\n    echo -e \"${GREEN}Python虚拟环境已存在${NC}\"\nfi\n\n# 检查前端依赖\nif [ ! -d \"$FRONTEND_DIR/node_modules\" ]; then\n    echo -e \"${YELLOW}正在安装前端依赖...${NC}\"\n    cd \"$FRONTEND_DIR\"\n    npm install\n    echo -e \"${GREEN}前端依赖安装完成${NC}\"\nelse\n    echo -e \"${GREEN}前端依赖已存在${NC}\"\nfi\n\n# 停止可能已运行的服务\necho -e \"${YELLOW}检查并停止已运行的服务...${NC}\"\nlsof -ti:8000 | xargs kill -9 2>/dev/null || true\nlsof -ti:5173 | xargs kill -9 2>/dev/null || true\n\n# 启动后端\necho -e \"${YELLOW}正在启动后端API服务 (端口 8000)...${NC}\"\ncd \"$BACKEND_DIR\"\nsource venv/bin/activate\nnohup python main.py > server.log 2>&1 &\nBACKEND_PID=$!\nsleep 2\n\n# 检查后端是否启动成功\nif curl -s http://localhost:8000/api/health > /dev/null 2>&1; then\n    echo -e \"${GREEN}后端API服务启动成功 (PID: $BACKEND_PID)${NC}\"\nelse\n    echo -e \"${RED}后端API服务启动失败，请检查 $BACKEND_DIR/server.log${NC}\"\n    exit 1\nfi\n\n# 启动前端\necho -e \"${YELLOW}正在启动前端开发服务器 (端口 5173)...${NC}\"\ncd \"$FRONTEND_DIR\"\nnohup npm run dev > dev.log 2>&1 &\nFRONTEND_PID=$!\nsleep 3\n\n# 检查前端是否启动成功\nif curl -s http://localhost:5173 > /dev/null 2>&1; then\n    echo -e \"${GREEN}前端开发服务器启动成功 (PID: $FRONTEND_PID)${NC}\"\nelse\n    echo -e \"${RED}前端开发服务器启动失败，请检查 $FRONTEND_DIR/dev.log${NC}\"\n    exit 1\nfi\n\necho \"\"\necho -e \"${GREEN}===== 启动完成 =====${NC}\"\necho \"\"\necho -e \"后端API: ${GREEN}http://localhost:8000${NC}\"\necho -e \"前端页面: ${GREEN}http://localhost:5173${NC}\"\necho \"\"\necho -e \"日志文件:\"\necho -e \"  后端: $BACKEND_DIR/server.log\"\necho -e \"  前端: $FRONTEND_DIR/dev.log\"\necho \"\"\necho -e \"${YELLOW}停止服务: ./stop.sh 或者 kill $BACKEND_PID $FRONTEND_PID${NC}\"\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/start.sh"}}
{"type":"tool_use","timestamp":"2026-01-25T10:34:06.321Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh","content":"#!/bin/bash\n# 停止部门持仓分析系统服务\n\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nNC='\\033[0m'\n\necho -e \"${GREEN}正在停止服务...${NC}\"\n\n# 停止后端 (端口 8000)\nif lsof -ti:8000 > /dev/null 2>&1; then\n    lsof -ti:8000 | xargs kill -9\n    echo -e \"${GREEN}后端服务已停止${NC}\"\nelse\n    echo -e \"后端服务未运行\"\nfi\n\n# 停止前端 (端口 5173)\nif lsof -ti:5173 > /dev/null 2>&1; then\n    lsof -ti:5173 | xargs kill -9\n    echo -e \"${GREEN}前端服务已停止${NC}\"\nelse\n    echo -e \"前端服务未运行\"\nfi\n\necho -e \"${GREEN}服务已全部停止${NC}\"\n"}}
{"type":"tool_result","timestamp":"2026-01-25T10:34:12.419Z","tool_name":"write","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh","content":"#!/bin/bash\n# 停止部门持仓分析系统服务\n\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nNC='\\033[0m'\n\necho -e \"${GREEN}正在停止服务...${NC}\"\n\n# 停止后端 (端口 8000)\nif lsof -ti:8000 > /dev/null 2>&1; then\n    lsof -ti:8000 | xargs kill -9\n    echo -e \"${GREEN}后端服务已停止${NC}\"\nelse\n    echo -e \"后端服务未运行\"\nfi\n\n# 停止前端 (端口 5173)\nif lsof -ti:5173 > /dev/null 2>&1; then\n    lsof -ti:5173 | xargs kill -9\n    echo -e \"${GREEN}前端服务已停止${NC}\"\nelse\n    echo -e \"前端服务未运行\"\nfi\n\necho -e \"${GREEN}服务已全部停止${NC}\"\n"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh":[]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh","exists":false,"truncated":false}}
{"type":"tool_result","timestamp":"2026-01-25T10:34:14.652Z","tool_name":"write","tool_input":{"content":"#!/bin/bash\n# 部门持仓分析系统 启动脚本\n\nset -e\n\nPROJECT_DIR=\"$(cd \"$(dirname \"${BASH_SOURCE[0]}\")\" && pwd)\"\nBACKEND_DIR=\"$PROJECT_DIR/backend\"\nFRONTEND_DIR=\"$PROJECT_DIR/frontend\"\n\n# 颜色定义\nRED='\\033[0;31m'\nGREEN='\\033[0;32m'\nYELLOW='\\033[1;33m'\nNC='\\033[0m'\n\necho -e \"${GREEN}===== 部门持仓分析系统 =====${NC}\"\necho \"\"\n\n# 检查后端虚拟环境\nif [ ! -d \"$BACKEND_DIR/venv\" ]; then\n    echo -e \"${YELLOW}正在创建Python虚拟环境...${NC}\"\n    cd \"$BACKEND_DIR\"\n    python3 -m venv venv\n    source venv/bin/activate\n    pip install -r requirements.txt\n    echo -e \"${GREEN}虚拟环境创建完成${NC}\"\nelse\n    echo -e \"${GREEN}Python虚拟环境已存在${NC}\"\nfi\n\n# 检查前端依赖\nif [ ! -d \"$FRONTEND_DIR/node_modules\" ]; then\n    echo -e \"${YELLOW}正在安装前端依赖...${NC}\"\n    cd \"$FRONTEND_DIR\"\n    npm install\n    echo -e \"${GREEN}前端依赖安装完成${NC}\"\nelse\n    echo -e \"${GREEN}前端依赖已存在${NC}\"\nfi\n\n# 停止可能已运行的服务\necho -e \"${YELLOW}检查并停止已运行的服务...${NC}\"\nlsof -ti:8000 | xargs kill -9 2>/dev/null || true\nlsof -ti:5173 | xargs kill -9 2>/dev/null || true\n\n# 启动后端\necho -e \"${YELLOW}正在启动后端API服务 (端口 8000)...${NC}\"\ncd \"$BACKEND_DIR\"\nsource venv/bin/activate\nnohup python main.py > server.log 2>&1 &\nBACKEND_PID=$!\nsleep 2\n\n# 检查后端是否启动成功\nif curl -s http://localhost:8000/api/health > /dev/null 2>&1; then\n    echo -e \"${GREEN}后端API服务启动成功 (PID: $BACKEND_PID)${NC}\"\nelse\n    echo -e \"${RED}后端API服务启动失败，请检查 $BACKEND_DIR/server.log${NC}\"\n    exit 1\nfi\n\n# 启动前端\necho -e \"${YELLOW}正在启动前端开发服务器 (端口 5173)...${NC}\"\ncd \"$FRONTEND_DIR\"\nnohup npm run dev > dev.log 2>&1 &\nFRONTEND_PID=$!\nsleep 3\n\n# 检查前端是否启动成功\nif curl -s http://localhost:5173 > /dev/null 2>&1; then\n    echo -e \"${GREEN}前端开发服务器启动成功 (PID: $FRONTEND_PID)${NC}\"\nelse\n    echo -e \"${RED}前端开发服务器启动失败，请检查 $FRONTEND_DIR/dev.log${NC}\"\n    exit 1\nfi\n\necho \"\"\necho -e \"${GREEN}===== 启动完成 =====${NC}\"\necho \"\"\necho -e \"后端API: ${GREEN}http://localhost:8000${NC}\"\necho -e \"前端页面: ${GREEN}http://localhost:5173${NC}\"\necho \"\"\necho -e \"日志文件:\"\necho -e \"  后端: $BACKEND_DIR/server.log\"\necho -e \"  前端: $FRONTEND_DIR/dev.log\"\necho \"\"\necho -e \"${YELLOW}停止服务: ./stop.sh 或者 kill $BACKEND_PID $FRONTEND_PID${NC}\"\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/start.sh"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh":[]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/start.sh","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:34:22.184Z","tool_name":"bash","tool_input":{"command":"chmod +x /Users/fanshengxia/Desktop/部门持仓分析系统/start.sh /Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh","description":"Make scripts executable"}}
{"type":"tool_result","timestamp":"2026-01-25T10:34:22.234Z","tool_name":"bash","tool_input":{"command":"chmod +x /Users/fanshengxia/Desktop/部门持仓分析系统/start.sh /Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh","description":"Make scripts executable"},"tool_output":{"output":"","exit":0,"description":"Make scripts executable","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:34:33.598Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"Test backend API startup (install deps + run)"},{"status":"completed","content":"Test frontend dev server startup","id":"2","priority":"high"},{"content":"Fix any runtime errors found","id":"3","priority":"high","status":"completed"},{"id":"4","priority":"medium","status":"completed","content":"Create startup script (start.sh)"},{"priority":"medium","status":"in_progress","content":"Create README.md with usage instructions","id":"5"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:34:33.610Z","tool_name":"todowrite","tool_input":{"todos":[{"id":"1","priority":"high","status":"completed","content":"Test backend API startup (install deps + run)"},{"status":"completed","content":"Test frontend dev server startup","id":"2","priority":"high"},{"content":"Fix any runtime errors found","id":"3","priority":"high","status":"completed"},{"id":"4","priority":"medium","status":"completed","content":"Create startup script (start.sh)"},{"priority":"medium","status":"in_progress","content":"Create README.md with usage instructions","id":"5"}]},"tool_output":{"todos":[{"id":"1","priority":"high","status":"completed","content":"Test backend API startup (install deps + run)"},{"status":"completed","content":"Test frontend dev server startup","id":"2","priority":"high"},{"content":"Fix any runtime errors found","id":"3","priority":"high","status":"completed"},{"id":"4","priority":"medium","status":"completed","content":"Create startup script (start.sh)"},{"priority":"medium","status":"in_progress","content":"Create README.md with usage instructions","id":"5"}],"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:34:43.329Z","tool_name":"write","tool_input":{"content":"# 部门持仓分析系统\n\n多资产投资部持仓统计和分析平台。支持上传持仓盈亏表和产品概览表，自动按分类规则生成交互式持仓分析表格。\n\n## 快速启动\n\n```bash\n./start.sh\n```\n\n启动后访问:\n- 前端页面: http://localhost:5173\n- 后端API: http://localhost:8000\n\n## 停止服务\n\n```bash\n./stop.sh\n```\n\n## 手动启动\n\n### 后端\n\n```bash\ncd backend\npython3 -m venv venv\nsource venv/bin/activate\npip install -r requirements.txt\npython main.py\n```\n\n### 前端\n\n```bash\ncd frontend\nnpm install\nnpm run dev\n```\n\n## 功能模块\n\n| 页面 | 功能 |\n|------|------|\n| 持仓分析 | 上传持仓文件，按资产分类生成多级表格，支持分组筛选和占比切换 |\n| 资产分类管理 | 查看和编辑资产分类规则（4个sheet） |\n| 资产穿透查询 | 搜索特定资产，查看其在各产品中的持仓情况 |\n\n## 数据文件\n\n- `多资产资产分类.xlsx` - 分类规则配置\n- `持仓盈亏明细列表_*.xlsx` - 持仓数据（需上传）\n- `产品运作概览信息表*.xlsx` - 产品概览（需上传）\n\n## API端点\n\n| 端点 | 方法 | 说明 |\n|------|------|------|\n| `/api/health` | GET | 健康检查 |\n| `/api/upload` | POST | 上传持仓和概览文件 |\n| `/api/holdings` | GET | 获取持仓分析数据 |\n| `/api/classifications` | GET/POST | 分类规则管理 |\n| `/api/asset-search` | GET | 资产穿透查询 |\n\n## 技术栈\n\n- 后端: Python FastAPI + Pandas\n- 前端: React + Vite + TailwindCSS\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/README.md"}}
{"type":"tool_result","timestamp":"2026-01-25T10:34:43.339Z","tool_name":"write","tool_input":{"content":"# 部门持仓分析系统\n\n多资产投资部持仓统计和分析平台。支持上传持仓盈亏表和产品概览表，自动按分类规则生成交互式持仓分析表格。\n\n## 快速启动\n\n```bash\n./start.sh\n```\n\n启动后访问:\n- 前端页面: http://localhost:5173\n- 后端API: http://localhost:8000\n\n## 停止服务\n\n```bash\n./stop.sh\n```\n\n## 手动启动\n\n### 后端\n\n```bash\ncd backend\npython3 -m venv venv\nsource venv/bin/activate\npip install -r requirements.txt\npython main.py\n```\n\n### 前端\n\n```bash\ncd frontend\nnpm install\nnpm run dev\n```\n\n## 功能模块\n\n| 页面 | 功能 |\n|------|------|\n| 持仓分析 | 上传持仓文件，按资产分类生成多级表格，支持分组筛选和占比切换 |\n| 资产分类管理 | 查看和编辑资产分类规则（4个sheet） |\n| 资产穿透查询 | 搜索特定资产，查看其在各产品中的持仓情况 |\n\n## 数据文件\n\n- `多资产资产分类.xlsx` - 分类规则配置\n- `持仓盈亏明细列表_*.xlsx` - 持仓数据（需上传）\n- `产品运作概览信息表*.xlsx` - 产品概览（需上传）\n\n## API端点\n\n| 端点 | 方法 | 说明 |\n|------|------|------|\n| `/api/health` | GET | 健康检查 |\n| `/api/upload` | POST | 上传持仓和概览文件 |\n| `/api/holdings` | GET | 获取持仓分析数据 |\n| `/api/classifications` | GET/POST | 分类规则管理 |\n| `/api/asset-search` | GET | 资产穿透查询 |\n\n## 技术栈\n\n- 后端: Python FastAPI + Pandas\n- 前端: React + Vite + TailwindCSS\n","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/README.md"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh":[]},"filepath":"/Users/fanshengxia/Desktop/部门持仓分析系统/README.md","exists":false,"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T10:34:51.979Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"completed"},{"id":"2","priority":"high","status":"completed","content":"Test frontend dev server startup"},{"id":"3","priority":"high","status":"completed","content":"Fix any runtime errors found"},{"priority":"medium","status":"completed","content":"Create startup script (start.sh)","id":"4"},{"priority":"medium","status":"completed","content":"Create README.md with usage instructions","id":"5"}]}}
{"type":"tool_result","timestamp":"2026-01-25T10:34:51.992Z","tool_name":"todowrite","tool_input":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"completed"},{"id":"2","priority":"high","status":"completed","content":"Test frontend dev server startup"},{"id":"3","priority":"high","status":"completed","content":"Fix any runtime errors found"},{"priority":"medium","status":"completed","content":"Create startup script (start.sh)","id":"4"},{"priority":"medium","status":"completed","content":"Create README.md with usage instructions","id":"5"}]},"tool_output":{"todos":[{"content":"Test backend API startup (install deps + run)","id":"1","priority":"high","status":"completed"},{"id":"2","priority":"high","status":"completed","content":"Test frontend dev server startup"},{"id":"3","priority":"high","status":"completed","content":"Fix any runtime errors found"},{"priority":"medium","status":"completed","content":"Create startup script (start.sh)","id":"4"},{"priority":"medium","status":"completed","content":"Create README.md with usage instructions","id":"5"}],"truncated":false}}
{"type":"user","timestamp":"2026-01-25T11:02:19.160Z","content":"[analyze-mode]\nANALYSIS MODE. Gather context before diving deep:\n\nCONTEXT GATHERING (parallel):\n- 1-2 explore agents (codebase patterns, implementations)\n- 1-2 librarian agents (if external library involved)\n- Direct tools: Grep, AST-grep, LSP for targeted searches\n\nIF COMPLEX (architecture, multi-system, debugging after 2+ failures):\n- Consult oracle for strategic guidance\n\nSYNTHESIZE findings before proceeding.\n\n---\n\n[plugin:vite:css] [postcss] It looks like you're trying to use `tailwindcss` directly as a PostCSS plugin. The PostCSS plugin has moved to a separate package, so to continue using Tailwind CSS with PostCSS you'll need to install `@tailwindcss/postcss` and update your PostCSS configuration.\n/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css:undefined:null\n    at lt (/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/node_modules/tailwindcss/dist/lib.js:38:1643)\n    at LazyResult.runOnRoot (/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/node_modules/postcss/lib/lazy-result.js:361:16)\n    at LazyResult.runAsync (/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/node_modules/postcss/lib/lazy-result.js:290:26)\n    at async runPostCSS (file:///Users/fanshengxia/Desktop/%E9%83%A8%E9%97%A8%E6%8C%81%E4%BB%93%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/frontend/node_modules/vite/dist/node/chunks/config.js:30145:19)\n    at async compilePostCSS (file:///Users/fanshengxia/Desktop/%E9%83%A8%E9%97%A8%E6%8C%81%E4%BB%93%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/frontend/node_modules/vite/dist/node/chunks/config.js:30129:6)\n    at async compileCSS (file:///Users/fanshengxia/Desktop/%E9%83%A8%E9%97%A8%E6%8C%81%E4%BB%93%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/frontend/node_modules/vite/dist/node/chunks/config.js:30059:26)\n    at async TransformPluginContext.handler (file:///Users/fanshengxia/Desktop/%E9%83%A8%E9%97%A8%E6%8C%81%E4%BB%93%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/frontend/node_modules/vite/dist/node/chunks/config.js:29592:54)\n    at async EnvironmentPluginContainer.transform (file:///Users/fanshengxia/Desktop/%E9%83%A8%E9%97%A8%E6%8C%81%E4%BB%93%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/frontend/node_modules/vite/dist/node/chunks/config.js:28797:14)\n    at async loadAndTransform (file:///Users/fanshengxia/Desktop/%E9%83%A8%E9%97%A8%E6%8C%81%E4%BB%93%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/frontend/node_modules/vite/dist/node/chunks/config.js:22670:26)\n    at async viteTransformMiddleware (file:///Users/fanshengxia/Desktop/%E9%83%A8%E9%97%A8%E6%8C%81%E4%BB%93%E5%88%86%E6%9E%90%E7%B3%BB%E7%BB%9F/frontend/node_modules/vite/dist/node/chunks/config.js:24542:20)\nClick outside, press Esc key, or fix the code to dismiss.\nYou can also disable this overlay by setting server.hmr.overlay to false in vite.config.ts. "}
{"type":"tool_use","timestamp":"2026-01-25T11:02:30.629Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js"}}
{"type":"tool_result","timestamp":"2026-01-25T11:02:30.633Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js"},"tool_output":{"preview":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T11:02:31.001Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/package.json"}}
{"type":"tool_result","timestamp":"2026-01-25T11:02:31.006Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/package.json"},"tool_output":{"preview":"{\n  \"name\": \"frontend\",\n  \"private\": true,\n  \"version\": \"0.0.0\",\n  \"type\": \"module\",\n  \"scripts\": {\n    \"dev\": \"vite\",\n    \"build\": \"tsc -b && vite build\",\n    \"lint\": \"eslint .\",\n    \"preview\": \"vite preview\"\n  },\n  \"dependencies\": {\n    \"@tanstack/react-table\": \"^8.21.3\",\n    \"lucide-react\": \"^0.563.0\",\n    \"react\": \"^19.2.0\",\n    \"react-dom\": \"^19.2.0\"\n  },\n  \"devDependencies\": {\n    \"@eslint/js\": \"^9.39.1\",\n    \"@types/node\": \"^24.10.1\",","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T11:02:40.738Z","tool_name":"bash","tool_input":{"description":"Install @tailwindcss/postcss","timeout":60000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm install @tailwindcss/postcss -D 2>&1 | tail -5"}}
{"type":"tool_result","timestamp":"2026-01-25T11:02:51.465Z","tool_name":"bash","tool_input":{"description":"Install @tailwindcss/postcss","timeout":60000,"command":"cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm install @tailwindcss/postcss -D 2>&1 | tail -5"},"tool_output":{"output":"\n53 packages are looking for funding\n  run `npm fund` for details\n\nfound 0 vulnerabilities\n","exit":0,"description":"Install @tailwindcss/postcss","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T11:02:57.507Z","tool_name":"edit","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js","oldString":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}","newString":"export default {\n  plugins: {\n    '@tailwindcss/postcss': {},\n  },\n}"}}
{"type":"tool_result","timestamp":"2026-01-25T11:02:57.520Z","tool_name":"edit","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js","oldString":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}","newString":"export default {\n  plugins: {\n    '@tailwindcss/postcss': {},\n  },\n}"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh":[]},"diff":"Index: /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js\n===================================================================\n--- /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js\n+++ /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js\n@@ -1,6 +1,5 @@\n export default {\n   plugins: {\n-    tailwindcss: {},\n-    autoprefixer: {},\n+    '@tailwindcss/postcss': {},\n   },\n }\n","filediff":{"file":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/postcss.config.js","before":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","after":"export default {\n  plugins: {\n    '@tailwindcss/postcss': {},\n  },\n}\n","additions":1,"deletions":2},"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T11:06:19.450Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css"}}
{"type":"tool_result","timestamp":"2026-01-25T11:06:19.459Z","tool_name":"read","tool_input":{"filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css"},"tool_output":{"preview":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --navy-primary: #1F497D;\n  --navy-secondary: #305496;\n  --subtotal-bg: #E7E6E6;\n  --total-bg: #BDD7EE;\n  --border-color: #D4D4D4;\n}\n\nbody {\n  font-family: 'IBM Plex Sans', 'Source Sans Pro', system-ui, sans-serif;\n  background-color: #f8fafc;\n  color: #1e293b;\n  margin: 0;\n}","truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T11:06:31.329Z","tool_name":"edit","tool_input":{"oldString":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;","newString":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@import \"tailwindcss\";","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css"}}
{"type":"tool_result","timestamp":"2026-01-25T11:06:31.337Z","tool_name":"edit","tool_input":{"oldString":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;","newString":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@import \"tailwindcss\";","filePath":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css"},"tool_output":{"diagnostics":{"/Users/fanshengxia/Desktop/部门持仓分析系统/投委会团队持仓统计分析.py":[{"range":{"start":{"line":51,"character":11},"end":{"line":51,"character":40}},"message":"No overloads for \"read_excel\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/opt/anaconda3/lib/python3.9/site-packages/pandas/io/excel/_base.py","range":{"start":{"line":398,"character":4},"end":{"line":398,"character":14}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"sheet_name\" of type \"list[IntStrT@read_excel] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[IntStrT@read_excel] | None\"\n    \"object\" is not assignable to \"list[IntStrT@read_excel]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"header\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"names\" of type \"list[str] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[str] | None\"\n    \"object\" is not assignable to \"list[str]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"index_col\" of type \"int | Sequence[int] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | Sequence[int] | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"usecols\" of type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | str | Sequence[int] | Sequence[str] | ((str) -> bool) | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"Sequence[str]\"\n    Type \"object\" is not assignable to type \"(str) -> bool\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype\" of type \"DtypeArg | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeArg | None\"\n    \"object\" is not assignable to \"ExtensionDtype\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"dtype[Unknown]\"\n    Type \"object\" is not assignable to type \"type[str]\"\n    Type \"object\" is not assignable to type \"type[complex]\"\n    Type \"object\" is not assignable to type \"type[bool]\"\n    Type \"object\" is not assignable to type \"type[object]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"engine\" of type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Literal['xlrd', 'openpyxl', 'odf', 'pyxlsb'] | None\"\n    \"object\" is not assignable to \"None\"\n    \"object\" is not assignable to \"Literal['xlrd']\"\n    \"object\" is not assignable to \"Literal['openpyxl']\"\n    \"object\" is not assignable to \"Literal['odf']\"\n    \"object\" is not assignable to \"Literal['pyxlsb']\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"converters\" of type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[str, (...) -> Unknown] | dict[int, (...) -> Unknown] | None\"\n    \"object\" is not assignable to \"dict[str, (...) -> Unknown]\"\n    \"object\" is not assignable to \"dict[int, (...) -> Unknown]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"true_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"false_values\" of type \"Iterable[Hashable] | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Iterable[Hashable] | None\"\n    \"object\" is incompatible with protocol \"Iterable[Hashable]\"\n      \"__iter__\" is not present\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skiprows\" of type \"Sequence[int] | int | ((int) -> object) | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"Sequence[int] | int | ((int) -> object) | None\"\n    \"object\" is not assignable to \"Sequence[int]\"\n    \"object\" is not assignable to \"int\"\n    Type \"object\" is not assignable to type \"(int) -> object\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"nrows\" of type \"int | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"int | None\"\n    \"object\" is not assignable to \"int\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"keep_default_na\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"na_filter\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"verbose\" of type \"bool\" in function \"read_excel\"\n  \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"parse_dates\" of type \"list[Unknown] | dict[Unknown, Unknown] | bool\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"list[Unknown] | dict[Unknown, Unknown] | bool\"\n    \"object\" is not assignable to \"list[Unknown]\"\n    \"object\" is not assignable to \"dict[Unknown, Unknown]\"\n    \"object\" is not assignable to \"bool\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_parser\" of type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"((...) -> Unknown) | Literal[_NoDefault.no_default]\"\n    Type \"object\" is not assignable to type \"(...) -> Unknown\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"date_format\" of type \"dict[Hashable, str] | str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"dict[Hashable, str] | str | None\"\n    \"object\" is not assignable to \"dict[Hashable, str]\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"thousands\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"decimal\" of type \"str\" in function \"read_excel\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"comment\" of type \"str | None\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"str | None\"\n    \"object\" is not assignable to \"str\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"skipfooter\" of type \"int\" in function \"read_excel\"\n  \"object\" is not assignable to \"int\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"storage_options\" of type \"StorageOptions\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"StorageOptions\"\n    \"object\" is not assignable to \"Dict[str, Any]\"\n    \"object\" is not assignable to \"None\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":51,"character":33},"end":{"line":51,"character":39}},"message":"Argument of type \"object\" cannot be assigned to parameter \"dtype_backend\" of type \"DtypeBackend | Literal[_NoDefault.no_default]\" in function \"read_excel\"\n  Type \"object\" is not assignable to type \"DtypeBackend | Literal[_NoDefault.no_default]\"\n    \"object\" is not assignable to \"Literal['pyarrow']\"\n    \"object\" is not assignable to \"Literal['numpy_nullable']\"\n    \"object\" is not assignable to \"Literal[_NoDefault.no_default]\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":63,"character":16},"end":{"line":63,"character":69}},"message":"No overloads for \"dropna\" match the provided arguments\n  Argument types: (list[str])","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"}},{"range":{"start":{"line":72,"character":55},"end":{"line":72,"character":60}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":76,"character":60},"end":{"line":76,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":80,"character":60},"end":{"line":80,"character":65}},"message":"Cannot access attribute \"items\" for class \"object\"\n  Attribute \"items\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":98,"character":66},"end":{"line":98,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":99,"character":50},"end":{"line":99,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":239,"character":18},"end":{"line":239,"character":35}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":122,"character":19},"end":{"line":122,"character":49}},"message":"Operator \"not in\" not supported for types \"str\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":123,"character":40},"end":{"line":123,"character":46}},"message":"Cannot access attribute \"append\" for class \"object\"\n  Attribute \"append\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":161,"character":11},"end":{"line":161,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":162,"character":46},"end":{"line":162,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":162,"character":52},"end":{"line":162,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":163,"character":11},"end":{"line":163,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":164,"character":43},"end":{"line":164,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":164,"character":49},"end":{"line":164,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":169,"character":11},"end":{"line":169,"character":23}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":170,"character":46},"end":{"line":170,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":170,"character":52},"end":{"line":170,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":171,"character":11},"end":{"line":171,"character":20}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":172,"character":43},"end":{"line":172,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":172,"character":49},"end":{"line":172,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":178,"character":11},"end":{"line":178,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":179,"character":41},"end":{"line":179,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":179,"character":48},"end":{"line":179,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":203,"character":11},"end":{"line":203,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":204,"character":48},"end":{"line":204,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":204,"character":62},"end":{"line":204,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":50},"end":{"line":207,"character":101}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":207,"character":76},"end":{"line":207,"character":84}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":207,"character":16},"end":{"line":207,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":252,"character":37},"end":{"line":252,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":278,"character":37},"end":{"line":278,"character":64}},"message":"Type \"object\" is not assignable to declared type \"List[str]\"\n  \"object\" is not assignable to \"List[str]\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":291,"character":15},"end":{"line":291,"character":37}},"message":"Operator \"in\" not supported for types \"Literal['券商收益凭证']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":291,"character":42},"end":{"line":291,"character":64}},"message":"Operator \"in\" not supported for types \"Literal['保险资管计划']\" and \"object\"","severity":1,"code":"reportOperatorIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOperatorIssue"}},{"range":{"start":{"line":292,"character":27},"end":{"line":292,"character":33}},"message":"Cannot access attribute \"remove\" for class \"object\"\n  Attribute \"remove\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":293,"character":40},"end":{"line":293,"character":45}},"message":"Cannot access attribute \"index\" for class \"object\"\n  Attribute \"index\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":294,"character":27},"end":{"line":294,"character":33}},"message":"Cannot access attribute \"insert\" for class \"object\"\n  Attribute \"insert\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":318,"character":9},"end":{"line":318,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}},{"range":{"start":{"line":321,"character":39},"end":{"line":321,"character":44}},"message":"\"apply\" is not a known attribute of \"None\"","severity":1,"code":"reportOptionalMemberAccess","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportOptionalMemberAccess"}},{"range":{"start":{"line":511,"character":8},"end":{"line":511,"character":23}},"message":"Argument of type \"Unknown | Hashable | Any\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Unknown | Hashable | Any\" is not assignable to type \"str\"\n    \"Hashable\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":582,"character":39},"end":{"line":582,"character":49}},"message":"Argument of type \"object\" cannot be assigned to parameter \"iterable\" of type \"Iterable[_T@enumerate]\" in function \"__new__\"\n  \"object\" is incompatible with protocol \"Iterable[_T@enumerate]\"\n    \"__iter__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":597,"character":48},"end":{"line":597,"character":77}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":597,"character":67},"end":{"line":597,"character":72}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":609,"character":66},"end":{"line":609,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":600,"character":16},"end":{"line":611,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":626,"character":30},"end":{"line":626,"character":65}},"message":"No overloads for \"get\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1226,"character":8},"end":{"line":1226,"character":11}}},"message":"Overload 3 is the closest match"}]},{"range":{"start":{"line":626,"character":49},"end":{"line":626,"character":60}},"message":"Argument of type \"object\" cannot be assigned to parameter \"key\" of type \"str\" in function \"get\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":627,"character":66},"end":{"line":627,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":618,"character":16},"end":{"line":629,"character":17}},"message":"Argument of type \"dict[str, object | str | Unknown]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":631,"character":32},"end":{"line":631,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":645,"character":66},"end":{"line":645,"character":71}},"message":"Argument of type \"object\" cannot be assigned to parameter \"group\" of type \"str\" in function \"format_delta_by_group\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":636,"character":16},"end":{"line":647,"character":17}},"message":"Argument of type \"dict[str, object | str]\" cannot be assigned to parameter \"object\" of type \"Dict[str, str]\" in function \"append\"\n  \"object\" is not assignable to \"str\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":721,"character":41},"end":{"line":721,"character":56}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":723,"character":46},"end":{"line":723,"character":62}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":733,"character":41},"end":{"line":733,"character":54}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":735,"character":46},"end":{"line":735,"character":60}},"message":"Argument of type \"float | None\" cannot be assigned to parameter \"value\" of type \"float\" in function \"format_percentage\"\n  Type \"float | None\" is not assignable to type \"float\"\n    \"None\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":823,"character":50},"end":{"line":823,"character":54}},"message":"Argument of type \"set[str | None]\" cannot be assigned to parameter \"skip_values\" of type \"Set[str] | None\" in function \"merge_identical_cells\"\n  \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":838,"character":31},"end":{"line":838,"character":34}},"message":"Cannot assign to attribute \"value\" for class \"MergedCell\"\n  \"Literal['-']\" is not assignable to \"None\"","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":885,"character":24},"end":{"line":885,"character":34}},"message":"\"object\" is not iterable\n  \"__iter__\" method not defined","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":888,"character":16},"end":{"line":894,"character":17}},"message":"Argument of type \"dict[str, object | Unknown | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":902,"character":16},"end":{"line":908,"character":17}},"message":"Argument of type \"dict[str, object | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":910,"character":32},"end":{"line":910,"character":43}},"message":"Argument of type \"object\" cannot be assigned to parameter \"element\" of type \"str\" in function \"add\"\n  \"object\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":914,"character":16},"end":{"line":920,"character":17}},"message":"Argument of type \"dict[str, object | str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"object\" is not assignable to \"float\"\n  \"object\" is not assignable to \"float\"\n  \"Literal['黄金资产合计']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":929,"character":12},"end":{"line":935,"character":13}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"\n  \"str\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":942,"character":8},"end":{"line":948,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['总资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":951,"character":8},"end":{"line":957,"character":9}},"message":"Argument of type \"dict[str, str | float]\" cannot be assigned to parameter \"object\" of type \"Dict[str, float]\" in function \"append\"\n  \"Literal['合计']\" is not assignable to \"float\"\n  \"Literal['']\" is not assignable to \"float\"\n  \"Literal['净资产']\" is not assignable to \"float\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":969,"character":26},"end":{"line":969,"character":51}},"message":"Argument of type \"str | None\" cannot be assigned to parameter \"path\" of type \"str\" in function \"read_excel\"\n  Type \"str | None\" is not assignable to type \"str\"\n    \"None\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":971,"character":31},"end":{"line":971,"character":39}},"message":"Argument of type \"DataFrame | Series | Unknown\" cannot be assigned to parameter \"df\" of type \"DataFrame\" in function \"enrich_holdings\"\n  Type \"DataFrame | Series | Unknown\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":1043,"character":9},"end":{"line":1043,"character":55}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/classification.py":[{"range":{"start":{"line":34,"character":66},"end":{"line":34,"character":71}},"message":"Cannot access attribute \"ffill\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"ffill\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":35,"character":50},"end":{"line":35,"character":56}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":96,"character":11},"end":{"line":96,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":97,"character":46},"end":{"line":97,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":97,"character":52},"end":{"line":97,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":98,"character":11},"end":{"line":98,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":99,"character":43},"end":{"line":99,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":99,"character":49},"end":{"line":99,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":103,"character":11},"end":{"line":103,"character":54}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":104,"character":46},"end":{"line":104,"character":50}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":104,"character":52},"end":{"line":104,"character":64}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":105,"character":11},"end":{"line":105,"character":48}},"message":"Invalid conditional operand of type \"NDArray[bool_] | Series | Unknown | Any | ndarray[Unknown, Unknown] | NDFrame | Literal[False]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"\n  Method __bool__ for type \"NDFrame\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":106,"character":43},"end":{"line":106,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":106,"character":49},"end":{"line":106,"character":58}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":111,"character":11},"end":{"line":111,"character":29}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":112,"character":41},"end":{"line":112,"character":46}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":112,"character":48},"end":{"line":112,"character":56}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":132,"character":11},"end":{"line":132,"character":36}},"message":"Invalid conditional operand of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\"\n  Method __bool__ for type \"Series\" returns type \"NoReturn\" rather than \"bool\"","severity":1,"code":"reportGeneralTypeIssues","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportGeneralTypeIssues"}},{"range":{"start":{"line":133,"character":48},"end":{"line":133,"character":60}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":133,"character":62},"end":{"line":133,"character":70}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"default\" of type \"str\" in function \"setdefault\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":135,"character":16},"end":{"line":135,"character":47}},"message":"Argument of type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" cannot be assigned to parameter \"key\" of type \"str\" in function \"__setitem__\"\n  Type \"Series | Unknown | Any | ndarray[Unknown, Unknown]\" is not assignable to type \"str\"\n    \"Series\" is not assignable to \"str\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":297,"character":9},"end":{"line":297,"character":35}},"message":"Type \"Series | Unknown | DataFrame\" is not assignable to declared type \"DataFrame\"\n  Type \"Series | Unknown | DataFrame\" is not assignable to type \"DataFrame\"\n    \"Series\" is not assignable to \"DataFrame\"","severity":1,"code":"reportAssignmentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAssignmentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/backend/main.py":[{"range":{"start":{"line":92,"character":13},"end":{"line":92,"character":72}},"message":"Cannot instantiate abstract class \"ExcelWriter\"\n  \"ExcelWriter.sheets\" is not implemented\n  \"ExcelWriter.book\" is not implemented\n  and 2 more...","severity":1,"code":"reportAbstractUsage","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAbstractUsage"}},{"range":{"start":{"line":128,"character":16},"end":{"line":128,"character":88}},"message":"Argument of type \"Series | DataFrame | Unknown | None\" cannot be assigned to parameter \"right\" of type \"DataFrame | Series\" in function \"merge\"\n  Type \"Series | DataFrame | Unknown | None\" is not assignable to type \"DataFrame | Series\"\n    Type \"None\" is not assignable to type \"DataFrame | Series\"\n      \"None\" is not assignable to \"DataFrame\"\n      \"None\" is not assignable to \"Series\"","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":182,"character":70},"end":{"line":182,"character":76}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":235,"character":52},"end":{"line":235,"character":58}},"message":"Cannot access attribute \"unique\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"unique\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"float\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NAType\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Unknown, Unknown]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"ndarray[Any, dtype[Any]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":309,"character":86},"end":{"line":309,"character":92}},"message":"Cannot access attribute \"fillna\" for class \"NDArray[signedinteger[_64Bit]]\"\n  Attribute \"fillna\" is unknown","severity":1,"code":"reportAttributeAccessIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportAttributeAccessIssue"}},{"range":{"start":{"line":341,"character":32},"end":{"line":341,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":341,"character":38},"end":{"line":341,"character":51}},"message":"Argument of type \"int | Unknown | Any | NDArray[floating[Any]]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T@round]\" in function \"round\"\n  Type \"int | Unknown | Any | NDArray[floating[Any]]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}},{"range":{"start":{"line":329,"character":32},"end":{"line":329,"character":55}},"message":"No overloads for \"round\" match the provided arguments","severity":1,"code":"reportCallIssue","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportCallIssue"},"relatedInformation":[{"location":{"uri":"file:///Users/fanshengxia/.local/share/opencode/bin/node_modules/pyright/dist/typeshed-fallback/stdlib/builtins.pyi","range":{"start":{"line":1910,"character":4},"end":{"line":1910,"character":9}}},"message":"Overload 2 is the closest match"}]},{"range":{"start":{"line":329,"character":38},"end":{"line":329,"character":51}},"message":"Argument of type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" cannot be assigned to parameter \"number\" of type \"_SupportsRound2[_T(1)@round]\" in function \"round\"\n  Type \"Unknown | Any | NDArray[floating[Any]] | Literal[0]\" is not assignable to type \"_SupportsRound2[int]\"\n    \"ndarray[Any, dtype[floating[Any]]]\" is incompatible with protocol \"_SupportsRound2[int]\"\n      \"__round__\" is not present","severity":1,"code":"reportArgumentType","source":"Pyright","codeDescription":{"href":"https://github.com/microsoft/pyright/blob/main/docs/configuration.md#reportArgumentType"}}],"/Users/fanshengxia/Desktop/部门持仓分析系统/stop.sh":[]},"diff":"Index: /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css\n===================================================================\n--- /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css\n+++ /Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css\n@@ -1,9 +1,7 @@\n @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n \n-@tailwind base;\n-@tailwind components;\n-@tailwind utilities;\n+@import \"tailwindcss\";\n \n :root {\n   --navy-primary: #1F497D;\n   --navy-secondary: #305496;\n","filediff":{"file":"/Users/fanshengxia/Desktop/部门持仓分析系统/frontend/src/index.css","before":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --navy-primary: #1F497D;\n  --navy-secondary: #305496;\n  --subtotal-bg: #E7E6E6;\n  --total-bg: #BDD7EE;\n  --border-color: #D4D4D4;\n}\n\nbody {\n  font-family: 'IBM Plex Sans', 'Source Sans Pro', system-ui, sans-serif;\n  background-color: #f8fafc;\n  color: #1e293b;\n  margin: 0;\n}\n\n.financial-table {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.financial-table th,\n.financial-table td {\n  border: 1px solid var(--border-color);\n  padding: 8px 12px;\n  font-size: 13px;\n}\n\n.financial-table th {\n  background-color: var(--navy-primary);\n  color: white;\n  font-weight: 600;\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n}\n\n.financial-table td {\n  vertical-align: middle;\n}\n\n.financial-table td.currency-cell {\n  background-color: var(--navy-secondary);\n  color: white;\n  font-weight: 700;\n  text-align: center;\n}\n\n.financial-table td.value-cell {\n  text-align: right;\n  font-family: 'IBM Plex Mono', monospace;\n  font-size: 12px;\n}\n\n.financial-table tr.subtotal-row td {\n  background-color: var(--subtotal-bg);\n  font-weight: 600;\n}\n\n.financial-table tr.total-row td {\n  background-color: var(--total-bg);\n  font-weight: 700;\n}\n\n.file-drop-zone {\n  border: 2px dashed #cbd5e1;\n  border-radius: 12px;\n  padding: 48px;\n  text-align: center;\n  transition: all 0.2s ease;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n\n.file-drop-zone:hover,\n.file-drop-zone.drag-over {\n  border-color: var(--navy-primary);\n  background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);\n}\n\n.sidebar-link {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #64748b;\n  transition: all 0.15s ease;\n  font-weight: 500;\n  text-decoration: none;\n}\n\n.sidebar-link:hover {\n  background-color: #f1f5f9;\n  color: #1e293b;\n}\n\n.sidebar-link.active {\n  background-color: var(--navy-primary);\n  color: white;\n}\n\n.filter-select {\n  padding: 8px 12px;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  background: white;\n  font-size: 14px;\n  min-width: 160px;\n  cursor: pointer;\n}\n\n.filter-select:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 0 0 3px rgba(31, 73, 125, 0.1);\n}\n\n.toggle-btn {\n  padding: 6px 14px;\n  border: 1px solid #e2e8f0;\n  background: white;\n  font-size: 13px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.toggle-btn:first-child {\n  border-radius: 6px 0 0 6px;\n}\n\n.toggle-btn:last-child {\n  border-radius: 0 6px 6px 0;\n  border-left: none;\n}\n\n.toggle-btn.active {\n  background-color: var(--navy-primary);\n  color: white;\n  border-color: var(--navy-primary);\n}\n\n.search-input {\n  width: 100%;\n  max-width: 400px;\n  padding: 12px 16px 12px 44px;\n  border: 2px solid #e2e8f0;\n  border-radius: 10px;\n  font-size: 15px;\n  transition: all 0.2s ease;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 4px 12px rgba(31, 73, 125, 0.15);\n}\n","after":"@import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&family=IBM+Plex+Mono&display=swap');\n\n@import \"tailwindcss\";\n\n:root {\n  --navy-primary: #1F497D;\n  --navy-secondary: #305496;\n  --subtotal-bg: #E7E6E6;\n  --total-bg: #BDD7EE;\n  --border-color: #D4D4D4;\n}\n\nbody {\n  font-family: 'IBM Plex Sans', 'Source Sans Pro', system-ui, sans-serif;\n  background-color: #f8fafc;\n  color: #1e293b;\n  margin: 0;\n}\n\n.financial-table {\n  border-collapse: collapse;\n  width: 100%;\n}\n\n.financial-table th,\n.financial-table td {\n  border: 1px solid var(--border-color);\n  padding: 8px 12px;\n  font-size: 13px;\n}\n\n.financial-table th {\n  background-color: var(--navy-primary);\n  color: white;\n  font-weight: 600;\n  text-align: center;\n  position: sticky;\n  top: 0;\n  z-index: 10;\n}\n\n.financial-table td {\n  vertical-align: middle;\n}\n\n.financial-table td.currency-cell {\n  background-color: var(--navy-secondary);\n  color: white;\n  font-weight: 700;\n  text-align: center;\n}\n\n.financial-table td.value-cell {\n  text-align: right;\n  font-family: 'IBM Plex Mono', monospace;\n  font-size: 12px;\n}\n\n.financial-table tr.subtotal-row td {\n  background-color: var(--subtotal-bg);\n  font-weight: 600;\n}\n\n.financial-table tr.total-row td {\n  background-color: var(--total-bg);\n  font-weight: 700;\n}\n\n.file-drop-zone {\n  border: 2px dashed #cbd5e1;\n  border-radius: 12px;\n  padding: 48px;\n  text-align: center;\n  transition: all 0.2s ease;\n  background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);\n}\n\n.file-drop-zone:hover,\n.file-drop-zone.drag-over {\n  border-color: var(--navy-primary);\n  background: linear-gradient(135deg, #e0f2fe 0%, #dbeafe 100%);\n}\n\n.sidebar-link {\n  display: flex;\n  align-items: center;\n  gap: 12px;\n  padding: 12px 16px;\n  border-radius: 8px;\n  color: #64748b;\n  transition: all 0.15s ease;\n  font-weight: 500;\n  text-decoration: none;\n}\n\n.sidebar-link:hover {\n  background-color: #f1f5f9;\n  color: #1e293b;\n}\n\n.sidebar-link.active {\n  background-color: var(--navy-primary);\n  color: white;\n}\n\n.filter-select {\n  padding: 8px 12px;\n  border: 1px solid #e2e8f0;\n  border-radius: 6px;\n  background: white;\n  font-size: 14px;\n  min-width: 160px;\n  cursor: pointer;\n}\n\n.filter-select:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 0 0 3px rgba(31, 73, 125, 0.1);\n}\n\n.toggle-btn {\n  padding: 6px 14px;\n  border: 1px solid #e2e8f0;\n  background: white;\n  font-size: 13px;\n  cursor: pointer;\n  transition: all 0.15s ease;\n}\n\n.toggle-btn:first-child {\n  border-radius: 6px 0 0 6px;\n}\n\n.toggle-btn:last-child {\n  border-radius: 0 6px 6px 0;\n  border-left: none;\n}\n\n.toggle-btn.active {\n  background-color: var(--navy-primary);\n  color: white;\n  border-color: var(--navy-primary);\n}\n\n.search-input {\n  width: 100%;\n  max-width: 400px;\n  padding: 12px 16px 12px 44px;\n  border: 2px solid #e2e8f0;\n  border-radius: 10px;\n  font-size: 15px;\n  transition: all 0.2s ease;\n}\n\n.search-input:focus {\n  outline: none;\n  border-color: var(--navy-primary);\n  box-shadow: 0 4px 12px rgba(31, 73, 125, 0.15);\n}\n","additions":1,"deletions":3},"truncated":false}}
{"type":"tool_use","timestamp":"2026-01-25T11:06:38.260Z","tool_name":"bash","tool_input":{"command":"lsof -ti:5173 | xargs kill -9 2>/dev/null; cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm run dev > /dev/null 2>&1 &\nsleep 4 && curl -s http://localhost:5173 | head -5","description":"Restart frontend and test","timeout":30000}}
{"type":"tool_result","timestamp":"2026-01-25T11:06:43.444Z","tool_name":"bash","tool_input":{"command":"lsof -ti:5173 | xargs kill -9 2>/dev/null; cd /Users/fanshengxia/Desktop/部门持仓分析系统/frontend && npm run dev > /dev/null 2>&1 &\nsleep 4 && curl -s http://localhost:5173 | head -5","description":"Restart frontend and test","timeout":30000},"tool_output":{"output":"<!doctype html>\n<html lang=\"en\">\n  <head>\n    <script type=\"module\">import { injectIntoGlobalHook } from \"/@react-refresh\";\ninjectIntoGlobalHook(window);\n","exit":0,"description":"Restart frontend and test","truncated":false}}
{"type":"user","timestamp":"2026-01-25T11:09:15.642Z","content":"我上传了数据好像没有反应"}
{"type":"user","timestamp":"2026-01-25T11:10:20.045Z","content":"我上传了数据好像没有反应"}
{"type":"user","timestamp":"2026-01-25T11:11:00.150Z","content":"继续"}
{"type":"user","timestamp":"2026-01-25T11:11:32.084Z","content":"我上传了数据但没有反应"}
