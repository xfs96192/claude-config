# 基金分类标签管理系统 v2.1 - 测试验证清单

## 测试日期
2026-01-20

## 测试环境
- 浏览器：Chrome/Firefox/Safari
- 操作系统：macOS/Windows
- 测试文件：fund_analysis.html

---

## 一、基础功能测试

### 1.1 页面加载
- [ ] 页面成功加载，无JavaScript错误
- [ ] 所有CSS样式正确显示
- [ ] 两个上传区域正确显示

### 1.2 基金分类表上传
- [ ] 可以选择Excel文件
- [ ] 上传成功显示"✅ 成功加载 XX 个基金分类"
- [ ] 失败时显示错误提示

### 1.3 持仓明细表上传
- [ ] 未上传分类表时提示"❌ 请先上传基金分类表"
- [ ] 已上传分类表后可以成功上传持仓表
- [ ] 显示匹配统计信息

---

## 二、含权基金检测功能测试 ⭐ 新功能

### 2.1 所有含权基金已分类场景

**测试步骤**：
1. 准备完整的基金分类表（包含所有含权基金）
2. 上传基金分类表
3. 上传持仓明细表（包含被动指数型、混合债券型二级、偏股混合型、普通股票型、灵活配置型基金）

**预期结果**：
- [ ] 显示绿色提示框
- [ ] 提示标题为"✅ 含权基金均已导入和分类完成"
- [ ] 显示检测的5类资产类别
- [ ] 有"隐藏此提示"按钮
- [ ] 点击按钮可隐藏提示

### 2.2 部分含权基金未分类场景

**测试步骤**：
1. 准备不完整的基金分类表（故意缺少2-3个含权基金）
2. 上传基金分类表
3. 上传包含缺失基金的持仓明细表

**预期结果**：
- [ ] 显示橙色警告框
- [ ] 提示标题为"⚠️ 发现未分类的含权基金"
- [ ] 显示未分类基金数量
- [ ] 列出所有未分类基金的详细信息（表格形式）
- [ ] 表格包含：基金名称、资产小类、外部代码、资产代码
- [ ] 显示操作建议（3条）
- [ ] 有"暂时隐藏"按钮
- [ ] 点击按钮可隐藏提示

### 2.3 检测范围验证

**测试数据**：
准备持仓表包含以下类型基金：
- 被动指数型基金（应检测）
- 混合债券型二级基金（应检测）
- 偏股混合型基金（应检测）
- 普通股票型基金（应检测）
- 灵活配置型基金（应检测）
- 纯债基金（不应检测）
- 货币基金（不应检测）

**预期结果**：
- [ ] 只检测上述5类含权基金
- [ ] 纯债基金和货币基金不在提示中出现

### 2.4 匹配逻辑验证

**测试用例1：外部代码匹配**
```
分类表：外部代码 = "515220.SH", 资产代码 = ""
持仓表：外部代码 = "515220.SH", 资产代码 = ""
```
- [ ] 匹配成功，不在未分类列表中

**测试用例2：资产代码匹配**
```
分类表：外部代码 = "", 资产代码 = "80PF210158"
持仓表：外部代码 = "", 资产代码 = "80PF210158"
```
- [ ] 匹配成功，不在未分类列表中

**测试用例3：优先使用外部代码**
```
分类表：外部代码 = "515220.SH", 资产代码 = "ABC"
持仓表：外部代码 = "515220.SH", 资产代码 = "XYZ"
```
- [ ] 匹配成功（使用外部代码）

**测试用例4：匹配失败**
```
分类表：外部代码 = "515220.SH"
持仓表：外部代码 = "999999.OF"
```
- [ ] 匹配失败，出现在未分类列表中

### 2.5 去重验证

**测试步骤**：
1. 准备持仓表，同一个基金在多个产品中出现
2. 该基金未在分类表中

**预期结果**：
- [ ] 未分类列表中该基金只出现一次
- [ ] 使用matchKey去重

---

## 三、数据处理功能测试

### 3.1 正回购处理
- [ ] 资产名称包含"正回购"的记录正确从净资产中减去
- [ ] 计算的净资产值正确

### 3.2 权益暴露计算
- [ ] 权益暴露 = 持仓金额 × (权益仓位 / 100)
- [ ] 计算结果正确

### 3.3 风格占比计算
- [ ] 风格占比 = 该风格暴露 / 总暴露 × 100%
- [ ] 计算结果正确
- [ ] 矩阵表格占比四舍五入到整数

### 3.4 详细表格占比计算
- [ ] 权益暴露占比 = 权益暴露金额 / 产品净资产 × 100%
- [ ] 保留2位小数

---

## 四、界面展示测试

### 4.1 汇总统计
- [ ] 产品数量正确
- [ ] 风格数量正确
- [ ] 总权益暴露正确

### 4.2 矩阵表格
- [ ] 产品名称显示正确
- [ ] 风格按顺序排列（红利、均衡、科技成长、周期、价值）
- [ ] 金额模式：显示万元，整数
- [ ] 占比模式：显示整数%
- [ ] 金额/占比切换正常

### 4.3 产品筛选
- [ ] 显示所有产品复选框
- [ ] 全选按钮正常
- [ ] 全不选按钮正常
- [ ] 单个产品选择/取消正常
- [ ] 筛选后所有视图同步更新

### 4.4 产品卡片
- [ ] 每个产品显示一个卡片
- [ ] 环形图正确显示
- [ ] 风格列表正确（按顺序）
- [ ] 金额和占比数据正确

### 4.5 详细数据表格
- [ ] 所有列数据正确
- [ ] 排序正确（产品名→风格→权益暴露占比降序）
- [ ] 只显示选中产品的数据

---

## 五、导出功能测试

### 5.1 导出Excel
- [ ] 点击导出按钮成功生成Excel文件
- [ ] 文件名格式：基金分析结果_YYYY-MM-DD.xlsx
- [ ] 可以正常打开Excel文件

### 5.2 工作表1：产品风格汇总-金额
- [ ] 表头正确：产品名称 | 红利 | 均衡 | 科技成长 | 周期 | 价值
- [ ] 数据为整数（万元）
- [ ] 只包含选中的产品

### 5.3 工作表2：产品风格汇总-占比
- [ ] 表头正确
- [ ] 数据为百分比格式（如"25%"）
- [ ] 只包含选中的产品

### 5.4 工作表3：持仓明细
- [ ] 表头正确（8列）
- [ ] 所有数据正确
- [ ] 排序正确
- [ ] 只包含选中产品的数据

---

## 六、边界情况测试

### 6.1 空数据
- [ ] 空的基金分类表 → 适当的错误提示
- [ ] 空的持仓表 → 适当的错误提示

### 6.2 无匹配数据
- [ ] 所有持仓都无法匹配 → 显示统计信息，结果为空

### 6.3 特殊字符
- [ ] 产品名称包含特殊字符 → 正常处理
- [ ] 基金名称包含特殊字符 → 正常处理

### 6.4 大数据量
- [ ] 1000+条持仓记录 → 性能正常
- [ ] 100+个基金分类 → 性能正常

---

## 七、错误处理测试

### 7.1 文件格式错误
- [ ] 上传非Excel文件 → 错误提示
- [ ] Excel文件缺少必需列 → 错误提示

### 7.2 数据格式错误
- [ ] 权益仓位非数字 → 跳过或默认值
- [ ] 持仓金额非数字 → 跳过或默认值

### 7.3 空值处理
- [ ] 外部代码和资产代码都为空 → 正确处理
- [ ] 产品名称为空 → 跳过该记录

---

## 八、浏览器兼容性测试

### 8.1 Chrome
- [ ] 所有功能正常
- [ ] 界面显示正常

### 8.2 Firefox
- [ ] 所有功能正常
- [ ] 界面显示正常

### 8.3 Safari
- [ ] 所有功能正常
- [ ] 界面显示正常

### 8.4 Edge
- [ ] 所有功能正常
- [ ] 界面显示正常

---

## 九、控制台日志检查

- [ ] 无JavaScript错误
- [ ] 匹配统计日志正确
- [ ] 含权基金检测日志正确

---

## 十、文档完整性检查

### 10.1 代码文档
- [ ] 函数注释清晰
- [ ] 关键逻辑有说明

### 10.2 用户文档
- [x] 使用说明_v2.0.md - 存在且完整
- [x] 含权基金检测功能说明.md - 存在且完整
- [x] 更新说明_v2.1.md - 存在且完整
- [x] 测试验证清单_v2.1.md - 本文档

---

## 测试结果汇总

### 通过的测试项
记录通过的测试数量：___ / 总测试项

### 发现的问题
| 问题编号 | 严重程度 | 问题描述 | 状态 |
|---------|---------|---------|------|
| 1 | | | |
| 2 | | | |

### 测试结论
- [ ] 所有功能正常，可以发布
- [ ] 有轻微问题，可以发布
- [ ] 有严重问题，需要修复

---

## 测试人员签字

**测试人**: _______________
**测试日期**: 2026-01-20
**版本**: v2.1

---

## 备注

测试过程中的任何发现或建议：

```
在此处添加备注...
```
