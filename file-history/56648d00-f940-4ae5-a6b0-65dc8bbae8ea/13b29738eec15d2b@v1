---
name: product-operation-report
description: 为投资经理生成标准化的产品运作说明文字。用于根据产品代码或产品名称以及指定日期，自动生成包含年化收益率、组合久期、杠杆、权益仓位、权益持仓风格分布等关键运作指标的规范化沟通材料。适用场景：撰写市场沟通材料、周报、产品运作说明等需要标准化产品运作数据表述的场景。
---

# 产品运作报告生成

## 功能说明

自动生成标准化的产品运作说明文字，输出格式如下：

```
截止X月X日，[产品名称]当前组合成立以来年化收益率为X.XX%，组合有效久期约X.XX年，杠杆XXX%，权益仓位X.X%左右，权益持仓风格分布为[风格1]XX%、[风格2]XX%、[风格3]XX%。
```

## 使用方法

### 基本用法

执行 `scripts/generate_report.py` 脚本，传入产品标识和日期：

```bash
python scripts/generate_report.py <产品代码或产品名称> <日期YYYYMMDD>
```

示例：
```bash
python scripts/generate_report.py "丰利逸动6个月最短持有期日开1号增强型" "20260115"
python scripts/generate_report.py "9K706010" "20260115"
```

### 参数说明

- **产品标识**：可以使用产品代码（如 `9K706010`）或产品简称（如 `丰利逸动6个月最短持有期日开1号增强型`）
- **日期**：格式为 `YYYYMMDD`（如 `20260115` 表示 2026年1月15日）

## 数据来源

脚本自动从以下数据源读取：

1. **产品运作概览数据**：`/Users/fanshengxia/Desktop/周报V2/数据/产品运作概览数据-母子产品/`
   - 提供年化收益率、组合久期、杠杆、权益仓位等指标

2. **持仓盈亏数据**：`/Users/fanshengxia/Desktop/周报V2/数据/周度更新数据/`
   - 提供持仓明细，用于计算权益持仓风格分布

3. **基金分类数据**：`/Users/fanshengxia/Desktop/投资助理工作/基金分类标签/基金分类数据_2026-01.xlsx`
   - 提供基金风格分类标签（均衡、科技成长、价值、红利等）

## 输出指标

生成的报告包含以下指标：

- **成立以来年化收益率**：从产品成立至指定日期的年化收益率
- **组合有效久期**：组合的有效久期（年）
- **杠杆**：产品杠杆比例
- **权益仓位**：权益资产占比
- **权益持仓风格分布**：按风格分类的权益持仓占比（如均衡、科技成长、价值、红利等），自动按占比从高到低排序

## 工作流程

当用户请求生成产品运作说明时：

1. 确认用户提供的产品标识（代码或名称）和日期
2. 执行 `generate_report.py` 脚本
3. 返回生成的标准化运作说明文字
4. 如果产品名称不匹配，协助用户查找正确的产品名称或代码

## 注意事项

- 产品名称需要与数据文件中的记录完全匹配（建议使用产品代码以避免名称匹配问题）
- 指定日期需要对应的数据文件存在
- 权益风格分布基于基金分类数据和持仓盈亏表自动计算
- 如果找不到对应产品或日期的数据，脚本会返回错误提示
