---
name: bond-position-report
description: 生成债券建仓周报。从正式指令台账信息表中筛选买入交易，区分CD（同业存单）和其他债券，从Wind获取行权久期，生成符合二级台账格式的Excel文件。当用户说"生成债券建仓周报"、"生成某日期的建仓报告"、"统计债券建仓"、"建仓登记"时触发此技能。
---

# 债券建仓周报生成

## 数据源
- 源文件: `/Users/fanshengxia/Desktop/债券建仓登记/正式指令台账信息{日期}.xlsx`
- 格式模板: `/Users/fanshengxia/Desktop/债券建仓登记/多资产投资助理二级台账人员.xlsx`

## 处理逻辑

1. **筛选买入交易**: 只统计交易方向为"买入"的记录
2. **分类**:
   - CD（同业存单）: 债券简称含"CD" → 二级NCD和货币类资产建仓
   - 其他债券 → 二级收券
3. **收益率**: 优先使用行权收益率，没有则使用到期收益率
4. **期限**: 从Wind获取行权久期 `w.wss(codes, "modidura_cnbd", "tradeDate={日期};credibility=3;")`

## 使用方式

运行脚本生成报告:

```bash
python scripts/generate_report.py <日期>
```

日期格式: YYYY-MM-DD（例如: 2026-01-30）

## 输出格式

### Sheet 1: 二级收券
| 日期 | 人员 | 投资经理 | 投资经理本周需求（亿） | 方向 | 代码 | 简称 | 量（万） | 期限（行权/到期，年） | 收益率（%） | 交易对手 |

### Sheet 2: 二级NCD和货币类资产建仓
| 交割日期 | 人员 | 投资经理 | 投资经理本周需求（亿） | 方向 | 专户名称/直投名称 | 背后资产（若有） | 量（万） | 期限（行权/到期，年） | 收益率（%） |

## 输出文件
`/Users/fanshengxia/Desktop/债券建仓登记/债券建仓登记_{日期}.xlsx`

## 需手动填写
- 投资经理
- 投资经理本周需求（亿）
